<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Binomial Distribution • nplearn</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The Binomial Distribution">
<meta property="og:description" content="nplearn">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nplearn</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9020</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Bernoulli-Events.html">Bernoulli Events</a>
    </li>
    <li>
      <a href="../articles/binomdist.html">The Binomial Distribution</a>
    </li>
    <li>
      <a href="../articles/FisherIrwin.html">The Fisher-Irwin Test</a>
    </li>
    <li>
      <a href="../articles/gof.html">Goodness of Fit</a>
    </li>
    <li>
      <a href="../articles/ksamp.html">K-Sample Methods for Quantitative Data</a>
    </li>
    <li>
      <a href="../articles/lsprop.html">Large-Sample Proportion Inference</a>
    </li>
    <li>
      <a href="../articles/OnePropExact.html">Exact Inference for a Single Proportion</a>
    </li>
    <li>
      <a href="../articles/ProdBinom.html">The Product Binomial</a>
    </li>
    <li>
      <a href="../articles/randomization.html">Randomization Tests</a>
    </li>
    <li>
      <a href="../articles/releffic.html">Relative Efficiency</a>
    </li>
    <li>
      <a href="../articles/ReplaceScores.html">Replacement Scores</a>
    </li>
    <li>
      <a href="../articles/signtest.html">The Sign Test</a>
    </li>
    <li>
      <a href="../articles/twosamp.html">Two Sample Procedures</a>
    </li>
    <li>
      <a href="../articles/Workflow-Sample.html">Workflow Sample</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The Binomial Distribution</h1>
            
      
      
      <div class="hidden name"><code>binomdist.Rmd</code></div>

    </div>

    
    
<p>The binomial distribution is the key to exact inference about a
proportion. The purpose of this vignette is to explain the binomial
distribution and provide some examples of practical uses for this
distribution. This will pave the way for later learning about how the
binomial distribution can be used for exact inference, including both
hypothesis testing and confidence interval construction.</p>
<div class="section level3">
<h3 id="required-packages">Required packages<a class="anchor" aria-label="anchor" href="#required-packages"></a>
</h3>
<p>The nplearn package is required for this vignette. All other
functions used are in the base package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fourthz.github.io/nplearn" class="external-link">nplearn</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="joint-events">Joint Events<a class="anchor" aria-label="anchor" href="#joint-events"></a>
</h3>
<p>Multiple independent events that occur are referred to as <em>joint
events</em>. The total number of possible joint outcomes of a joint
event is the product of the number of potential outcomes of each
separate event. For example, on a five-item multiple choice quiz, where
each question has four options, the number of possible patterns of
responses is the product of five fours.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">4</span><span class="op">*</span><span class="fl">4</span><span class="op">*</span><span class="fl">4</span><span class="op">*</span><span class="fl">4</span><span class="op">*</span><span class="fl">4</span></span>
<span><span class="co">#&gt; [1] 1024</span></span></code></pre></div>
<p>We can write this as an exponent.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">4</span><span class="op">^</span><span class="fl">5</span></span>
<span><span class="co">#&gt; [1] 1024</span></span></code></pre></div>
<p>We know from the laws of probability that if each event is
independent, the probability of a specific set of joint events is equal
to the product of the probability of the individual events. In our
multiple-choice quiz example, here is the probability of a test taker
getting a perfect score just by guessing.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.0009765625</span></span></code></pre></div>
<p>Here it is written another way.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span><span class="op">^</span><span class="fl">5</span></span>
<span><span class="co">#&gt; [1] 0.0009765625</span></span></code></pre></div>
<p>Here it is written yet another way.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">0.25</span><span class="op">^</span><span class="fl">5</span></span>
<span><span class="co">#&gt; [1] 0.0009765625</span></span></code></pre></div>
<p>Suppose we have a series of Bernoulli events. For example, suppose
that we again administer a five-question quiz, but this time the items
are true-false. This is a series of Bernoulli events because there are
only two possible outcomes for each event. Here is the probability of
getting a perfect score just by guessing.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">0.5</span><span class="op">^</span><span class="fl">5</span></span>
<span><span class="co">#&gt; [1] 0.03125</span></span></code></pre></div>
<p>A more sophisticated test taker will actually have studied for the
test, so this test taker will not just be guessing. We could think of
the probability of success on an item as a function of this person’s
knowledge after learning the content. Here is the probability of a
perfect score if the probability of success on each item is 0.7.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">0.7</span><span class="op">^</span><span class="fl">5</span></span>
<span><span class="co">#&gt; [1] 0.16807</span></span></code></pre></div>
<p>Let’s see what the chance of a perfect score is for someone who is
very well prepared so that the success rate for each item is 0.95.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">0.95</span><span class="op">^</span><span class="fl">5</span></span>
<span><span class="co">#&gt; [1] 0.7737809</span></span></code></pre></div>
<p>Of course all of this is making the unrealistic assumption that the
rate of success is the same for every item. In fact, so items are more
difficult than others, so the actual probability of a perfect score
might be something more like this.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">0.8</span><span class="op">*</span><span class="fl">0.95</span><span class="op">*</span><span class="fl">0.75</span><span class="op">*</span><span class="fl">0.95</span><span class="op">*</span><span class="fl">0.70</span></span>
<span><span class="co">#&gt; [1] 0.37905</span></span></code></pre></div>
<p>This kind of test-taking discussion with different item difficulties
is best left for a measurement course, such as item response theory. We
will step out of the test-taking domain in a bit, but for now let’s
proceed with this example and the (unrealistic) assumption that each
item has the same difficulty level.</p>
</div>
<div class="section level3">
<h3 id="permutations">Permutations<a class="anchor" aria-label="anchor" href="#permutations"></a>
</h3>
<p>Suppose I’m not just interested in a perfect score, but I’m also
interested in questions like, what is the chance of obtaining four out
of five correct on this true-false quiz if the probability of success
for each item is 0.7? This is a bit tricky, because we don’t know which
item the person will get wrong. Here is the probability of getting just
the first item wrong.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">0.3</span><span class="op">*</span><span class="fl">0.7</span><span class="op">*</span><span class="fl">0.7</span><span class="op">*</span><span class="fl">0.7</span><span class="op">*</span><span class="fl">0.7</span></span>
<span><span class="co">#&gt; [1] 0.07203</span></span></code></pre></div>
<p>Here it is written another way.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">0.7</span><span class="op">^</span><span class="fl">4</span> <span class="op">*</span> <span class="fl">0.3</span><span class="op">^</span><span class="fl">1</span></span>
<span><span class="co">#&gt; [1] 0.07203</span></span></code></pre></div>
<p>What about the probability of getting just the second item wrong?</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">0.7</span><span class="op">*</span><span class="fl">0.3</span><span class="op">*</span><span class="fl">0.7</span><span class="op">*</span><span class="fl">0.7</span><span class="op">*</span><span class="fl">0.7</span></span>
<span><span class="co">#&gt; [1] 0.07203</span></span></code></pre></div>
<p>The probability is the same! In fact, we could still write it this
way.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">0.7</span><span class="op">^</span><span class="fl">4</span> <span class="op">*</span> <span class="fl">0.3</span><span class="op">^</span><span class="fl">1</span></span>
<span><span class="co">#&gt; [1] 0.07203</span></span></code></pre></div>
<p>It is pretty easy to figure out that there are five possible ways for
the test taker to get just one item wrong on a five-item test: The first
one could be wrong, the second item could be wrong, and so on. Thus, the
total probability of getting any one item wrong is calculated this
way.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">5</span> <span class="op">*</span> <span class="fl">0.7</span><span class="op">^</span><span class="fl">4</span> <span class="op">*</span> <span class="fl">0.3</span><span class="op">^</span><span class="fl">1</span></span>
<span><span class="co">#&gt; [1] 0.36015</span></span></code></pre></div>
<p>That was straightforward, but it becomes more difficult with
different numbers of items correct and different numbers of items. For
example, how many different patterns will there be for three items
correct and two items incorrect? What about if there are 10 items
instead of five? How many patterns will there be for four items correct
and six incorrect? Clearly these questions are not as easy to answer.
What we need are some counting rules. Many nonparametric statistics are
based on working with discrete values, so we often need to count.
Methods of counting for various situations are an important component of
nonparametric analysis.</p>
<p>The first counting rule is about permutations. A permutation of
objects is a distinct ordering of objects. We can calculate the number
of permutations of N objects with a product known as a
<em>factorial</em>. For example, for five objects we use 5! (read as,
five factorial).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">5</span> <span class="op">*</span> <span class="fl">4</span> <span class="op">*</span> <span class="fl">3</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="fl">1</span></span>
<span><span class="co">#&gt; [1] 120</span></span></code></pre></div>
<p>R includes a factorial function.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">factorial</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 120</span></span></code></pre></div>
<p>A side note: What do we do with 0!? By definition, 0! = 1.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">factorial</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-binomial-coefficient">The Binomial Coefficient<a class="anchor" aria-label="anchor" href="#the-binomial-coefficient"></a>
</h3>
<p>In our true-false quiz example we had five questions, so the number
of possible permutations of the answers is 5! = 120. Yet if we want to
know how many ways there are to get two incorrect answers out of the
five questions, we really only care about two incorrect and three
correct answers, regardless of where they occur. That is, we consider
all incorrect answers as indisitinguishable from one another. There are
only two distinct type of answers here: correct and incorrect. The
permutation of wrong, wrong, right, right, right does not need to be
considered different than the permutation of wrong, right, right, right,
wrong.</p>
<p>To calculate how many permutations there are when we include
identical “objects” (we consider every “right” and every “wrong” as
identical) we need to divide the total number of permutations by the
number of permutations of each identical object. Here’s the calculation
for five true-false items when three are correct and two are
incorrect.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">factorial</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">factorial</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">factorial</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10</span></span></code></pre></div>
<p>This can be extended to any number of identical objects. The case
where we have only two identical objects is all we will need when
looking at a series of Bernoulli events, because by definition a
Bernoulli event only has one of two outcomes. Given this case is so
special, there is a special expression for it, as well as a special
function for it. When we want to know how many ways we can get three
items correct out of five Bernoulli trials, we say <em>five choose
three</em>. Here is how we represent it.</p>
<p><span class="math inline">\(\binom{5}{3}\)</span></p>
<p>Here’s the R function.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">choose</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10</span></span></code></pre></div>
<p>This function is referred to as the <em>binomial coefficient</em>. In
general, we represent the number of ways that we can have <span class="math inline">\(x\)</span> successes in <span class="math inline">\(n\)</span> trials like this, which we read as
<em>n choose x</em>.</p>
<p><span class="math inline">\(\binom{n}{x}\)</span></p>
<p>It would seem quite difficult to figure how many different ways there
are to obtain 13 correct answers on a 20-item true-false quiz, but the
binomial coefficient function makes it easy.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">choose</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">13</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 77520</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-binomial-probability-function">The Binomial Probability Function<a class="anchor" aria-label="anchor" href="#the-binomial-probability-function"></a>
</h3>
<p>If we combine the concepts of joint events with the binomial
coefficient, we can answer an interesting question. When we observe
<span class="math inline">\(n\)</span> independent Bernoulli events,
each with the same probability of success, <span class="math inline">\(\pi\)</span>, what is the probability that <span class="math inline">\(x\)</span> of these events will be a success? If
that doesn’t really sound very interesting to you, consider a few
examples.</p>
<p><em>If the chance of contracting an illness is 40% when coming into
contact </em> <em>with another person with the illness, what is the
probability that all six </em> <em>people who came into contact with an
ill person will avoid aquiring the </em> <em>illness themself?</em></p>
<p><em>Suppose that there is an expensive treatment for the above
illness and that </em> <em>medical professionals purchased enough drugs
to treat two patients in </em> <em>anticipation that two of the six
people will contract the illness. What is </em> <em>the probability that
exactly two of the six people will indeed contract the </em>
<em>illness?</em></p>
<p><em>If the overall pass rate on an entrance exam is 70%, what is the
probability </em> <em>that we will be able to fill eight slots with
successful examinees if there </em> <em>are 11 applicants for the
position?</em></p>
<p>As we will see in the next vignette, knowing the probability of <span class="math inline">\(x\)</span> successes in <span class="math inline">\(n\)</span> trials can also be used to conduct
hypotheses tests and construct confidence intervals for a proportion, so
the value of being able to calculate probabilities based on <span class="math inline">\(n\)</span> Bernoulli events goes beyond answering
questions like those above.</p>
<p>Recall that we calculate the probability of independent joint events
by taking the product of the probability of each event. When there is a
70% chance of passing an item on a five-item quiz, we calculate the
probability of getting the first three items correct but missing the two
remaining items like this.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">0.7</span><span class="op">^</span><span class="fl">3</span> <span class="op">*</span> <span class="fl">0.3</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="co">#&gt; [1] 0.03087</span></span></code></pre></div>
<p>In more general terms, the chance of getting the first <span class="math inline">\(x\)</span> items correct but missing the remaining
items on an <span class="math inline">\(n\)</span>-item quiz when the
probability of success is <span class="math inline">\(pi\)</span> is
calculated like this.</p>
<p><span class="math inline">\(\pi^x (1-\pi)^{(n-x)}\)</span></p>
<p>That is, we multiply the probability of the <span class="math inline">\(x\)</span> successes by the probability of the
<span class="math inline">\(n-x\)</span> failures.</p>
<p>I can’t think of a reason why I would want to know the chance of
getting the first three items correct and missing the last two, but I
can think of why I might want to know the probability of missing
<em>any</em> two, not just the last two. That is where the binomial
coefficient comes in handy. The binomial coefficient tells us how many
ways we can arrange <span class="math inline">\(x\)</span> successes in
<span class="math inline">\(n\)</span> trials. Here is how many ways we
can have exactly three items correct on a five-item quiz.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">choose</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10</span></span></code></pre></div>
<p>If I multiply the probability of one specific sequence of three
correct and two wrong with the number of ways I can have three correct
and two wrong, that will give me the probability of obtaining any three
correct on a five-item quiz.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">choose</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.7</span><span class="op">^</span><span class="fl">3</span> <span class="op">*</span> <span class="fl">0.3</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="co">#&gt; [1] 0.3087</span></span></code></pre></div>
<p>We can right this in general terms like this.</p>
<p><span class="math inline">\(P(X = x) = \binom{n}{x}\pi^x
(1-\pi)^{(n-x)}\)</span></p>
<p>This is the binomial probability function. It tells us the
probability of <span class="math inline">\(x\)</span> successes in <span class="math inline">\(n\)</span> Bernoulli events when the probability
of success is <span class="math inline">\(\pi\)</span> for each
Bernoulli event. Note that whereas the values of <span class="math inline">\(x\)</span> are either 0 or 1 for a Bernoulli
event, the values of <span class="math inline">\(x\)</span> for the
binomial function will range from 0 to <span class="math inline">\(n\)</span>. That is, you can have 0 success, 1
success, 2 successes, and so on, all the way up to <span class="math inline">\(n\)</span> successes.</p>
<p>Let’s now answer the first two of our three questions.</p>
<p><em>If the chance of contracting an illness is 40% when coming into
contact </em> <em>with another person with the illness, what is the
probability that all six </em> <em>people who came into contact with an
ill person will avoid aquiring the </em> <em>illness themself?</em></p>
<p>Here’s the formula that will provide the solution.</p>
<p><span class="math inline">\(P(X = 0) = \binom{6}{0}0.4^0
(1-0.4)^{(6-0)}\)</span></p>
<p>Here it is calculated in R.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">choose</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">0</span><span class="op">)</span><span class="op">*</span><span class="fl">0.4</span><span class="op">^</span><span class="fl">0</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">0.4</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">6</span><span class="op">-</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.046656</span></span></code></pre></div>
<p>It looks like there is a very high chance that someone will get sick!
The second question is about the anticipation that this will be two
people.</p>
<p><em>Suppose that there is an expensive treatment for the above
illness and that </em> <em>medical professionals purchased enough drugs
to treat two patients in </em> <em>anticipation that two of the six
people will contract the illness. What is </em> <em>the probability that
exactly two of the six people will indeed contract the </em>
<em>illness?</em></p>
<p>Here’s the formula that will provide the solution.</p>
<p><span class="math inline">\(P(X = 2) = \binom{6}{2}0.4^2
(1-0.4)^{(6-2)}\)</span></p>
<p>Here it is calculated in R.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">choose</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fl">0.4</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">0.4</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">6</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.31104</span></span></code></pre></div>
<p>So there is about a one in three chance that the medical staff
purchased exactly the correct amount of drugs. It is probably more
reasonable to believe that the medical staff wants to make sure they
have enough drugs, but it would be OK to have some left over. This leads
us to the most common use of the binomial probability function, which is
the creation of the binomial distribution.</p>
</div>
<div class="section level3">
<h3 id="the-binomial-distribution">The Binomial Distribution<a class="anchor" aria-label="anchor" href="#the-binomial-distribution"></a>
</h3>
<p>Rather than calculating the probability that zero or two people will
get sick when they come in contact with a particular bacteria or virus,
wouldn’t it make sense to know the probability for every possible
outcome? Yes! That is what we do to create the binomial distribution.
Here are all the probabilities.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="va">n</span></span>
<span><span class="va">pi</span> <span class="op">&lt;-</span> <span class="fl">0.4</span></span>
<span></span>
<span><span class="va">prob.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">choose</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">^</span><span class="va">x</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">pi</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">prob.x</span><span class="op">)</span></span>
<span><span class="co">#&gt;      x   prob.x</span></span>
<span><span class="co">#&gt; [1,] 0 0.046656</span></span>
<span><span class="co">#&gt; [2,] 1 0.186624</span></span>
<span><span class="co">#&gt; [3,] 2 0.311040</span></span>
<span><span class="co">#&gt; [4,] 3 0.276480</span></span>
<span><span class="co">#&gt; [5,] 4 0.138240</span></span>
<span><span class="co">#&gt; [6,] 5 0.036864</span></span>
<span><span class="co">#&gt; [7,] 6 0.004096</span></span></code></pre></div>
<p>Given that we calculated the probability for every possible outcome,
these better add to one!</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">prob.x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>They do! Here’s a picture of the binomial distribution. Note that it
relates every possible value of <span class="math inline">\(x\)</span>
to the probability of observing <span class="math inline">\(x\)</span>
in <span class="math inline">\(n\)</span> trials, so this is a
probability function.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/binom_plot.html">binom_plot</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">0.4</span><span class="op">)</span></span></code></pre></div>
<p><img src="binomdist_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<p>If we want to determine the probability that we have enough drugs for
up to two people who may get sick (rather than exactly two people), we
can find the cumulative probability up to and including two.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span></span>
<span><span class="va">pi</span> <span class="op">&lt;-</span> <span class="fl">0.4</span></span>
<span></span>
<span><span class="va">prob.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">choose</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">^</span><span class="va">x</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">pi</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">prob.x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.54432</span></span></code></pre></div>
<p>There’s a little better than a one in two chance that two doses will
be enough. (If this is a serious disease, I would want a higher
probability that I’m going to be able to treat everyone!)</p>
<p>You may have guessed by now that we don’t really need to write R code
to make these calculations because someone has already done it for us.
You would be correct. The binomial distribution is a common
distribution, so we have the d, p, q, and r distribution functions at
our disposal. Yay!</p>
<p>Here’s the probability that exactly two out of six people will
contract the sickness.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">2</span>, size <span class="op">=</span> <span class="fl">6</span>, prob <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.31104</span></span></code></pre></div>
<p>Here’s the probability that two or less persons out of six people
will contract the sickness.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">pbinom</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">6</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.54432</span></span></code></pre></div>
<p>Suppose we want to be at least 80% certain that we have enough
treatments. How many should we get?</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">qbinom</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">6</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
<p>We need three treatments. Remember that this is a discrete
distribution, so it would be unusual to have the cumulative probability
up to, and including, three be exactly 80%. Let’s see what it is.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">pbinom</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8208</span></span></code></pre></div>
<p>It is 82%. Remember the rule for quantiles of a discrete
distribution. We are seeking the smallest value of <span class="math inline">\(x\)</span> on the distribution such that the
cumulative probability to, and including, <span class="math inline">\(x\)</span> is at least the specified probability.
That’s what we got here, and we were able to use this rule to our
advantage by being at least 80% sure that we have enough treatments.</p>
<p>Let’s consider the final question posed above.</p>
<p><em>If the overall pass rate on an entrance exam is 70%, what is the
probability </em> <em>that we will be able to fill eight slots with
successful examinees if there </em> <em>are 11 applicants for the
position?</em></p>
<p>If we have eight or more successful examinees, we will be able to
fill the eight slots. We could do this one of two ways. We could
calculate the probability of seven or fewer successes and then subtract
this from one.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">pbinom</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">11</span>, <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.5695623</span></span></code></pre></div>
<p>Alternatively, we could calculate the upper tail.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">pbinom</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">11</span>, <span class="fl">0.7</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.5695623</span></span></code></pre></div>
<p>The important trick to remember here is that if we want an upper tail
that includes a specified value (in this case, the value of eight), we
need to subtract one from this value to make sure it is included in the
upper region of the distribution.</p>
<p>Finally, suppose we wanted to do a simulation using the binomial
distribution. Here are 20 random draws from a distribution with <span class="math inline">\(\pi\)</span> = 0.8 when the sample size is 15.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">15</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 11 12 12 13 13 12 14 11 10 14 11 15 12 12 11 13 13 12 11 15</span></span></code></pre></div>
<p>Keep in mind that what each number we are randomly generating is the
value of <span class="math inline">\(x\)</span>, which is the number of
successes in <span class="math inline">\(n\)</span> trials. In this
example there are 15 opportunities for success. The probability of
success is quite high, so we are primarily seeing high numbers of
successes out of the 15 trials.</p>
<p>In this example, we were drawing from a binomial distribution with
<span class="math inline">\(n\)</span> trials and a probability of
success, <span class="math inline">\(\pi\)</span>. These are the
parameters of the binomial distribution. Any binomial distribution can
be generated if we know these two parameters. Let’s end with a picture
of a binomial distribution when <span class="math inline">\(n\)</span> =
100 and <span class="math inline">\(\pi\)</span> = 0.5.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/binom_plot.html">binom_plot</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="binomdist_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
<p>That looks like a normal distribution, doesn’t it? That is why we can
use the normal distribution for a large-sample approximation and it
works pretty well. Yet the above distribution is <em>not</em> normal.
For one thing, it is a discrete distribution, rather than continuous. So
why bother to use a continuous distribution to approximate results when
we can use the actual distribution? I have no idea! In the next
vignette, let’s make inferences using the actual distribution, thus
calculating exact probabilities rather than approximations.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Michael Seaman.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
