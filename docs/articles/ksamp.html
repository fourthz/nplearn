<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>K-Sample Methods for Quantitative Data • nplearn</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="K-Sample Methods for Quantitative Data">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nplearn</a>
<<<<<<< HEAD
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9019</span>
=======
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9018</span>
>>>>>>> master
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Bernoulli-Events.html">Bernoulli Events</a>
    </li>
    <li>
      <a href="../articles/binomdist.html">The Binomial Distribution</a>
    </li>
    <li>
      <a href="../articles/FisherIrwin.html">The Fisher-Irwin Test</a>
    </li>
    <li>
      <a href="../articles/gof.html">Goodness of Fit</a>
    </li>
    <li>
      <a href="../articles/ksamp.html">K-Sample Methods for Quantitative Data</a>
    </li>
    <li>
      <a href="../articles/lsprop.html">Large-Sample Proportion Inference</a>
    </li>
    <li>
      <a href="../articles/OnePropExact.html">Exact Inference for a Single Proportion</a>
    </li>
    <li>
      <a href="../articles/ProdBinom.html">The Product Binomial</a>
    </li>
    <li>
      <a href="../articles/randomization.html">Randomization Tests</a>
    </li>
    <li>
      <a href="../articles/releffic.html">Relative Efficiency</a>
    </li>
    <li>
      <a href="../articles/ReplaceScores.html">Replacement Scores</a>
    </li>
    <li>
      <a href="../articles/signtest.html">The Sign Test</a>
    </li>
    <li>
      <a href="../articles/twosamp.html">Two Sample Procedures</a>
    </li>
    <li>
      <a href="../articles/Workflow-Sample.html">Workflow Sample</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>K-Sample Methods for Quantitative Data</h1>
            
      
      
      <div class="hidden name"><code>ksamp.Rmd</code></div>

    </div>

    
    
<p>One of the most commonly-used designs in behavioral and social research involves the comparison of scores in <em>K</em> conditions, where <em>K</em> &gt; 2. These conditions could be part of an experiment, with each participant randomly assigned to one of the conditions, or they could be defined by an existing categorical variable. In this vignette we will explore nonparametric methods for analyzing both experimental or observational data in which there are <em>K</em> groups or conditions.</p>
<div id="required-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#required-packages" class="anchor"></a>Required packages</h3>
<p>The only package required for this vignette is nplearn. Make certain that you have installed this packages before attempting to load the library.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(nplearn)</a></code></pre></div>
</div>
<div id="the-fisher-pitman-randomization-test" class="section level3">
<h3 class="hasAnchor">
<a href="#the-fisher-pitman-randomization-test" class="anchor"></a>The Fisher-Pitman Randomization Test</h3>
<p>A study of the effectiveness of metaphors compared three conditions: a control condition, an advance metaphor condition, and an extended metaphor condition. Participants in the control condition received a difficult textual passage. For the advance metaphor condition the same passage was preceded by a familiar metaphor. In the extended metaphor condition the metaphors were embedded in the passage. All participants completed a comprehension test about the passage.</p>
<p>This is a small experiment in which 12 participants were randomly assigned to one of three conditions so that each condition included four participants. Here are the scores for the three conditions.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">control &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">11</span>)</a>
<a class="sourceLine" id="cb2-2" title="2">advance &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">13</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">8</span>)</a>
<a class="sourceLine" id="cb2-3" title="3">extended &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">15</span>, <span class="dv">12</span>, <span class="dv">17</span>, <span class="dv">14</span>)</a></code></pre></div>
<p>The hypotheses of interest can be expressed in terms of medians or means. Here they are expressed in terms of means.</p>
<p><span class="math inline">\(H_0: \mu_c = \mu_a = \mu_e\)</span></p>
<p><span class="math inline">\(H_a: \mu_k \ne \mu_{k'}, k \ne k'\)</span></p>
<p>Note that the alternative hypothesis (which matches our research hypothesis) is that some of the means are different from the others. It is possible for the alternative hypothesis to be true even if there are two conditions with equal means, as long as there are also at least two conditions that do not have equal means.</p>
<p>The normal approach to analyzing such data is with one-factor analysis of variance (ANOVA). The conditions for such inference to be valid are these.</p>
<<<<<<< HEAD
<ul>
<li>Observations within conditions are independent of each other</li>
<li>The <em>K</em> conditions are independent of each other</li>
<li>The population of scores represented by participants in each condition have a normal distribution</li>
</ul>
<p>The strongest of these conditions is that scores follow a normal distribution. For inference using the Fisher-Pitman randomization test, we can replace this with a weaker condition.</p>
<ul>
<li>Population distributions have the same shape</li>
</ul>
=======
<p><em>Observations within conditions are independent of each other </em>The <em>K</em> conditions are independent of each other *The population of scores represented by participants in each condition have a normal distribution</p>
<p>The strongest of these conditions is that scores follow a normal distribution. For inference using the Fisher-Pitman randomization test, we can replace this with a weaker condition.</p>
<p>*Population distributions have the same shape</p>
>>>>>>> master
<p>This condition is going to be valid if the effect of any treatment is to “shift” the distribution one way or the other. This will occur if the treatment has a similar effect for all participants in the study. For observational studies in which there is no treatment, such a condition implies that differences associated with the explanatory variable are similar across the range of population attributes.</p>
<p>Whether the study involves the administration of a treatment or the measurement for different categories of an explanatory variable, under the null hypothesis of no mean (or median) difference, we consider any differences that we observe as a consequence of who was assigned to which condition (in an experiment) or who we observed in existing conditions (in an observational study). Considering all possible randomizations (or all possible selections of 12 individuals with these scores), Here are the number of ways that we could have observed these same 12 scores across the three conditions. That is, this is the number of combinations we could obtain for three groups with four participants in each group.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">12</span>)<span class="op">/</span>(<span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">4</span>)<span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">4</span>)<span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#&gt; [1] 34650</span></a></code></pre></div>
<p>Under the null hypothesis, we have observed one of these 34,650 possible arrangement of scores, each of which is equally likely. On the other hand, if the null hypothesis is false and the alternative hypothesis is true, then combinations that lead to a difference in means or medians are more likely than those in which we have equal (or close to equal) means or medians. As usual, we will select a test statistic and then look at the distribution of that test statistic when the null hypothesis is true.</p>
<p>When we perform a one-way ANOVA, we use the <em>F</em> statistic.</p>
<p><span class="math inline">\(F = MS_B/MS_W\)</span></p>
<p>That is, <em>F</em> is the ratio of two mean squares, one that estimates error, <span class="math inline">\(MS_W\)</span>, and one that estimates the sum of error and group differences, <span class="math inline">\(MS_B\)</span>. For the Fisher-Pitman procedure, we can use that same test statistic. We can create the distribution of all 34,650 values of <em>F</em> by calculating <em>F</em> for all of these possible arrangements of scores. We know that when the alternative hypothesis is true, the probabilities are higher for obtaining larger values of <em>F</em> than for obtaining smaller values of <em>F</em>. If the null hypothesis is true, each value of <em>F</em> is equally likely (except that some values of <em>F</em> may occur more than once, in which case we would have to add the individual probabilities). We form a rejection region by putting the largest values of <em>F</em> in the rejection region, as these are most incompatible with the null hypothesis yet most likely to occur if the alternative hypothesis is true.</p>
<p>The problem with conducting the Fisher-Pitman test for <em>K</em> samples is that the number of combinations grows rapidly, thus making the test difficult, at best, and potentially impossible without huge computing resources. For example, consider a moderately-sized study with 30 participants, 10 in each of 3 conditions.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">30</span>)<span class="op">/</span>(<span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">10</span>)<span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">10</span>)<span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">#&gt; [1] 5.550997e+12</span></a></code></pre></div>
<p>This is a bunch of possibilities! We quickly turn our attention to a large-sample approximation to the Fisher-Pitman randomization procedure. When the null hypothesis is true, with a large-enough sample, the <em>F</em> statistic is approximately distributed as an <em>F</em> distribution with <em>k-1</em> and <em>n-k</em> degrees of freedom. For students who have taken traditional parametric statistics courses, you will recognize both the statistic and the distribution used for testing the statistic as those you used when analyzing data with one-way ANOVA. In other words, the large-sample approximation to the Fisher-Pitman randomization procedure is one-way ANOVA!</p>
</div>
<div id="the-kruskal-wallis-test" class="section level3">
<h3 class="hasAnchor">
<a href="#the-kruskal-wallis-test" class="anchor"></a>The Kruskal-Wallis Test</h3>
<p>If we replace our scores with ranks, an exact test is available for both small- and moderately-sized studies. The conditions for valid inference are the same as for the Fisher-Pitman randomization test, meaning that we can relax the normality condition and use the condition that our populations have the same shape. Additionally, we know that using ranks might buy us more power when scores are not normally distributed, yet not lose us much if the scores are normally distributed.</p>
<p>For no particular reason, other than that the median is robust to outliers and skew, let us express the hypotheses in terms of the median.</p>
<p><span class="math inline">\(H_0: \theta_1 = \theta_2 = \theta_3\)</span></p>
<p><span class="math inline">\(H_a: \theta_k \ne \theta_{k'}, k \ne k'\)</span></p>
<p>Again we create all possible combinations, but this time using ranks instead of original scores. Kruskal and Wallis defined their test statistic, <em>H</em> using this formula.</p>
<p><span class="math inline">\(H = (n-1)SS_B/SS_T\)</span></p>
<p>Here, <span class="math inline">\(n\)</span> is the total sample size and <span class="math inline">\(SS_B\)</span> and <span class="math inline">\(SS_T\)</span> are the between conditions sum-of-squares and the total sum-of-squares, respectively. These are calculated in the same manner as we would calculate sums-of-squares if we were creating a one-way ANOVA table, except that we rank scores without regard to condition before making these calculations.</p>
<p>As with the <em>F</em> test, we construct a rejection region by putting the largest possible values of <em>H</em> in the rejection region, but only putting enough values in this region so that the rejection region has a proportion that is less than or equal to <span class="math inline">\(\alpha\)</span>, our tolerance for Type I errors.</p>
<p>Returning to the metaphor example, here are the sample medians for the four conditions.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(control)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#&gt; [1] 9.5</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="kw"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(advance)</a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">#&gt; [1] 7.5</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="kw"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(extended)</a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt; [1] 14.5</span></a></code></pre></div>
<p>The extended metaphor condition is performing well in our study, but is this enough evidence that we can make inferences to other randomizations or to individuals outside the study but like those in our study, with respect to relevant variables?</p>
<p>We can calculate H using ranks and ANOVA procedures. Note that we have to set up another variable for our explanatory variable: metaphor condition. Normally in your research you’ll begin with a data frame (for example, what you read in from a CSV file) that will have the scores and the grouping variable, so most of the first part of this script will be unnecessary, other than creating ranks.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co"># Set up the data</span></a>
<a class="sourceLine" id="cb6-3" title="3"></a>
<a class="sourceLine" id="cb6-4" title="4">y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(control, advance, extended)</a>
<a class="sourceLine" id="cb6-5" title="5">y.rank =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rank.html">rank</a></span>(y)</a>
<a class="sourceLine" id="cb6-6" title="6">group &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"control"</span>, <span class="dv">4</span>), <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"advance"</span>, <span class="dv">4</span>), <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"extended"</span>, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb6-7" title="7">metaphor &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(y.rank, group)</a>
<a class="sourceLine" id="cb6-8" title="8"></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co"># Now run ANOVA procedures</span></a>
<a class="sourceLine" id="cb6-10" title="10"></a>
<a class="sourceLine" id="cb6-11" title="11">our.model &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span>(y.rank <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> metaphor)</a>
<a class="sourceLine" id="cb6-12" title="12">our.results &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span>(our.model)</a>
<a class="sourceLine" id="cb6-13" title="13"></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co"># Calculate H</span></a>
<a class="sourceLine" id="cb6-15" title="15"></a>
<a class="sourceLine" id="cb6-16" title="16">df.total &lt;-<span class="st"> </span>(our.results[<span class="dv">1</span>,<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>our.results[<span class="dv">2</span>,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb6-17" title="17">ss.bet &lt;-<span class="st"> </span>our.results[<span class="dv">1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb6-18" title="18">ss.total &lt;-<span class="st"> </span>our.results[<span class="dv">1</span>,<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>our.results[<span class="dv">2</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb6-19" title="19"></a>
<a class="sourceLine" id="cb6-20" title="20">H &lt;-<span class="st"> </span>df.total<span class="op">*</span>ss.bet<span class="op">/</span>ss.total</a>
<a class="sourceLine" id="cb6-21" title="21">H</a>
<a class="sourceLine" id="cb6-22" title="22"><span class="co">#&gt; [1] 6.576923</span></a></code></pre></div>
<p>We now need to determine if the value of <em>H</em> is in our rejection region. That, of course, depends on our tolerance for errors. For this example, given the small sample size, let’s set that at 10%.</p>
<p>We have already seen that even with this small sample size there are over 34,000 combinations, so looking through that distribution can be tedious. Fortunately, someone has done that for us and created a table of critical values. Looking at the table, we find that the critical value is 4.65. We also can determine from this table that <span class="math inline">\(\hat{\alpha} = 0.097\)</span>, which is quite good, especially considering our sample size of 12 units.</p>
</div>
<div id="a-kruskal-wallis-function-and-exact-critical-values" class="section level3">
<h3 class="hasAnchor">
<a href="#a-kruskal-wallis-function-and-exact-critical-values" class="anchor"></a>A Kruskal-Wallis function and exact critical values</h3>
<p>Fortunately, there is a function for the Kruskal-Wallis test. It’s in your plain old R install, so you don’t need to install a package. We also don’t need to do any ranking, because it will do it for us. The command is similar to when we are running one-way ANOVA.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test</a></span>(y <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> metaphor)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#&gt;  Kruskal-Wallis rank sum test</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt; data:  y by group</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; Kruskal-Wallis chi-squared = 6.5769, df = 2, p-value = 0.03731</span></a></code></pre></div>
<p>We painlessly obtained the same value for <em>H</em> as we did above. Note that it is called a chi-squared statistic in the function output. Why? Because the large-sample approximation for <em>H</em> is a chi-square distribution with <em>k</em>-1 degrees of freedom. So the <em>p</em> value you are seeing is not an exact <em>p</em> value, but a large-sample approximation, even though our sample size is only 12! That doesn’t seem very large-sample to me. Here’s the large-sample calculation of the <em>p</em> value.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span>(H, <span class="dv">3-1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt; [1] 0.03731121</span></a></code></pre></div>
<p>Why did this function provide us a large-sample approximation with a sample size of 12? Remember that even for small sample sizes, there are many, many combinations. (We have already seen that even with this small sample size there are over 34,000 combinations!) The distribution of <em>H</em> becomes huge very quickly. Remember what we saw above for a sample of size 30.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">30</span>)<span class="op">/</span>(<span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">10</span>)<span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">10</span>)<span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co">#&gt; [1] 5.550997e+12</span></a></code></pre></div>
<p>A sample size of 30 is still not large, yet there are so many combinations. Further, a computer doing this for us would have to find all combinations, calculate <em>H</em> for every combination, and then store that <em>H</em>. After storing all 5.55 trillion values of <em>H</em>, it would then have to determine that largest 10% (or 5%, or 1%, or whatever our tolerance for error). If we rented space on a very fast computer that could do all the calculations for 1,000,000 of the combinations in a second (that would indeed be a fast computer!), here is how long it would take in days.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">num.combs &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">30</span>)<span class="op">/</span>(<span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">10</span>)<span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">10</span>)<span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb10-2" title="2">num.seconds &lt;-<span class="st"> </span>num.combs<span class="op">/</span><span class="dv">1000000</span></a>
<a class="sourceLine" id="cb10-3" title="3">num.minutes &lt;-<span class="st"> </span>num.seconds<span class="op">/</span><span class="dv">60</span></a>
<a class="sourceLine" id="cb10-4" title="4">num.hours &lt;-<span class="st"> </span>num.minutes<span class="op">/</span><span class="dv">60</span></a>
<a class="sourceLine" id="cb10-5" title="5">num.days &lt;-<span class="st"> </span>num.hours<span class="op">/</span><span class="dv">24</span></a>
<a class="sourceLine" id="cb10-6" title="6">num.days</a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt; [1] 64.24765</span></a></code></pre></div>
<p>Hopefully the computer rental is cheap and not by the hour! Remember, if we suddenly decide to use 31 people instead of 30 (or perhaps 29, because someone drops out of the study), we have to do it all over again.</p>
<p>There is no way that the folk who write R functions for us are going to make us wait that long. Also, our computers are not supercomputers like the one we speculated about above. We’d miss meals and classes (and most of our lifetime) waiting for the <em>p</em> value. It’s just not worth it. Unfortunately, the R function, and functions built into other popular packages for that matter, do not have a Monte Carlo simulation (they should!), so we are forced to use the mathematical distribution method for our approximation.</p>
<p>I’m not a fan of large-sample approximations for small samples. Experience has shown that the approximation can be way off. Fortunately, as we saw with the example above, for smaller samples we can do an exact test by looking up the exact critical value in a table of Kruskal-Wallis critical values. Do the critical value tables go far enough so that we no longer have to consider our sample small, thus we can be more comfortable with the large sample approximation? Yes!</p>
<p>Remarkably, the critical value tables for three groups (<em>k</em> = 3) go up to <em>n</em> = 105, or 35 units in each of the three conditions. Let’s see how long that would take for our supercomputer, but we had better calculate it in years.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">num.combs &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">105</span>)<span class="op">/</span>(<span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">35</span>)<span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">35</span>)<span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">35</span>))</a>
<a class="sourceLine" id="cb11-2" title="2">num.seconds &lt;-<span class="st"> </span>num.combs<span class="op">/</span><span class="dv">1000000</span></a>
<a class="sourceLine" id="cb11-3" title="3">num.minutes &lt;-<span class="st"> </span>num.seconds<span class="op">/</span><span class="dv">60</span></a>
<a class="sourceLine" id="cb11-4" title="4">num.hours &lt;-<span class="st"> </span>num.minutes<span class="op">/</span><span class="dv">60</span></a>
<a class="sourceLine" id="cb11-5" title="5">num.days &lt;-<span class="st"> </span>num.hours<span class="op">/</span><span class="dv">24</span></a>
<a class="sourceLine" id="cb11-6" title="6">num.years &lt;-<span class="st"> </span>num.days<span class="op">/</span><span class="fl">365.25</span></a>
<a class="sourceLine" id="cb11-7" title="7">num.years</a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co">#&gt; [1] 3.105869e+34</span></a></code></pre></div>
<p>Ummmmm, that’s substantially longer than the age of the universe. Believe it or not, there’s a name for a number this large. It is 31 Decillion. And keep in mind that that’s for a single value of <em>n</em>! We will spend almost as long again calculating the critical value for <em>n</em> = 104, then again for <em>n</em> = 103, and so on. (Remember at the beginning of the course I told you that a drawback of nonparametric methods was computing time? I wasn’t joking!)</p>
<p>OK, what’s the catch. Is there a supercomputer substantially faster than the one we are imagining? I don’t think so.</p>
<p>I heard a cool little story about this at the annual conference of the American Educational Research Association about 15 years ago. Back in the late 1980s, a young doctoral student was working on a dissertation that involved a nonparametric technique. The Kruskal-Wallis test was not the focus of his dissertation, but he wanted to make some comparisons to the Kruskal-Wallis test. Given that he was working on exact methods, he did not think it would be fair (or accurate) to compare exact results to large-sample approximate results. When he looked to see how far the existing Kruskal-Wallis critical value tables, he discovered that they all went up to <em>n</em> = 15, with three conditions of five in each condition. (Actually, that was not too bad for the computing power available when those tables were created in the 50s!)</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">15</span>)<span class="op">/</span>(<span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">5</span>)<span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">5</span>)<span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span>(<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">#&gt; [1] 756756</span></a></code></pre></div>
<p>The doctoral student did some calculations like the ones we did above and came to the same conclusion that we did: To go further would take more time than he was willing to give, or for that matter had time enough in the remaining history of the world. According to the story, that bothered him, so he got very little sleep for several weeks as he tried to create a way around the problem. Finally he hit on an idea. I won’t go into the details. (I kept the details, as they were presented at AERA, in case anyone is interested.) Suffice it to say that he found a way to trade off time for space by building distributions on top of one another. It would not take as long, but it would take a lot of space on his computer. Nonetheless, he purchased the largest hard drive he could find at the time (and afford as a graduate student), wrote a program, and set it in action. By the time his drive was completely full, he had calculated critical values for <em>n</em> = 45, with 15 units per condition for three conditions. That was sufficient for him to finish his dissertation and use the exact Kruskal-Wallis, with this method of creating critical values becoming a footnote in the dissertation.</p>
<p>Fast forward about fifteen years. By this time this former doctoral student was a university professor, with students of his own. For several years he had a student who loved writing computer programs. That gave him an idea. His program no longer worked (computer code compilers had evolved), yet hard drives had become much, much bigger. He presented his student with a proposal. If the student would update the code so that it would work with the new compilers, and if they could build an even bigger table of critical values, the student could get a publication as first author. The student happily agreed. The code was updated, new hard drives were purchased, and the program was set in motion. The result is the table of Kruskal-Wallis critical values that we have today, going up to <em>n</em> = 105 for three groups and <em>n</em> = 32 for four groups. (Doing the calculations for four groups took much more space on the hard drives.)</p>
<p>In sum, you can use the Kruskal-Wallis function to obtain the value of H. If your sample size is within the limit of the critical value table, you can do an exact test for <span class="math inline">\(\alpha\)</span> of .10, .05, or .01. Once the sample size exceeds what is available in the tables, you can feel safer about using a mathematical distribution (the chi-square distribution) for a large-sample approximation.</p>
</div>
<<<<<<< HEAD
=======
<div id="multiple-comparisons" class="section level3">
<h3 class="hasAnchor">
<a href="#multiple-comparisons" class="anchor"></a>Multiple comparisons</h3>
</div>
>>>>>>> master
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Michael Seaman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
