<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Sign Test • nplearn</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The Sign Test">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nplearn</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9013</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Bernoulli-Events.html">Bernoulli Events</a>
    </li>
    <li>
      <a href="../articles/binomdist.html">The Binomial Distribution</a>
    </li>
    <li>
      <a href="../articles/gof.html">Goodness of Fit</a>
    </li>
    <li>
      <a href="../articles/lsprop.html">Large-Sample Proportion Inference</a>
    </li>
    <li>
      <a href="../articles/OnePropExact.html">Exact Inference for a Single Proportion</a>
    </li>
    <li>
      <a href="../articles/randomization.html">Randomization Tests</a>
    </li>
    <li>
      <a href="../articles/releffic.html">Relative Efficiency</a>
    </li>
    <li>
      <a href="../articles/ReplaceScores.html">Replacement Scores</a>
    </li>
    <li>
      <a href="../articles/signtest.html">The Sign Test</a>
    </li>
    <li>
      <a href="../articles/Workflow-Sample.html">Workflow Sample</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>The Sign Test</h1>
            
      
      
      <div class="hidden name"><code>signtest.Rmd</code></div>

    </div>

    
    
<p>The sign test is a special case of the binomial test. In this vignette you will learn why it is an important special case. You will also learn about various situations in which this simple test can provide an opportunity for inference.</p>
<div id="required-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#required-packages" class="anchor"></a>Required packages</h3>
<p>The packages needed for this vignette are the nplearn and DescTools packages.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(nplearn)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(DescTools)</span></code></pre></div>
</div>
<div id="the-matched-pairs-design" class="section level3">
<h3 class="hasAnchor">
<a href="#the-matched-pairs-design" class="anchor"></a>The matched pairs design</h3>
<p>We now consider a research design in which units are paired on the basis of one or more extraneous variables so that when a response is measured for every unit in the study, the measures obtained from one member of each pair are correlated with those obtained from the other member of each pair. Units can be paired naturally or via an experimental process. Examples of natural pairing include twins, siblings, bushels of fruit collected from the same tree, weather metrics recorded on the same day, and puppies from the same litter. Pairing via an experimental process requires observation of an extraneous variable known to be related to the response variable of interest. In this case, the stronger the relationship of the extraneous and response variable, the stronger the pair and, consequently, the more power the study will have for detecting treatment effects. One example is the pairing of students on the basis of achievement test results when the study will involve a method designed to increase achievement. Another example is pairing patients on a measure of disease progression when the study will be about a treatment designed to eradicate the disease or alleviate the symptoms.</p>
<p>The value of the matched pairs design is that it can substantially reduce the variation in a response measure that is due to one or more extraneous variables. This reduction of <i>noise</i> (i.e., variation in observations that is not due to the independent, or explanatory, variable) can make it substantially easier to detect the <i>signal</i> (i.e., the effect of an indpendent or explanatory variable). A practical implication is that the design is more efficient. That is, fewer units will be needed to detect the treatment effect than would be needed using two independent samples to attempt to detect the same size effect. The obvious disadvantage of the design is that it requires either finding naturally matched units or creating such matches. To create a match will necessitate the use of an existing measure of an extraneous variable or making new measurements prior to the implementation of the matched pairs design.</p>
<p>In an observational study of natural pairs, the members of each pair are in different categories of the explanatory variable. For example, a 1966 study of 27 pairs of monozygotic twins looked at differences in scores on a test of intelligence for each twin pair. These pairs were chosen because the twins had been separated at birth, with one of the twins raised by the biological parents and the other raised in a foster home. In this case, the explanatory variable is the type of home in which the twin was raised, so it was necessary to select twin pairs that reflected this difference.</p>
<p>A more common approach is to experimentally create the explanatory variable, making certain that one member of each pair is placed in one category of the variable, such as a control condition, traditional intervention, or placebo condition, and the other member of each pair is placed in the other cateogry, such as a treatment condition. As I will discuss in more detail later, the conclusions of such a study are strengthened if the choice of which pair member is in which condition is based on random assignment.</p>
</div>
<div id="the-sign-test" class="section level3">
<h3 class="hasAnchor">
<a href="#the-sign-test" class="anchor"></a>The sign test</h3>
<p>Consider a study of two fertilizer options for fruit trees. Suppose that two trees were planted on each of six plots of land. Plots might be defined not only in terms of location, but soil characteristics (e.g., pH and granular form), sun exposure, wind exposure, and so forth. Thus, the two trees on each plot can be considered a pair due to their similarity on a variety of extraneous variables that are related to the variable of interest: fruit production. Further suppose that each tree received a treatment of fertilizer at regular intervals, but the trees in each pair received different types of fertilizer. (Although the trees are paired by their planting on the same plot, they would need to be planted far enough apart to avoid any crossover effect from the fertilizers.) To strengthen the validity of conclusions about the different fertilizers, the researcher randomly selected the member of each pair that would receive Fertilizer A, then applied Fertilizer B to the other member of the pair.</p>
<p>At some point, ripe fruit was picked off of all trees. Shown below are the results of this hypothetical study when entered into R. The observations are the number of pieces of ripe fruit.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>fruit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">A =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">82</span>, <span class="dv">91</span>, <span class="dv">74</span>, <span class="dv">90</span>, <span class="dv">66</span>, <span class="dv">81</span>),</span>
<span id="cb2-2"><a href="#cb2-2"></a>                    <span class="dt">B =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">85</span>, <span class="dv">89</span>, <span class="dv">81</span>, <span class="dv">96</span>, <span class="dv">65</span>, <span class="dv">93</span>))</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(fruit<span class="op">$</span>A, fruit<span class="op">$</span>B)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt; [1,]   82   85</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt; [2,]   91   89</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; [3,]   74   81</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt; [4,]   90   96</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#&gt; [5,]   66   65</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt; [6,]   81   93</span></span></code></pre></div>
<p>The relative effectiveness of fertilizers can be measured by looking at the difference in fruit production within each tree pair. We will subtract the fruit quantity produced with the help of one type of fertilizer from the quantity produced with the help of the other type. It does not matter which way we subtract, but it does matter that we keep track of which way we subtract so as to make legitimate statements about fertilizer effectiveness.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>A.minus.B &lt;-<span class="st"> </span>fruit<span class="op">$</span>A <span class="op">-</span><span class="st"> </span>fruit<span class="op">$</span>B</span>
<span id="cb3-2"><a href="#cb3-2"></a>A.minus.B</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt; [1]  -3   2  -7  -6   1 -12</span></span></code></pre></div>
<p>Notice that for each pair of trees we can derive two pieces of information: which fertilizer produced the highest yield and how much difference there is in yield. The first piece of information is provided by the sign of the number and the second by the quantity of the number. The <i>sign test</i> focuses, as you might guess, on the sign of the number. That is, the focus is on which fertilizer produced the highest yield in each tree pair. Given that our order of subtraction is A minus B, a positive number suggests a win for A.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>A.minus.B <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#&gt; [1] FALSE  TRUE FALSE FALSE  TRUE FALSE</span></span></code></pre></div>
<p>There are two plus signs and four minus signs in these data. The trees with Fertilizer B outperformed the trees with Fertilizer A most of the time (a two to one win). Given that one tree was likely to outperform the other, can we attribute this outcome to the superior performance of Fertilizer B? Perhaps, yet it is possible that there are other extraneous variables at work. Maybe the seeds themselves made the difference. Maybe more trees with Fertilizer B received more water than trees with Fertilizer A. There are likely many extraneous variables that we have not even considered. This is why it was so important to randomly assign fertilizers to one member of each tree pair. If that was done in this study, and if the type of fertilizer is really not responsible for the difference in yield, then the numbers of positive and negative signs in our data are simply the result of chance. Under the hypothesis of no difference in fertilizer effectiveness, the number of A trees that outperformed B trees (and vice versa) is simply due to chance assignment.</p>
<p>If chance assignment is the reason for differences in the numbers of signs, we can calculate the probability that Fertilizer A trees will result in just two positive signs. This is a binomial problem with six Bernoulli events and the probability of a Fertilizer A tree receiving a positive sign is 0.5. This is the same as the probability of obtaining “heads up” with the flip of a fair coin, and indeed that may be exactly how the researcher decided which tree would receive which fertilizer!</p>
<p>Here are the parameters of the binomial distribution.</p>
<p><span class="math inline">\(n = 6\)</span></p>
<p><span class="math inline">\(\pi = 0.5\)</span></p>
<p>Here’s the picture of the probability distribution.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="../reference/binom_plot.html">binom_plot</a></span>(<span class="dv">6</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="signtest_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>With a little thought, you may recognize that the picture we are looking at here is under some sort of null hypothesis stating that neither fertilizer is more effective than the other. The picture shows the probability of every possible number of positive signs for our difference scores when the sign of the difference is due to chance assignment of fertilizers to trees, but nothing else. It is basically the same distribution we would get if we didn’t use fertilizer at all! In this case, a positive sign would be due to other non-fertilizer-related characteristics of the trees and placement of the trees. We could write a null hypothesis that looks something like this.</p>
<p><strong>Fertilizer doesn’t make a difference</strong></p>
<p>That’s a fine research null hypothesis, but how can we make it a statistical null hypothesis? The key is to think again about our difference scores. Is there any value of any statistic (and associated parameter) that will reflect an equal number of positive and negative difference scores? You probably have guessed that the answer is “yes.” Consider this null hypothesis.</p>
<p><span class="math inline">\(H_0: \theta = 0\)</span></p>
<p>We use <span class="math inline">\(\theta\)</span> to represent the population median. If the chance of a difference score being positive is the same as the chance of a difference score being negative (that is, the probability of each if 50%), then the median of the difference scores is 0. For our fertilizer research, we can write the null and alternative hypotheses like this.</p>
<p><span class="math inline">\(H_0: \theta = 0\)</span></p>
<p><span class="math inline">\(H_a: \theta \ne 0\)</span></p>
<p>I am using a two-sided alternative here because we went into this study with no information that one fertilizer should be better than the other. The situation would have been different if, for example, we were told that Fertilizer B was developed based on new understanding of the properties of fertilizers so that the research is to confirm that Fertilizer B results in higher production than Fertilizer A.</p>
<p>Let’s set <span class="math inline">\(\alpha\)</span>, our maximum allowable Type I error rate, at 10%. Under the null hypothesis, here is the probability of obtaining only two plus signs for Fertilizer A.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="fl">0.5</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#&gt; [1] 0.34375</span></span></code></pre></div>
<p>For a two-sided test, we need to also include upper tail values that are equally incompatible with the null hypothesis. That is, we need to include the probability of four or more plus signs among our difference scores. (Notice that four plus signs would be the same as two negative signs for Fertilizer B.)</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">4-1</span>, <span class="dv">6</span>, <span class="fl">0.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">#&gt; [1] 0.6875</span></span></code></pre></div>
<p>A <em>p</em> value of 0.6875 will certainly not persuade us to view this as an unlikely outcome, so we must retain a median of 0 as a reasonable possibility for the value of the parameter. Yet we remember that the number of trees with Fertilizer B that outperformed their matched pair tree (not to be confused with a pear tree, which is reserved for partridges) was four out of the six, or 0.67. What gives?</p>
<p>We didn’t have much power for this test because we only used six matched pairs. Let’s see what would happen if we kept the 2 to 1 ratio the same, but used 30 matched pairs. (This would require us to plant 60 trees.) Here’s the picture under the null hypothesis.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw"><a href="../reference/binom_plot.html">binom_plot</a></span>(<span class="dv">30</span>, <span class="fl">.5</span>)</span></code></pre></div>
<p><img src="signtest_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>The 2 to 1 ratio would mean that we have 10 plus signs for Fertilizer A and 20 negative signs. Here’s the <em>p</em> value for the two-sided test.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">10</span>, <span class="dv">30</span>, <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">20</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">30</span>, <span class="fl">0.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">#&gt; [1] 0.09873715</span></span></code></pre></div>
<p>This is better! We have some convincing evidence that Fertilizer B outperforms Fertilizer A. Unlike with some hypotheses you may test with the binomial test, the sign test is always based on a null hypothesis of equal probability (0.5) of plus and minus signs, so the binomial distribution when the null hypothesis is true is symmetrical. Thus, for two-tailed tests it will work to double the probability in one tail when you are calculating the <em>p</em> value.</p>
</div>
<div id="a-confidence-interval-for-the-median" class="section level3">
<h3 class="hasAnchor">
<a href="#a-confidence-interval-for-the-median" class="anchor"></a>A confidence interval for the median</h3>
<p>Suppose in our fruit tree study that we have reason to believe that the median of difference scores is 1. (I have no idea why we might have a reason to believe this, but stick with me. I’ll put this irrational suspicion to rational use in a moment.) In practical terms, this would mean that the median increase in fruit production is one piece of fruit if Fertilizer B is used instead of Fertilizer A. Similarly, we could propose a median of -1, which would again mean an increase in fruit production, but this time if Fertilizer A is used instead of Fertilizer B.</p>
<p>By definition, the median has 50% of scores above it and 50% of scores beneath it. Therefore, we can test the hypothesis that the median is 1 using the sign test, because the sign test uses a null hypothesis that 50% of the signs are plus signs and 50% of the signs are minus signs. The only difference between this hypothesis test and the hypothesis of no difference in fruit production is that in the earlier hypothesis test, no difference in fruit production corresponded to a median of 0. Thus, we were able to look at the actual sign of each difference. For testing that the median is 1, we need to count any value above 1 as a “plus sign” and any value below 1 as a “minus sign”. This is a bit bizarre, because now we will think of 0 as having a minus sign.</p>
<p>Here are the differences we calculated earlier.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>A.minus.B</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">#&gt; [1]  -3   2  -7  -6   1 -12</span></span></code></pre></div>
<p>If the median value in the population is 1, then we have 1 value above this median and 4 values below this median. We also have a single value that falls right on the median. How are we going to handle this? One possibility is to just use the 5 values that are either above or below the median, and indeed that is what some statisticians recommend for this situation. This approach is a bit peculiar, because it means that you are throwing out the one data point that is totally consistent with the null hypothesis that the median is 1. That is stacking the deck in favor of the alternative hypothesis!</p>
<p>Let’s calculate the <em>p</em> value two ways. First, we’ll calculate it as if the value of 1 is above the median. Next, we’ll calculate it as if the value of 1 is below the median. Here’s the first way. Remember that we now have two plus signs (“above” 1) and four negative signs (below 1).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">4-1</span>, <span class="dv">6</span>, <span class="fl">0.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">#&gt; [1] 0.6875</span></span></code></pre></div>
<p>That should look familiar. It is the same <em>p</em> value we obtained when testing if the median is equal to 0. That’s no surprise because by counting 1 as “above” the median (even though it is right on the median), we are ending up with the same number of plus and minus signs as before. What happens if we count the 1 as being “below” the median?</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">5-1</span>, <span class="dv">6</span>, <span class="fl">0.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co">#&gt; [1] 0.21875</span></span></code></pre></div>
<p>That dramatically changed the picture! Neither of these <em>p</em> values will lead us to reject the null hypothesis of a population median of 1, based on our established tolerance for error of 10%, but this second <em>p</em> value gets us much closer to our rejection line. Which of these should we use? Given our distaste for Type I errors and knowing that the value in question is as strongly in support of the null hypothesis as possible (the value is 1 and our hypothesized median is also 1), I recommend that we use the first <em>p</em> value in order to move us further away from rejecting the null hypothesis and more likely to retain it.</p>
<p>If you remember the rule about confidence interval construction, you have probably guessed where this is all going. Let’s review the steps, adding this new rule that we just discussed.</p>
<ol style="list-style-type: decimal">
<li><p>Determine our confidence level. This will correspond to our tolerance for errors in that our confidence level will be <span class="math inline">\((1 - \alpha)100\%\)</span>, where <span class="math inline">\(\alpha\)</span> is the maximum Type I error rate that we can tolerate.</p></li>
<li><p>Hypothesize a median, <span class="math inline">\(\theta\)</span>.</p></li>
<li><p>Count how many of the matched pair differences are below the median (call these <em>minus signs</em>) and how many of these differences are above the median (call these <em>plus signs</em>). For a difference that is equal to the hypothesized median, call it either a minus sign or a plus sign, depending on which will make it more difficult to reject the null hypothesis. (Here’s a short cut: when a difference is equal to the hypothesized median, give it a plus or minus sign that will bring the number of plus and minus signs closer to each other, rather than farther away from each other.)</p></li>
<li><p>Reject hypotheses in which <span class="math inline">\(p \le \alpha\)</span>. Otherwise, retain the hypothesis.</p></li>
<li>
<p>Test all possible hypotheses. Symbolically, we can state it like this.</p>
<p><span class="math inline">\(H_0: \theta = \theta_0\)</span></p>
<p><span class="math inline">\(H_1: \theta \ne \theta_0\)</span></p>
<p><span class="math inline">\(-\infty &lt; \theta_0 &lt; +\infty\)</span></p>
</li>
<li><p>The confidence set consists of all values of <span class="math inline">\(\theta_0\)</span> that are retained.</p></li>
</ol>
<p>If we are interested in whether a median is only above or only below 0 (as we would have been if Fertilizer B was developed to be an improvement on Fertilizer A), then we would test a one-sided hypotheses. Aside from this, the construction of a lower-bounded or upper-bounded interval is the same.</p>
<p>In practice, we will not test every possible <span class="math inline">\(\theta_0\)</span> because we have other more interesting activities to pursue in life. Instead, we will search for the boundary between rejection and retention. For the above data, let’s test a median of 10. That gives us 1 plus sign and 5 minus signs.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">5-1</span>, <span class="dv">6</span>, <span class="fl">.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">#&gt; [1] 0.21875</span></span></code></pre></div>
<p>Let’s try these hypotheses.</p>
<p><span class="math inline">\(H_0: \theta = 3\)</span></p>
<p><span class="math inline">\(H_1: \theta \ne 3\)</span></p>
<p>We now have 0 plus signs and 6 negative signs.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">6-1</span>, <span class="dv">6</span>, <span class="fl">.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co">#&gt; [1] 0.03125</span></span></code></pre></div>
<p>We finally have a rejected null hypothesis. We will obtain similar results if we use these hypotheses.</p>
<p><span class="math inline">\(H_0: \theta = -13\)</span></p>
<p><span class="math inline">\(H_1: \theta \ne -13\)</span></p>
<p>Now we have 6 plus signs and 0 negative signs.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">6-1</span>, <span class="dv">6</span>, <span class="fl">.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="fl">.5</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co">#&gt; [1] 0.03125</span></span></code></pre></div>
<p>You probably noticed that this is the same calculation as the previous one, but with the addends swapped. We have determined that every hypothesized value that yields between 1 and 5 plus (or minus) signs will result in retention. Thus, we are able to define our 90% confidence interval.</p>
<p><span class="math inline">\(-12 \le \theta \le 2\)</span></p>
<p>There are a few elements of this interval construction that are noteworthy. First, we would have obtained the same rejection results if we had hypothesized -14 instead of -13 and 4 instead of 3. Yet we desire the narrowest interval we can obtain, so because -13 and 3 are also rejected, we use -12 and 2 as the first values in our retention region. These become the inclusive boundaries of the confidence interval.</p>
<p>My other comment is a bit more disconcerting. Our testing has wandered outside of the range of our data in order to obtain a 90% confidence interval. That feels a bit like extrapolating beyond the data, so I’m not totally comfortable. That said, it is the best we can do with such a small sample size.</p>
<p>Previously, I provided an example of hypothesis testing with a larger sample size, so it seems in order to do the same for a confidence interval example. The difference here is that we need differences. (Pun only partially intended.) If we want to construct a confidence interval for the median, we need to know more than how many times Fertilizer B beat Fertilizer A. We need to know the extent of this beating by comparing fruit yields.</p>
<p>Here is a (hypothetical) construction of yield differences where I subtracted the yield for A from the yield of the B matched pair tree. Note that I switched the order of subtraction so as to have more positive signs. My only reason for doing this is that I think it makes it easier to teach about an improvement (such as what we are seeing in these data when using Fertilizer B) when the scores are positive.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>B.minus.A &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">-1</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">25</span>, <span class="dv">15</span>, <span class="dv">5</span>, <span class="dv">125</span>, <span class="dv">61</span>, <span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">-2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">12</span>,</span>
<span id="cb16-2"><a href="#cb16-2"></a>               <span class="dv">23</span>, <span class="dv">1</span>, <span class="dv">86</span>, <span class="dv">17</span>, <span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">-1</span>, <span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">-2</span>, <span class="dv">58</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">18</span>, <span class="dv">1</span>, <span class="dv">40</span>, <span class="dv">-1</span>,</span>
<span id="cb16-3"><a href="#cb16-3"></a>               <span class="dv">2</span>, <span class="dv">12</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">-2</span>, <span class="dv">1</span>, <span class="dv">56</span>, <span class="dv">5</span>, <span class="dv">-2</span>, <span class="dv">8</span>, <span class="dv">-2</span>, <span class="dv">-1</span>, <span class="dv">30</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">52</span>,</span>
<span id="cb16-4"><a href="#cb16-4"></a>               <span class="dv">3</span>, <span class="dv">-1</span>, <span class="dv">52</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">9</span>, <span class="dv">145</span>, <span class="dv">17</span>)</span></code></pre></div>
<p>Let’s determine how many matched pairs we have observed and how many plus signs are in these data.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(B.minus.A)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">#&gt; [1] 60</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(B.minus.A <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co">#&gt; [1] 45</span></span></code></pre></div>
<p>That means there must be 15 values that are either minus signs or 0. (I’m going to leave 0 in with the minus signs to reduce the chance of rejecting the null hypothesis.) Here’s the <em>p</em> value.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">15</span>, <span class="dv">60</span>, <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">45-1</span>, <span class="dv">60</span>, <span class="fl">.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co">#&gt; [1] 0.0001345141</span></span></code></pre></div>
<p>I’m quite confident that the fertilizers are not equally effective. Using what we have learned about confidence interval construction, let’s determine an interval for the population median. The previous time we did this, we used a trial and error method to find the number of plus signs that would result in rejection of the null hypothesis. That could be time consuming for larger data sets, such as this one, so let us be a bit more systematic in our approach. This time we will use a 5% error rate so that we can develop a 95% confidence interval. We are using a symmetrical binomial distribution (remember that <span class="math inline">\(\pi_0 = .5\)</span> for all of our tests), so we can split the error rate into two equal parts and put a proportion of .025 in each tail of the distribution. With this knowledge in hand, we can find the number of plus signs needed to reject the null hypothesis.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>cv &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">qbinom</a></span>(<span class="fl">0.975</span>, <span class="dv">60</span>, <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>cv</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">#&gt; [1] 39</span></span></code></pre></div>
<p>We can reject the null hypothesis in the upper tail of the distribution if we have 39 or more plus signs. Similarly, we can reject the null hypothesis in the lower tail of the distribution if we have 39 or more negative signs, which would equate to 60 - 39 = 21 or fewer plus signs. Here’s a check of our work.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">21</span>, <span class="dv">60</span>, <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">39-1</span>, <span class="dv">60</span>, <span class="fl">0.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co">#&gt; [1] 0.02734013</span></span></code></pre></div>
<p>Notice what we get if we add one more sign to the rejection region in each tail.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">22</span>, <span class="dv">60</span>, <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">38-1</span>, <span class="dv">60</span>, <span class="fl">0.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co">#&gt; [1] 0.0518939</span></span></code></pre></div>
<p>This slightly exceeds our tolerance for Type I errors. Thus, we will use 21 and 39 as our critical values, noting in the process that <span class="math inline">\(\hat{\alpha} = 0.027\)</span>.</p>
<p>The trick now is to find the differences that will result in 21 or fewer plus signs or 39 or more plus signs. Let’s sort our differences. (Not to be confused with “let’s sort out our differences,” though if you are explaining all of this to someone opposed to nonparametric statistical methods, both phrases may apply.)</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>B.minus.A &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>(B.minus.A)</span>
<span id="cb22-2"><a href="#cb22-2"></a>B.minus.A</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co">#&gt;  [1]  -2  -2  -2  -2  -2  -1  -1  -1  -1  -1  -1  -1   0   0   0   1   1</span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co">#&gt; [18]   1   1   1   1   2   2   2   2   2   3   3   3   4   5   5   5   6</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">#&gt; [35]   6   7   7   7   8   9  12  12  12  15  17  17  18  18  23  25  30</span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co">#&gt; [52]  40  52  52  56  58  61  86 125 145</span></span></code></pre></div>
<p>Now it is easy to find the difference values that sit on our critical values. (Note that if we count from 40 to 60, including 40, there are 21 values, which is why we are taking the 40th value rather than the 39th value.)</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>B.minus.A[<span class="dv">21</span>]</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>B.minus.A[<span class="dv">40</span>]</span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co">#&gt; [1] 9</span></span></code></pre></div>
<p>We will reject any difference that is greater than or equal to 9 because there are 21 numbers (plus signs) that are 9 or above. Let’s check that.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(B.minus.A <span class="op">&gt;=</span><span class="st"> </span><span class="dv">9</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="co">#&gt; [1] 21</span></span></code></pre></div>
<p>Similarly we will reject any difference that is less than or equal to 1 because there are 39 numbers (plus signs) above 1. Let’s check that, as well.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(B.minus.A <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="co">#&gt; [1] 39</span></span></code></pre></div>
<p>Another way to think of this is that we have 21 numbers greater than or equal to 9 (plus signs) and 21 numbers less than or equal to 1 (minus signs).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(B.minus.A <span class="op">&gt;=</span><span class="st"> </span><span class="dv">9</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co">#&gt; [1] 21</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(B.minus.A <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co">#&gt; [1] 21</span></span></code></pre></div>
<p>Either way you prefer to think about it, the point is that we will reject the null hypotheses about the median being 9 or above 9, as well as null hypotheses about the median being 1 or below 1. Further, these values sit right on the edge of the rejection region. The next values in our data set after these, the first ones in our retention region, are 2 and 8. We would retain hypotheses about 2 and 8, as well as any value in between.</p>
<p><span class="math inline">\(2 \le \theta \le 8\)</span></p>
<p>We have now created a 95% confidence interval for the median. In practical terms, this tells us that switching from Fertilizer A to Fertilizer B will result in a median yield increase of 2 to 8 pieces of fruit. (If Fertilizer B is more costly, switching may not be worth it.)</p>
<p>Let’s use these data one more time to construct a one-sided confidence interval for the median difference. This is what we would do if one fertilizer was purposefully developed to be an improvement over the other. The choice of a one-sided interval is not a decision based on the data, but one based on theoretical understanding. Here are the hypotheses.</p>
<p><span class="math inline">\(H_0: \theta = 0\)</span></p>
<p><span class="math inline">\(H_A: \theta &gt; 0\)</span></p>
<p>If the population median is 0, as reflected by the null hypothesis, we would expect the same number of plus and minus signs in our data. If the population median is above 0, as reflected in the alternative hypothesis, we would expect more plus signs than minus signs in our data. Thus, we want to reject the null hypothesis in favor of the alternative hypothesis when there are more plus signs than would be expected by mere chance assignment of our fruit trees. Let’s calculate how many that would be if we want 95% confidence.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>cv &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">qbinom</a></span>(<span class="fl">0.95</span>, <span class="dv">60</span>, <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>cv</span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="co">#&gt; [1] 37</span></span></code></pre></div>
<p>We will reject the null hypothesis if we have at least 37 plus signs. We saw earlier that we have 45 plus signs, so we know, with 95% confidence, that the median is above 0. (This is no surprise because our two-sided interval was completely above 0.) Next, let’s use these hypotheses.</p>
<p><span class="math inline">\(H_0: \theta = 1\)</span></p>
<p><span class="math inline">\(H_A: \theta &gt; 1\)</span></p>
<p>Notice that this will reduce the number of plus signs by 6, because there are 6 values of 1 in our data.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(B.minus.A <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="co">#&gt; [1] 39</span></span></code></pre></div>
<p>We can reject this null hypothesis as well because the observed test statistic, the number of plus signs, is above our critical value of 37 plus signs. Let’s do this one more time with these hypotheses.</p>
<p><span class="math inline">\(H_0: \theta = 2\)</span></p>
<p><span class="math inline">\(H_A: \theta &gt; 2\)</span></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(B.minus.A <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="co">#&gt; [1] 34</span></span></code></pre></div>
<p>We clearly cannot reject this null hypothesis. Notice that the observed value of the test statistic jumped from 39 to 34. That is because we have 5 values of 2 in the data. If we had observed 1 or 2 values of 2, we could have rejected the null hypothesis. As it is, it would be foolhardy to reject the hypothesis based on some of the values of 2 but retain it for others. We must retain the null hypothesis. The consequence of all these values of 2 is that our <span class="math inline">\(\hat{\alpha}\)</span> has moved away from <span class="math inline">\(\alpha\)</span>. This will yield a less informative interval than we would have had if every fruit yield difference had been unique. In fact, our lower bound is no more informative in this one-sided interval, where we put our entire tolerance for error (5%) in one tail of the distribution, than it was for the two-sided interval. Such is the nature of the real world. Ignoring the effects of worms, fruit yield will be in discrete and whole units, so probabilities are not continuous. As a result, life as a nonparametric statistican can look strange. Keep in mind that the strangeness really resides in the tradition we’ve become used to: Treating discrete numbers as though they are plucked from a continuous distribution. Now <strong>that</strong> is strange!</p>
<p>Here is our interval.</p>
<p><span class="math inline">\(\theta \ge 2\)</span></p>
<p>You are probably hoping that I’m going to surprise you with a function that will do all of this for us. Surprise! The function is not part of Base R, but it is available in a package written by Andri Signorell. Here it is being used for our two-sided test and interval.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">SignTest</span>(B.minus.A)</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="co">#&gt; </span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="co">#&gt;  One-sample Sign-Test</span></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="co">#&gt; </span></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="co">#&gt; data:  B.minus.A</span></span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="co">#&gt; S = 45, number of differences = 57, p-value = 1.313e-05</span></span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="co">#&gt; alternative hypothesis: true median is not equal to 0</span></span>
<span id="cb30-8"><a href="#cb30-8"></a><span class="co">#&gt; 97.3 percent confidence interval:</span></span>
<span id="cb30-9"><a href="#cb30-9"></a><span class="co">#&gt;  2 8</span></span>
<span id="cb30-10"><a href="#cb30-10"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb30-11"><a href="#cb30-11"></a><span class="co">#&gt; median of the differences </span></span>
<span id="cb30-12"><a href="#cb30-12"></a><span class="co">#&gt;                       4.5</span></span></code></pre></div>
<p>If you go back and look at the <em>p</em> value we calculated for the sign test to test the original number of signs, that is, using the hypothesis that <span class="math inline">\(\theta = 0\)</span>, you will see that it matches with the <em>p</em> value reported by this function, so that’s the meaning of the <em>p</em> value. The confidence interval also matches our two-sided confidence interval. Notice that it is inclusive of the reported boundaries. The function also reports the point estimate, which is the median of differences for our sample and the best single guess of the population median, though without confidence. Let’s see how to obtain the one-sided interval.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">SignTest</span>(B.minus.A, <span class="dt">alternative =</span> <span class="st">"greater"</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="co">#&gt; </span></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="co">#&gt;  One-sample Sign-Test</span></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="co">#&gt; </span></span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="co">#&gt; data:  B.minus.A</span></span>
<span id="cb31-6"><a href="#cb31-6"></a><span class="co">#&gt; S = 45, number of differences = 57, p-value = 6.564e-06</span></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="co">#&gt; alternative hypothesis: true median is greater than 0</span></span>
<span id="cb31-8"><a href="#cb31-8"></a><span class="co">#&gt; 95.4 percent confidence interval:</span></span>
<span id="cb31-9"><a href="#cb31-9"></a><span class="co">#&gt;    2 Inf</span></span>
<span id="cb31-10"><a href="#cb31-10"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb31-11"><a href="#cb31-11"></a><span class="co">#&gt; median of the differences </span></span>
<span id="cb31-12"><a href="#cb31-12"></a><span class="co">#&gt;                       4.5</span></span></code></pre></div>
<p>The confidence interval is reported as “2 to inf.” The “inf” stands for infinity, which simply means that we have constructed a lower-bounded confidence interval.</p>
<p>Here’s one more little trick with this function. Remember that in our original example we started by recording the amount of fruit picked from each tree, putting matched pairs in the same order for each fertilizer type.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>fruit<span class="op">$</span>A</span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="co">#&gt; [1] 82 91 74 90 66 81</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>fruit<span class="op">$</span>B</span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="co">#&gt; [1] 85 89 81 96 65 93</span></span></code></pre></div>
<p>We can use the differences as an argument to the SignTest function, as we did above, or we can provide the measures separately, but in the matched order.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">SignTest</span>(fruit<span class="op">$</span>A, fruit<span class="op">$</span>B, <span class="dt">conf.level =</span> <span class="fl">0.90</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="co">#&gt; </span></span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="co">#&gt;  Dependent-samples Sign-Test</span></span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="co">#&gt; </span></span>
<span id="cb33-5"><a href="#cb33-5"></a><span class="co">#&gt; data:  fruit$A and fruit$B</span></span>
<span id="cb33-6"><a href="#cb33-6"></a><span class="co">#&gt; S = 2, number of differences = 6, p-value = 0.6875</span></span>
<span id="cb33-7"><a href="#cb33-7"></a><span class="co">#&gt; alternative hypothesis: true median difference is not equal to 0</span></span>
<span id="cb33-8"><a href="#cb33-8"></a><span class="co">#&gt; 96.9 percent confidence interval:</span></span>
<span id="cb33-9"><a href="#cb33-9"></a><span class="co">#&gt;  -12   2</span></span>
<span id="cb33-10"><a href="#cb33-10"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb33-11"><a href="#cb33-11"></a><span class="co">#&gt; median of the differences </span></span>
<span id="cb33-12"><a href="#cb33-12"></a><span class="co">#&gt;                      -4.5</span></span></code></pre></div>
</div>
<div id="conditions-for-valid-inference" class="section level3">
<h3 class="hasAnchor">
<a href="#conditions-for-valid-inference" class="anchor"></a>Conditions for valid inference</h3>
<p>As always, calculating correct values is only part of the story when it comes to valid inference. We also must ascertain that our inferential statments are consistent with our research processes. In my experience I have observed that it is quite common for researchers to either make statements about the conditions for valid inference without actually matching each statement to the research process or to ignore the conditions entirely. In either case, statements of inference can be misleading, at best, and potentially dishonest. We must go beyond calculation to put careful thought into what we can and cannot say. The good news is that even when conditions are not completely met, usually our study can still inform practice, even though we may have to curb our enthusiasm about how we report our outcomes.</p>
<p>The first condition for valid inference back to a larger population is that we have randomly sampled from that population. As I’ve discussed before, in the behavioral and social sciences we rarely are able to sample from the entire population of interest, yet a more limited random sampling can still provide use a rationale for inference. Even without random sampling, we can often consider our sample as what we might obtain through random sampling from some population of interest. In the current agriculture setting, it is doubtful that the seeds for these trees were randomly selected from the population of seeds for this particular type of fruit. Yet it is very likely that there is nothing special or specific about these seeds so that they could represent the larger population of seeds, much as if they had been randomly selected.</p>
<p>The second condition for valid inference with the sign test is that the units within each matched pair were randomly assigned (i.e., <em>randomized</em>) to one of the two conditions. This condition is necessary to confirm that it is the explanatory variable, rather than extraneous varibles, responsible for any observed difference. In the present example, if we did not randomize the fruit trees to the fertilizer conditions, then there might be some other condition, such as sun exposure, that could be responsible for differences in production. This could occur without researcher awareness, for levels of extraneous variables can often be undetected in such a study. It could be the case that even with randomization that sun exposure is greater for trees receiving one type of fertilizer, but the randomization process assures us that this is not a systematic bias. The incidence of non-systematic bias is accounted for in our recognized potential for a Type I error, for which we are able to determine our maximum tolerance.</p>
<p>There is one type of study in which random sampling, but not randomization, is key to inference, and that is when the study is not about a treatment effect, but rather is about understanding the characteristics of a single population of scores. In such a case there is no treatment-control comparison, so there are no matched pairs. The sign test can still be used to construct a confidence interval for the median, but in this situation the median of interest is the median of a population of scores, rather than the median of differences. It is also the case that in this single-sample non-experimental situation that the scores can be ordinal (ordered categories), rather than interval (quantitative). Unlike the mean, the median is a valid indicator of central tendency with ordinal data. In a randomized experiment, however, the use of difference scores requires that our measures be quantitative. That is, the data must be at least interval.</p>
<p>It is possible to make inferences when you use a matched-pair design with a randomized experiment and only make ordinal measurements. In this situation the process involves determining a “winner” in each matched pair. A win in one direction is counted as a plus sign, while a win in the other direction is counted as a minus sign. The sign test can then be employed to determine if we can infer that a favorable outcome for one condition is evidence of treatment effectiveness. This is a single hypothesis test as we are unable to conduct multiple tests of median difference, so we cannot construct a confidence interval.</p>
<p>The third condition for valid inference is that matched pairs are independent of one another. Measures within pairs are not independent of each other. Indeed, they have been purposefully matched on various characteristics related to the variable of interest. Yet each pair should be independent of each other pair. In the present example, this was assured through using separate planting areas for each pair of fruit trees.</p>
<p>If you read about the sign test from other sources, you will freqently encounter a fourth condition. Namely, that scores must be continous. The purpose of this condition is to guarantee that a plus or minus sign will be available for every difference. If values are truly continuous, they will never be equal, so this will indeed ensure that every difference is associated with a sign. In reality, however, we use discerete measurement. Thus, we may declare a matched pair to be equivalent on our measure. If a “winner” can be declared, we can avoid such ties. If not, the methods described above will yield tests and intervals that control our Type I error rate. The consequence of ties will be a more conservative test or confidence interval.</p>
<p>For those who are new to nonparametric inference, it may seem unusual to use the median, rather than the mean, as the central tendency parameter. If this seems strange, it is because the mean is ubiquitous in parametric inference. Yet the median is a strong contendor as a measure of central tendency with desirable properties. Among these is an insensitivity to outliers that can be overly influential on the mean. Further, when the population is symetrical, the values of the mean and the median are the same. This equivalency suggests that if we add a condition of symmetry, we can build a confidence interval for the mean, rather than the median. This is true, though I recommend that we dispense with this additional condition and build intervals for the population median. I see no advantage in creating a confidence interval for the mean, other than to maintain friendships with those who choose to invest all of their energies in parametric inference. Even in those cases, we may be able to keep both our median-oriented confidence intervals and our friendships if we consider additional procedures, such as buying after-work drinks or bringing in doughnuts.</p>
<p>Let me end this discussion about the conditions for valid inference by considering those conditions we grew up with when we first learned about parametric inference. With a matched-pair design, we were able to test the following hypotheses.</p>
<p><span class="math inline">\(H_0: \mu = \mu_0\)</span></p>
<p><span class="math inline">\(H_a: \mu \ne \mu_0\)</span></p>
<p>Here, <span class="math inline">\(\mu_0\)</span> is a specific null hypothesis. By considering all values for this hypothesis, we were able to build a confidence interval for the mean. The conditions for valid inference in this setting are those listed above (random sample, randomization, and independence of matched pairs), plus an additional condition that the differences calculated for comparing our treatment-control pairs is normally distributed. This last assumption is referred to as a <em>strong</em> condition. The term <em>strong</em> does not mean it is a valuable condition, but that it is a more strict condition than the others. With the sign test for a median, we can dispense with strong conditions. If we desire a confidence interval for the mean, rather than the median, then we must consider the strong condition that differences scores are symmetrical. This is more difficult to ascertain than the other conditions, yet the condition is still not as strong as the requirement that the differences scores are normally distributed.</p>
</div>
<div id="a-test-for-trend" class="section level3">
<h3 class="hasAnchor">
<a href="#a-test-for-trend" class="anchor"></a>A test for trend</h3>
<p>In 1955, D. R. Cox and A. Stuart published an article in <em>Biometrika</em> in which they suggested using the sign test for a test of trend. Their method is simple. They compared the first half of ordered scores to the second half by taking each measure in the first half and comparing it to a corresponding measure in the second half. When the second half measure exceeded that of the first half, they designated that as a plus sign. If not, they designated it as a minus sign.</p>
<p>Here are the average global land-ocean temperatures for the years 1999 through 2018 (Source: NASA’s Goddard Institute for Space Studies).</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>year &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1999</span><span class="op">:</span><span class="dv">2018</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a>temp &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.39</span>, <span class="fl">0.40</span>, <span class="fl">0.54</span>, <span class="fl">0.63</span>, <span class="fl">0.63</span>, <span class="fl">0.54</span>, <span class="fl">0.68</span>, <span class="fl">0.64</span>, <span class="fl">0.67</span>, <span class="fl">0.55</span>, <span class="fl">0.66</span>,</span>
<span id="cb34-3"><a href="#cb34-3"></a>          <span class="fl">0.73</span>, <span class="fl">0.61</span>, <span class="fl">0.65</span>, <span class="fl">0.69</span>, <span class="fl">0.75</span>, <span class="fl">0.90</span>, <span class="fl">1.02</span>, <span class="fl">0.93</span>, <span class="fl">0.85</span>)</span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(year, temp)</span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="co">#&gt;       year temp</span></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="co">#&gt;  [1,] 1999 0.39</span></span>
<span id="cb34-7"><a href="#cb34-7"></a><span class="co">#&gt;  [2,] 2000 0.40</span></span>
<span id="cb34-8"><a href="#cb34-8"></a><span class="co">#&gt;  [3,] 2001 0.54</span></span>
<span id="cb34-9"><a href="#cb34-9"></a><span class="co">#&gt;  [4,] 2002 0.63</span></span>
<span id="cb34-10"><a href="#cb34-10"></a><span class="co">#&gt;  [5,] 2003 0.63</span></span>
<span id="cb34-11"><a href="#cb34-11"></a><span class="co">#&gt;  [6,] 2004 0.54</span></span>
<span id="cb34-12"><a href="#cb34-12"></a><span class="co">#&gt;  [7,] 2005 0.68</span></span>
<span id="cb34-13"><a href="#cb34-13"></a><span class="co">#&gt;  [8,] 2006 0.64</span></span>
<span id="cb34-14"><a href="#cb34-14"></a><span class="co">#&gt;  [9,] 2007 0.67</span></span>
<span id="cb34-15"><a href="#cb34-15"></a><span class="co">#&gt; [10,] 2008 0.55</span></span>
<span id="cb34-16"><a href="#cb34-16"></a><span class="co">#&gt; [11,] 2009 0.66</span></span>
<span id="cb34-17"><a href="#cb34-17"></a><span class="co">#&gt; [12,] 2010 0.73</span></span>
<span id="cb34-18"><a href="#cb34-18"></a><span class="co">#&gt; [13,] 2011 0.61</span></span>
<span id="cb34-19"><a href="#cb34-19"></a><span class="co">#&gt; [14,] 2012 0.65</span></span>
<span id="cb34-20"><a href="#cb34-20"></a><span class="co">#&gt; [15,] 2013 0.69</span></span>
<span id="cb34-21"><a href="#cb34-21"></a><span class="co">#&gt; [16,] 2014 0.75</span></span>
<span id="cb34-22"><a href="#cb34-22"></a><span class="co">#&gt; [17,] 2015 0.90</span></span>
<span id="cb34-23"><a href="#cb34-23"></a><span class="co">#&gt; [18,] 2016 1.02</span></span>
<span id="cb34-24"><a href="#cb34-24"></a><span class="co">#&gt; [19,] 2017 0.93</span></span>
<span id="cb34-25"><a href="#cb34-25"></a><span class="co">#&gt; [20,] 2018 0.85</span></span></code></pre></div>
<p>To use the Cox-Stuart test for trend, we will compare first half temperatures to those in the second half. We will compare 1999 to 2009, 2000 to 2010, 2001 to 2011, and so on. Whenever the second half temperature is greater than the first half comparison, we will designate this as a plus sign. Otherwise, we will designate it as a minus sign.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>first.half &lt;-<span class="st"> </span>temp[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</span>
<span id="cb35-2"><a href="#cb35-2"></a>second.half &lt;-<span class="st"> </span>temp[<span class="dv">11</span><span class="op">:</span><span class="dv">20</span>]</span>
<span id="cb35-3"><a href="#cb35-3"></a>plus.sign &lt;-<span class="st"> </span>second.half <span class="op">&gt;</span><span class="st"> </span>first.half</span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(plus.sign)</span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="co">#&gt; [1] 10</span></span></code></pre></div>
<p>With this first half comparison to the second half, the null hypothesis of no trend is that the probability of the second half value being greater than the first half value is 0.5.</p>
<p><span class="math inline">\(H_0: \pi_{2nd} = \pi_{1st}\)</span></p>
<p><span class="math inline">\(H_A: \pi_{2nd} &gt; \pi_{1st}\)</span></p>
<p>Using the global temperature data, here is the test using <span class="math inline">\(\alpha = .05\)</span>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/binom.test">binom.test</a></span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.5</span>, <span class="dt">alternative =</span> <span class="st">"greater"</span>, <span class="dt">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="co">#&gt; </span></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="co">#&gt;  Exact binomial test</span></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="co">#&gt; </span></span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="co">#&gt; data:  10 and 10</span></span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="co">#&gt; number of successes = 10, number of trials = 10, p-value =</span></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="co">#&gt; 0.0009766</span></span>
<span id="cb36-8"><a href="#cb36-8"></a><span class="co">#&gt; alternative hypothesis: true probability of success is greater than 0.5</span></span>
<span id="cb36-9"><a href="#cb36-9"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb36-10"><a href="#cb36-10"></a><span class="co">#&gt;  0.7411344 1.0000000</span></span>
<span id="cb36-11"><a href="#cb36-11"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb36-12"><a href="#cb36-12"></a><span class="co">#&gt; probability of success </span></span>
<span id="cb36-13"><a href="#cb36-13"></a><span class="co">#&gt;                      1</span></span></code></pre></div>
<p>There is strong evidence of a global warming trend.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Michael Seaman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
