<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Sign Test • nplearn</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The Sign Test">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nplearn</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9006</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Bernoulli-Events.html">Bernoulli Events</a>
    </li>
    <li>
      <a href="../articles/binomdist.html">The Binomial Distribution</a>
    </li>
    <li>
      <a href="../articles/lsprop.html">Large-Sample Proportion Inference</a>
    </li>
    <li>
      <a href="../articles/OnePropExact.html">Exact Inference for a Single Proportion</a>
    </li>
    <li>
      <a href="../articles/signtest.html">The Sign Test</a>
    </li>
    <li>
      <a href="../articles/Workflow-Sample.html">Workflow Sample</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>The Sign Test</h1>
            
      
      
      <div class="hidden name"><code>signtest.Rmd</code></div>

    </div>

    
    
<p>The sign test is a special case of the binomial test. In this vignette you will learn why it is an important special case. You will also learn about various situations in which this simple test can provide an opportunity for inference.</p>
<div id="required-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#required-packages" class="anchor"></a>Required packages</h3>
<p>The only package needed for this vignette is the nplearn package.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(nplearn)</span></code></pre></div>
</div>
<div id="the-matched-pairs-design" class="section level3">
<h3 class="hasAnchor">
<a href="#the-matched-pairs-design" class="anchor"></a>The matched pairs design</h3>
<p>We now consider a research design in which units are paired on the basis of one or more extraneous variables so that when a response is measured for every unit in the study, the measures obtained from one member of each pair are correlated with those obtained from the other member of each pair. Units can be paired naturally or via an experimental process. Examples of natural pairing include twins, siblings, bushels of fruit collected from the same tree, weather metrics recorded on the same day, and puppies from the same litter. Pairing via an experimental process requires observation of an extraneous variable known to be related to the response variable of interest. In this case, the stronger the relationship of the extraneous and response variable, the stronger the pair and, consequently, the more power the study will have for detecting treatment effects. One example is the pairing of students on the basis of achievement test results when the study will involve a method designed to increase achievement. Another example is pairing patients on a measure of disease progression when the study will be about a treatment designed to eradicate the disease or alleviate the symptoms.</p>
<p>The value of the matched pairs design is that it can substantially reduce the variation in a response measure that is due to one or more extraneous variables. This reduction of <i>noise</i> (i.e., variation in observations that is not due to the independent, or explanatory, variable) can make it substantially easier to detect the <i>signal</i> (i.e., the effect of an indpendent or explanatory variable). A practical implication is that the design is more efficient. That is, fewer units will be needed to detect the treatment effect than would be needed using two independent samples to attempt to detect the same size effect. The obvious disadvantage of the design is that it requires either finding naturally matched units or creating such matches. To create a match will necessitate the use of an existing measure of an extraneous variable or making new measurements prior to the implementation of the matched pairs design.</p>
<p>In an observational study of natural pairs, the members of each pair are in different categories of the explanatory variable. For example, a 1966 study of 27 pairs of monozygotic twins looked at differences in scores on a test of intelligence for each twin pair. These pairs were chosen because the twins had been separated at birth, with one of the twins raised by the biological parents and the other raised in a foster home. In this case, the explanatory variable is the type of home in which the twin was raised, so it was necessary to select twin pairs that reflected this difference.</p>
<p>A more common approach is to experimentally create the explanatory variable, making certain that one member of each pair is placed in one category of the variable, such as a control condition, traditional intervention, or placebo condition, and the other member of each pair is placed in the other cateogry, such as a treatment condition. As I will discuss in more detail later, the conclusions of such a study are strengthened if the choice of which pair member is in which condition is based on random assignment.</p>
</div>
<div id="the-sign-test" class="section level3">
<h3 class="hasAnchor">
<a href="#the-sign-test" class="anchor"></a>The sign test</h3>
<p>Consider a study of two fertilizer options for fruit trees. Suppose that two trees were planted on each of six plots of land. Plots might be defined not only in terms of location, but soil characteristics (e.g., pH and granular form), sun exposure, wind exposure, and so forth. Thus, the two trees on each plot can be considered a pair due to their similarity on a variety of extraneous variables that are related to the variable of interest: fruit production. Further suppose that each tree received a treatment of fertilizer at regular intervals, but the trees in each pair received different types of fertilizer. (Although the trees are paired by their planting on the same plot, they would need to be planted far enough apart to avoid any crossover effect from the fertilizers.) To strengthen the validity of conclusions about the different fertilizers, the researcher randomly selected the member of each pair that would receive Fertilizer A, then applied Fertilizer B to the other member of the pair.</p>
<p>At some point, ripe fruit was picked off of all trees. Shown below are the results of this hypothetical study when entered into R. The observations are the number of pieces of ripe fruit.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>fruit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">A =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">82</span>, <span class="dv">91</span>, <span class="dv">74</span>, <span class="dv">90</span>, <span class="dv">66</span>, <span class="dv">81</span>),</span>
<span id="cb2-2"><a href="#cb2-2"></a>                    <span class="dt">B =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">85</span>, <span class="dv">89</span>, <span class="dv">81</span>, <span class="dv">96</span>, <span class="dv">65</span>, <span class="dv">93</span>))</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(fruit<span class="op">$</span>A, fruit<span class="op">$</span>B)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt; [1,]   82   85</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt; [2,]   91   89</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; [3,]   74   81</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt; [4,]   90   96</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#&gt; [5,]   66   65</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt; [6,]   81   93</span></span></code></pre></div>
<p>The relative effectiveness of fertilizers can be measured by looking at the difference in fruit production within each tree pair. We will subtract the fruit quantity produced with the help of one type of fertilizer from the quantity produced with the help of the other type. It does not matter which way we subtract, but it does matter that we keep track of which way we subtract so as to make legitimate statements about fertilizer effectiveness.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>A.minus.B &lt;-<span class="st"> </span>fruit<span class="op">$</span>A <span class="op">-</span><span class="st"> </span>fruit<span class="op">$</span>B</span>
<span id="cb3-2"><a href="#cb3-2"></a>A.minus.B</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt; [1]  -3   2  -7  -6   1 -12</span></span></code></pre></div>
<p>Notice that for each pair of trees we can derive two pieces of information: which fertilizer produced the highest yield and how much difference there is in yield. The first piece of information is provided by the sign of the number and the second by the quantity of the number. The <i>sign test</i> focuses, as you might guess, on the sign of the number. That is, the focus is on which fertilizer produced the highest yield in each tree pair. Given that our order of subtraction is A minus B, a positive number suggests a win for A.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>A.minus.B <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#&gt; [1] FALSE  TRUE FALSE FALSE  TRUE FALSE</span></span></code></pre></div>
<p>There are two plus signs and four minus signs in these data. The trees with Fertilizer B outperformed the trees with Fertilizer A most of the time (a two to one win). Given that one tree was likely to outperform the other, can we attribute this outcome to the superior performance of Fertilizer B? Perhaps, yet it is possible that there are other extraneous variables at work. Maybe the seeds themselves made the difference. Maybe more trees with Fertilizer B received more water than trees with Fertilizer A. There are likely many extraneous variables that we have not even considered. This is why it was so important to randomly assign Fertilizers to one member of each tree pair. If that was done in this study, and if the type of fertilizer is really not responsible for the difference in yield, then the numbers of positive and negative signs in our data are simply the result of chance. Under the hypothesis of no difference in fertilizer effectiveness, the number of A trees that outperformed B trees (and vice versa) is simply due to chance assignment.</p>
<p>If chance assignment is the reason for differences in the numbers of signs, we can calculate the probability that Fertilizer A trees will result in just two positive signs. This is a binomial problem with six Bernoulli events and the probability of a Fertilizer A tree receiving a positive sign is 0.5. This is the same as the probability of obtaining “heads up” with the flip of a fair coin, and indeed that may be exactly how the researcher decided which tree would receive which fertilizer!</p>
<p>Here are the parameters of the binomial distribution.</p>
<p><span class="math inline">\(n = 6\)</span> <span class="math inline">\(\pi = 0.5\)</span></p>
<p>Here’s the picture of the probability distribution.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="../reference/binom_plot.html">binom_plot</a></span>(<span class="dv">6</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="signtest_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>With a little thought, you may recognize that the picture we are looking at here is under some sort of null hypothesis stating that neither fertilizer is more effective than the other. The picture shows the probability of every possible number of positive signs for our difference scores when the sign of the difference is due to chance assignment of fertilizers to trees, but nothing else. It is basically the same distribution we would get if we didn’t use fertilizer at all! In this case, a positive sign would be due to other non-fertilizer-related characteristics of the trees and placement of the trees. We could right a null hypothesis that looks something like this.</p>
<p><span class="math inline">\(H_0: Fertilizer doesn't make a difference\)</span></p>
<p>That’s a fine research null hypothesis, but how can we make it a statistical null hypothesis? The key is to think again about our difference scores. Is there any value of any statistic (and associated parameter) that will reflect an equal number of positive and negative difference scores? You probably have guessed that the answer is “yes.” Consider this null hypothesis.</p>
<p><span class="math inline">\(H_0: \theta = 0\)</span></p>
<p>We use <span class="math inline">\(\theta\)</span> to represent the population median. If the chance of a difference score being positive is the same as the chance of a difference score being negative (that is, the probability of each if 50%), then the median of the difference scores is 0. For our fertilizer research, we can write the null and alternative hypotheses like this.</p>
<p><span class="math inline">\(H_0: \theta = 0\)</span> <span class="math inline">\(H_1: \theta \ne 0\)</span></p>
<p>I am using a two-sided alternative here because we went into this study with no information that one fertilizer should be better than the other. The situation would have been different if, for example, we were told that Fertilizer B was developed based on new understanding of the properties of fertilizers so that the research is to confirm that Fertilizer B results in higher production than Fertilizer A.</p>
<p>Let’s set <span class="math inline">\(\alpha\)</span>, our maximum allowable Type I error rate, at 10%. Under the null hypothesis, here is the probability of obtaining only two plus signs for Fertilizer A.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="fl">0.5</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#&gt; [1] 0.34375</span></span></code></pre></div>
<p>For a two-sided test, we need to also include upper tail values that are equally incompatible with the null hypothesis. That is, we need to include the probability of four or more plus signs among our difference scores. (Notice that four plus signs would be the same as two negative signs for Fertilizer B.)</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">4-1</span>, <span class="dv">6</span>, <span class="fl">0.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">#&gt; [1] 0.6875</span></span></code></pre></div>
<p>A <em>p</em> value of 0.6875 will certainly not persuade us to view this as an unlikely outcome if the null hypothesis is true, so we must retain a median of 0 as a reasonable possibility for the value of the parameter. Yet we remember that the number of trees with Fertilizer B that outperformed their matched pair tree (not to be confused with a pear tree, which is reserved for partridges) was four out of the six, or 0.67. What gives?</p>
<p>We didn’t have much power for this test because we only used six matched pairs. Let’s see what would happen if we kept the 2 to 1 ratio the same, but used 30 matched pairs. (This would require us to plant 60 trees.) Here’s the picture under the null hypothesis.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw"><a href="../reference/binom_plot.html">binom_plot</a></span>(<span class="dv">30</span>, <span class="fl">.5</span>)</span></code></pre></div>
<p><img src="signtest_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>The 2 to 1 ratio would mean that we have 10 plus signs for Fertilizer A and 20 negative signs. Here’s the <em>p</em> value for the two-sided test.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">10</span>, <span class="dv">30</span>, <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">20</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">30</span>, <span class="fl">0.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">#&gt; [1] 0.09873715</span></span></code></pre></div>
<p>This is better! We have some convincing evidence that Fertilizer B outperforms Fertilizer A. Unlike with some hypotheses you may test with the binomial test, the sign test is always based on a null hypothesis of equal probability (0.5) of plus and minus signs, so the binomial distribution when the null hypothesis is true is symmetrical. Thus, for two-tailed tests it will work to double the probability in one tail when you are calculating the <em>p</em> value.</p>
</div>
<div id="a-confidence-interval-for-the-median" class="section level3">
<h3 class="hasAnchor">
<a href="#a-confidence-interval-for-the-median" class="anchor"></a>A confidence interval for the median</h3>
<p>Suppose in our fruit tree study that we have reason to believe that the median of difference scores is 1. (I have no idea why we might have a reason to believe this, but stick with me. I’ll put this irrational suspicion to rational use in a moment.) In practical terms, this would mean that the median increase in fruit production is one piece of fruit if Fertilizer B is used instead of Fertilizer A. Similarly, we could propose a median of -1, which would again mean an increase in fruit production, but this time if Fertilizer A is used instead of Fertilizer B.</p>
<p>By definition, the median has 50% of scores above it and 50% of scores beneath it. Therefore, we can test the hypothesis that the median is 1 using the sign test, because the sign test uses a null hypothesis that 50% of the signs are plus signs and 50% of the signs are minus signs. The only difference between this hypothesis test and the hypothesis of no difference in fruit production is that in the earlier hypothesis test, no difference in fruit production corresponded to a median of 0. Thus, we were able to look at the actual sign of each difference. For testing that the median is 1, we need to count any value above 1 as a “plus sign” and any value below 1 as a “minus sign”. This is a bit bizarre, because now we will think of 0 as having a minus sign.</p>
<p>Here are the differences we calculated earlier.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>A.minus.B</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">#&gt; [1]  -3   2  -7  -6   1 -12</span></span></code></pre></div>
<p>If the median value in the population is 1, then we have 1 value above this median and 4 values below this median. We also have a single value that falls right on the median. How are we going to handle this? One possibility is to just use the 5 values that are either above or below the median, and indeed that is what some statisticians recommend for this situation. This approach is a bit peculiar, because it means that you are throwing out the one data point that is totally consistent with the null hypothesis that the median is 1. Talk about stacking the deck in favor of the alternative hypothesis!</p>
<p>Let’s calculate the <em>p</em> value two ways. First, we’ll calculate it as if the value of 1 is above the median. Next, we’ll calculate it as if the value of 1 is below the median. Here’s the first way. Remember that we now have two plus signs (“above” 1) and four negative signs (below 1).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">4-1</span>, <span class="dv">6</span>, <span class="fl">0.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">#&gt; [1] 0.6875</span></span></code></pre></div>
<p>That should look familiar. It is the same <em>p</em> value we obtained when testing if the median is equal to 0. That’s no surprise because by counting 1 as “above” the median (even though it is right on the median), we are ending up with the same number of plus and minus signs as before. What happens if we count the 1 as being “below” the median?</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">5-1</span>, <span class="dv">6</span>, <span class="fl">0.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co">#&gt; [1] 0.21875</span></span></code></pre></div>
<p>That dramatically changed the picture! Neither of these <em>p</em> values will lead us to reject the null hypothesis of a population median of 1, based on our established tolerance for error of 10%, but this second <em>p</em> value gets us much closer to our rejection line. Which of these should we use? Given our distaste for Type I errors and knowing that the value in question is as strongly in support of the null hypothesis as possible (the value is 1 and our hypothesized median is also 1), I recommend that we take the first <em>p</em> value to take us further away from rejecting the null hypothesis and more likely to retain it.</p>
<p>If you remember the rule about confidence interval construction, you have probably guessed where this is all going. Let’s review the steps, adding this new rule that we just discussed.</p>
<ol style="list-style-type: decimal">
<li><p>Determine our confidence level. This will correspond to our tolerance for errors in that our confidence level will be <span class="math inline">\((1 - \alpha)*100\%\)</span>, where <span class="math inline">\(\alpha\)</span> is the maximum Type I error rate that we can tolerate.</p></li>
<li><p>Hypothesize a median, <span class="math inline">\(\theta\)</span>.</p></li>
<li><p>Count how many of the matched pair differences are below the median (call these <em>minus signs</em>) and how many of these differences are above the median (call these <em>plus signs</em>). For a difference that is equal to the hypothesized median, call it either a minus sign or a plus sign, depending on which will make it more difficult to reject the null hypothesis.</p></li>
<li><p>Reject hypotheses in which <span class="math inline">\(p \le \alpha\)</span>. Otherwise, retain the hypothesis.</p></li>
<li><p>Test all possible hypotheses. Symbolically, we can state it like this.</p></li>
</ol>
<p><span class="math inline">\(H_0: \theta = \theta_0\)</span> <span class="math inline">\(H_1: \theta \ne \theta_0\)</span></p>
<p><span class="math inline">\(-\infty &lt; \theta_0 &lt; +\infty\)</span></p>
<ol start="6" style="list-style-type: decimal">
<li>The confidence set consists of all values of <span class="math inline">\(theta_0\)</span> that are retained.</li>
</ol>
<p>If we are interested in whether a median is only above or only below 0 (as we would have been if Fertilizer B was developed to be an improvement on Fertilizer A), then we would test one-sided hypotheses. Aside from this, the construction of a lower-bounded or upper-bounded interval is the same.</p>
<p>In practice, we will not test every possible <span class="math inline">\(theta_0\)</span> because we have other more interesting activities to pursue in life. Instead, we will search for the boundary between rejection and retention. For the above data, let’s test a median of 10. That gives us 1 plus sign and 5 minus signs.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">5-1</span>, <span class="dv">6</span>, <span class="fl">.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">#&gt; [1] 0.21875</span></span></code></pre></div>
<p>Let’s try these hypotheses.</p>
<p><span class="math inline">\(H_0: \theta = 3\)</span> <span class="math inline">\(H_1: \theta \ne 3\)</span></p>
<p>We now have 0 plus signs and 6 negative signs.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">6-1</span>, <span class="dv">6</span>, <span class="fl">.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co">#&gt; [1] 0.03125</span></span></code></pre></div>
<p>We finally have a rejected null hypothesis. We will obtain similar results if we use these hypotheses.</p>
<p>$H_0: = <span class="math inline">\(-13\)</span> $H_1: <span class="math inline">\(-13\)</span></p>
<p>Now we have 6 plus signs and 0 negative signs.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">6-1</span>, <span class="dv">6</span>, <span class="fl">.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="fl">.5</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co">#&gt; [1] 0.03125</span></span></code></pre></div>
<p>You probably noticed that this is the same calculation as the previous one, but with the addends swapped. We have determined that every hypothesized value that yields between 1 and 5 plus (or minus) signs will result in retention. Thus, we are able to define our 90% confidence interval.</p>
<p><span class="math inline">\(-13 &lt; \theta &lt; 3\)</span></p>
<p>There are a few elements of this interval construction that are noteworthy. First, we would have obtained the same rejection results if we had hypothesized -14 instead of -13 and 4 instead of 3. Yet we desire the narrowest interval we can obtain, so because -13 and 3 are also rejected, those are the values we will use for our endpoints.</p>
<p>The other comment is a bit more disconcerting. Our testing has wandered outside of the range of our data in order to obtain a 90% confidence interval. That feels a bit like extrapolating beyond the data, so I’m not totally comfortable. That said, it is the best we can do with such a small sample size.</p>
<p>Previously, I provided an example of hypothesis testing with a larger sample size, so it seems in order to do the same for a confidence interval example. The difference here is that we need differences. (Pun only partially intended.) If we want to construct a confidence interval for the median, we need to know more than how many times Fertilizer B beat Fertilizer A. We need to know the extent of this beating by comparing fruit yields.</p>
<p>Here is a (hypothetical) construction of yield differences where again I subtracted the yield for B from the yield of the matched pair tree.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>A.minus.B &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">-1</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">25</span>, <span class="dv">15</span>, <span class="dv">5</span>, <span class="dv">125</span>, <span class="dv">61</span>, <span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">-2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">12</span>,</span>
<span id="cb16-2"><a href="#cb16-2"></a>               <span class="dv">23</span>, <span class="dv">1</span>, <span class="dv">86</span>, <span class="dv">17</span>, <span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">-1</span>, <span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">-2</span>, <span class="dv">58</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">18</span>, <span class="dv">1</span>, <span class="dv">40</span>, <span class="dv">-1</span>,</span>
<span id="cb16-3"><a href="#cb16-3"></a>               <span class="dv">2</span>, <span class="dv">12</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">-2</span>, <span class="dv">1</span>, <span class="dv">56</span>, <span class="dv">5</span>, <span class="dv">-2</span>, <span class="dv">8</span>, <span class="dv">-2</span>, <span class="dv">-1</span>, <span class="dv">30</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">52</span>,</span>
<span id="cb16-4"><a href="#cb16-4"></a>               <span class="dv">3</span>, <span class="dv">-1</span>, <span class="dv">52</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">9</span>, <span class="dv">145</span>, <span class="dv">17</span>)</span>
<span id="cb16-5"><a href="#cb16-5"></a></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(A.minus.B)</span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">#&gt; [1] 60</span></span></code></pre></div>
<p>Let’s determine how many plus signs are in these data.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(A.minus.B <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">#&gt; [1] 45</span></span></code></pre></div>
<p>That means there must be 15 values that are either minus signs or 0. (I’m going to leave 0 in with the minus signs to reduce the chance of rejecting the null hypothesis.)</p>
<p>Here’s the <em>p</em> value.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">15</span>, <span class="dv">60</span>, <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">pbinom</a></span>(<span class="dv">45-1</span>, <span class="dv">60</span>, <span class="fl">.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co">#&gt; [1] 0.0001345141</span></span></code></pre></div>
<p>I’m quite confident that the fertilizers are <strong>not</strong> equally effective!</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Michael Seaman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
