<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Two Sample Procedures • nplearn</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Two Sample Procedures">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nplearn</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9018</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Bernoulli-Events.html">Bernoulli Events</a>
    </li>
    <li>
      <a href="../articles/binomdist.html">The Binomial Distribution</a>
    </li>
    <li>
      <a href="../articles/FisherIrwin.html">The Fisher-Irwin Test</a>
    </li>
    <li>
      <a href="../articles/gof.html">Goodness of Fit</a>
    </li>
    <li>
      <a href="../articles/lsprop.html">Large-Sample Proportion Inference</a>
    </li>
    <li>
      <a href="../articles/OnePropExact.html">Exact Inference for a Single Proportion</a>
    </li>
    <li>
      <a href="../articles/ProdBinom.html">The Product Binomial</a>
    </li>
    <li>
      <a href="../articles/randomization.html">Randomization Tests</a>
    </li>
    <li>
      <a href="../articles/releffic.html">Relative Efficiency</a>
    </li>
    <li>
      <a href="../articles/ReplaceScores.html">Replacement Scores</a>
    </li>
    <li>
      <a href="../articles/signtest.html">The Sign Test</a>
    </li>
    <li>
      <a href="../articles/twosamp.html">Two Sample Procedures</a>
    </li>
    <li>
      <a href="../articles/Workflow-Sample.html">Workflow Sample</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Two Sample Procedures</h1>
            
      
      
      <div class="hidden name"><code>twosamp.Rmd</code></div>

    </div>

    
    
<p>Two-sample procedures are the basis for much research in the social and behavioral sciences. Indeed, the classic experimental setup is to establish control and treatment conditions, then randomize study participants to those conditions. The control condition is often a placebo or “traditional” intervention, and the experimental condition is a new intervention that was developed to achieve improvement, as measured by the outcome or response variable. This experimental arrangement will often lead to directional research hypotheses (e.g., those in the experimental condition will outperform those in the control condition), though two sample procedures can be used for non-directional hypotheses as well. They can also be used for observational studies for which the question of interest is whether there is a difference in a measure of units in two existing conditions (non-directional) or whether units in one condition are higher (or lower) on a measure than units in the other condition (directional).</p>
<div id="required-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#required-packages" class="anchor"></a>Required packages</h3>
<p>The only package required for this vignette is nplearn.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(nplearn)</span></code></pre></div>
</div>
<div id="the-fisher-pitman-procedure" class="section level3">
<h3 class="hasAnchor">
<a href="#the-fisher-pitman-procedure" class="anchor"></a>The Fisher-Pitman procedure</h3>
<p>As with the one-sample situation, we can use the expected outcomes under both randomization and a null hypothesis of no effect (or no difference) as motivation for a procedure to test the null hypothesis. Here is an example that we will use to build such a procedure.</p>
<blockquote>
<p>Some reading experts promote Some reading experts promote direct instruction of prosodic elements (e.g., pauses, voice fluctuation) as a way to increase reading accuracy. One reading researcher conducted an experiment to compare training with repeated reading to direct prosodic instruction. The response variable was the number of errors made when reading an unfamiliar passage.</p>
</blockquote>
<p>Here are the scores obtained in the study. Scores are the numbers of errors made by each study participant.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>prosodic &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>, <span class="dv">13</span>, <span class="dv">11</span>, <span class="dv">15</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>repeated &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">17</span>, <span class="dv">14</span>, <span class="dv">20</span>, <span class="dv">18</span>, <span class="dv">28</span>)</span></code></pre></div>
<p>The research hypothesis is that students in the prosodic reading condition will make fewer errors than those in the repeated reading condition. If we assume that the effect is uniform across the range of readers, this means that the effect of prosodic reading will be to “shift” the distribution of reading errors in a downward direction. We can measure this shift by comparing the medians or means. This leads to either of the following hypotheses.</p>
<p><span class="math inline">\(H_0: \theta_p = \theta_r\)</span></p>
<p><span class="math inline">\(H_a: \theta_p &lt; \theta_r\)</span></p>
<p>Alternatively, focusing on the mean rather than the median, we have these.</p>
<p><span class="math inline">\(H_0: \mu_p = \mu_r\)</span></p>
<p><span class="math inline">\(H_a: \mu_p &lt; \mu_r\)</span></p>
<p>If the null hypothesis is true, the only reason that the particular set of scores that we observe in the prosodic instruction condition (2, 13, 11, and 15) are in that condition is because of which individuals were assigned to that condition. The score of 13, for example, is only in the prosodic instruction condition because the person who had 13 errors happened to be assigned to that condition. If that person had been assigned to the repeated reading condition, we would have observed the score of 13 in that condition. If the null hypothesis is not true, this is not the case. If prosodic reading has the effect of lowering the number of reading errors, the score of 13 may be in the prosodic reading condition because that reader made fewer errors than if he or she had not had prosodic reading instruction.</p>
<p>Consider a total sample size of <span class="math inline">\(n\)</span>, with <span class="math inline">\(n_p\)</span> readers in the prosodic condition and <span class="math inline">\(n_r\)</span> readers in the repeated reading condition, so that the total sample size is the sum of the sample size in each condition.</p>
<p><span class="math inline">\(n = n_p + n_r\)</span></p>
<p>Under a true null hypothesis, each of the <span class="math inline">\(n\)</span> choose <span class="math inline">\(n_p\)</span> combinations of groupings that we can create from these <span class="math inline">\(n\)</span> scores are equally likely. If the alternative hypothesis is true, we expect the smaller scores in the prosodic instruction condition. A simple statistic that we can use to measure the effectiveness of prosodic instruction is the sum of the scores in that condition. Note that if the null hypothesis is true, the set of scores in this experiment will be what we observe, and the sum of these scores will be a constant, regardless of who is assigned to each condition. Thus, observing a sum in the prosodic condition that is at or near the smallest that can be observed for that condition would have a low probability under the null hypothesis and a higher probability under the alternative hypothesis. This would provide evidence that the null hypothesis may not be true.</p>
<p>We can create the distribution of our test statistic (the sum of scores in the prosodic condition), under a true null hypothesis, by creating all possible combinations of our scores for sample sizes <span class="math inline">\(n_p\)</span> and <span class="math inline">\(n_r\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>scores &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(prosodic, repeated)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw"><a href="../reference/exact_twosamp_dist.html">exact_twosamp_dist</a></span>(scores, <span class="dv">4</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt;        T.val        prob     prob.up   prob.down</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#&gt;   [1,]    40 0.007936508 0.007936508 1.000000000</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#&gt;   [2,]    41 0.007936508 0.015873016 0.992063492</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#&gt;   [3,]    42 0.007936508 0.023809524 0.984126984</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt;   [4,]    43 0.007936508 0.031746032 0.976190476</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#&gt;   [5,]    44 0.007936508 0.039682540 0.968253968</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">#&gt;   [6,]    44 0.007936508 0.047619048 0.960317460</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">#&gt;   [7,]    44 0.007936508 0.055555556 0.952380952</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">#&gt;   [8,]    45 0.007936508 0.063492063 0.944444444</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">#&gt;   [9,]    45 0.007936508 0.071428571 0.936507937</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">#&gt;  [10,]    46 0.007936508 0.079365079 0.928571429</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">#&gt;  [11,]    46 0.007936508 0.087301587 0.920634921</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">#&gt;  [12,]    46 0.007936508 0.095238095 0.912698413</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">#&gt;  [13,]    47 0.007936508 0.103174603 0.904761905</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="co">#&gt;  [14,]    47 0.007936508 0.111111111 0.896825397</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co">#&gt;  [15,]    47 0.007936508 0.119047619 0.888888889</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co">#&gt;  [16,]    48 0.007936508 0.126984127 0.880952381</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="co">#&gt;  [17,]    48 0.007936508 0.134920635 0.873015873</span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="co">#&gt;  [18,]    48 0.007936508 0.142857143 0.865079365</span></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="co">#&gt;  [19,]    48 0.007936508 0.150793651 0.857142857</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="co">#&gt;  [20,]    49 0.007936508 0.158730159 0.849206349</span></span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="co">#&gt;  [21,]    49 0.007936508 0.166666667 0.841269841</span></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="co">#&gt;  [22,]    50 0.007936508 0.174603175 0.833333333</span></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="co">#&gt;  [23,]    50 0.007936508 0.182539683 0.825396825</span></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="co">#&gt;  [24,]    50 0.007936508 0.190476190 0.817460317</span></span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="co">#&gt;  [25,]    51 0.007936508 0.198412698 0.809523810</span></span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="co">#&gt;  [26,]    51 0.007936508 0.206349206 0.801587302</span></span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="co">#&gt;  [27,]    51 0.007936508 0.214285714 0.793650794</span></span>
<span id="cb3-31"><a href="#cb3-31"></a><span class="co">#&gt;  [28,]    52 0.007936508 0.222222222 0.785714286</span></span>
<span id="cb3-32"><a href="#cb3-32"></a><span class="co">#&gt;  [29,]    52 0.007936508 0.230158730 0.777777778</span></span>
<span id="cb3-33"><a href="#cb3-33"></a><span class="co">#&gt;  [30,]    53 0.007936508 0.238095238 0.769841270</span></span>
<span id="cb3-34"><a href="#cb3-34"></a><span class="co">#&gt;  [31,]    53 0.007936508 0.246031746 0.761904762</span></span>
<span id="cb3-35"><a href="#cb3-35"></a><span class="co">#&gt;  [32,]    53 0.007936508 0.253968254 0.753968254</span></span>
<span id="cb3-36"><a href="#cb3-36"></a><span class="co">#&gt;  [33,]    54 0.007936508 0.261904762 0.746031746</span></span>
<span id="cb3-37"><a href="#cb3-37"></a><span class="co">#&gt;  [34,]    54 0.007936508 0.269841270 0.738095238</span></span>
<span id="cb3-38"><a href="#cb3-38"></a><span class="co">#&gt;  [35,]    54 0.007936508 0.277777778 0.730158730</span></span>
<span id="cb3-39"><a href="#cb3-39"></a><span class="co">#&gt;  [36,]    55 0.007936508 0.285714286 0.722222222</span></span>
<span id="cb3-40"><a href="#cb3-40"></a><span class="co">#&gt;  [37,]    55 0.007936508 0.293650794 0.714285714</span></span>
<span id="cb3-41"><a href="#cb3-41"></a><span class="co">#&gt;  [38,]    55 0.007936508 0.301587302 0.706349206</span></span>
<span id="cb3-42"><a href="#cb3-42"></a><span class="co">#&gt;  [39,]    56 0.007936508 0.309523810 0.698412698</span></span>
<span id="cb3-43"><a href="#cb3-43"></a><span class="co">#&gt;  [40,]    56 0.007936508 0.317460317 0.690476190</span></span>
<span id="cb3-44"><a href="#cb3-44"></a><span class="co">#&gt;  [41,]    56 0.007936508 0.325396825 0.682539683</span></span>
<span id="cb3-45"><a href="#cb3-45"></a><span class="co">#&gt;  [42,]    57 0.007936508 0.333333333 0.674603175</span></span>
<span id="cb3-46"><a href="#cb3-46"></a><span class="co">#&gt;  [43,]    57 0.007936508 0.341269841 0.666666667</span></span>
<span id="cb3-47"><a href="#cb3-47"></a><span class="co">#&gt;  [44,]    57 0.007936508 0.349206349 0.658730159</span></span>
<span id="cb3-48"><a href="#cb3-48"></a><span class="co">#&gt;  [45,]    57 0.007936508 0.357142857 0.650793651</span></span>
<span id="cb3-49"><a href="#cb3-49"></a><span class="co">#&gt;  [46,]    58 0.007936508 0.365079365 0.642857143</span></span>
<span id="cb3-50"><a href="#cb3-50"></a><span class="co">#&gt;  [47,]    58 0.007936508 0.373015873 0.634920635</span></span>
<span id="cb3-51"><a href="#cb3-51"></a><span class="co">#&gt;  [48,]    58 0.007936508 0.380952381 0.626984127</span></span>
<span id="cb3-52"><a href="#cb3-52"></a><span class="co">#&gt;  [49,]    58 0.007936508 0.388888889 0.619047619</span></span>
<span id="cb3-53"><a href="#cb3-53"></a><span class="co">#&gt;  [50,]    59 0.007936508 0.396825397 0.611111111</span></span>
<span id="cb3-54"><a href="#cb3-54"></a><span class="co">#&gt;  [51,]    59 0.007936508 0.404761905 0.603174603</span></span>
<span id="cb3-55"><a href="#cb3-55"></a><span class="co">#&gt;  [52,]    59 0.007936508 0.412698413 0.595238095</span></span>
<span id="cb3-56"><a href="#cb3-56"></a><span class="co">#&gt;  [53,]    59 0.007936508 0.420634921 0.587301587</span></span>
<span id="cb3-57"><a href="#cb3-57"></a><span class="co">#&gt;  [54,]    59 0.007936508 0.428571429 0.579365079</span></span>
<span id="cb3-58"><a href="#cb3-58"></a><span class="co">#&gt;  [55,]    60 0.007936508 0.436507937 0.571428571</span></span>
<span id="cb3-59"><a href="#cb3-59"></a><span class="co">#&gt;  [56,]    60 0.007936508 0.444444444 0.563492063</span></span>
<span id="cb3-60"><a href="#cb3-60"></a><span class="co">#&gt;  [57,]    60 0.007936508 0.452380952 0.555555556</span></span>
<span id="cb3-61"><a href="#cb3-61"></a><span class="co">#&gt;  [58,]    60 0.007936508 0.460317460 0.547619048</span></span>
<span id="cb3-62"><a href="#cb3-62"></a><span class="co">#&gt;  [59,]    61 0.007936508 0.468253968 0.539682540</span></span>
<span id="cb3-63"><a href="#cb3-63"></a><span class="co">#&gt;  [60,]    61 0.007936508 0.476190476 0.531746032</span></span>
<span id="cb3-64"><a href="#cb3-64"></a><span class="co">#&gt;  [61,]    61 0.007936508 0.484126984 0.523809524</span></span>
<span id="cb3-65"><a href="#cb3-65"></a><span class="co">#&gt;  [62,]    61 0.007936508 0.492063492 0.515873016</span></span>
<span id="cb3-66"><a href="#cb3-66"></a><span class="co">#&gt;  [63,]    61 0.007936508 0.500000000 0.507936508</span></span>
<span id="cb3-67"><a href="#cb3-67"></a><span class="co">#&gt;  [64,]    62 0.007936508 0.507936508 0.500000000</span></span>
<span id="cb3-68"><a href="#cb3-68"></a><span class="co">#&gt;  [65,]    62 0.007936508 0.515873016 0.492063492</span></span>
<span id="cb3-69"><a href="#cb3-69"></a><span class="co">#&gt;  [66,]    62 0.007936508 0.523809524 0.484126984</span></span>
<span id="cb3-70"><a href="#cb3-70"></a><span class="co">#&gt;  [67,]    62 0.007936508 0.531746032 0.476190476</span></span>
<span id="cb3-71"><a href="#cb3-71"></a><span class="co">#&gt;  [68,]    62 0.007936508 0.539682540 0.468253968</span></span>
<span id="cb3-72"><a href="#cb3-72"></a><span class="co">#&gt;  [69,]    62 0.007936508 0.547619048 0.460317460</span></span>
<span id="cb3-73"><a href="#cb3-73"></a><span class="co">#&gt;  [70,]    63 0.007936508 0.555555556 0.452380952</span></span>
<span id="cb3-74"><a href="#cb3-74"></a><span class="co">#&gt;  [71,]    63 0.007936508 0.563492063 0.444444444</span></span>
<span id="cb3-75"><a href="#cb3-75"></a><span class="co">#&gt;  [72,]    63 0.007936508 0.571428571 0.436507937</span></span>
<span id="cb3-76"><a href="#cb3-76"></a><span class="co">#&gt;  [73,]    63 0.007936508 0.579365079 0.428571429</span></span>
<span id="cb3-77"><a href="#cb3-77"></a><span class="co">#&gt;  [74,]    63 0.007936508 0.587301587 0.420634921</span></span>
<span id="cb3-78"><a href="#cb3-78"></a><span class="co">#&gt;  [75,]    64 0.007936508 0.595238095 0.412698413</span></span>
<span id="cb3-79"><a href="#cb3-79"></a><span class="co">#&gt;  [76,]    64 0.007936508 0.603174603 0.404761905</span></span>
<span id="cb3-80"><a href="#cb3-80"></a><span class="co">#&gt;  [77,]    64 0.007936508 0.611111111 0.396825397</span></span>
<span id="cb3-81"><a href="#cb3-81"></a><span class="co">#&gt;  [78,]    64 0.007936508 0.619047619 0.388888889</span></span>
<span id="cb3-82"><a href="#cb3-82"></a><span class="co">#&gt;  [79,]    65 0.007936508 0.626984127 0.380952381</span></span>
<span id="cb3-83"><a href="#cb3-83"></a><span class="co">#&gt;  [80,]    65 0.007936508 0.634920635 0.373015873</span></span>
<span id="cb3-84"><a href="#cb3-84"></a><span class="co">#&gt;  [81,]    65 0.007936508 0.642857143 0.365079365</span></span>
<span id="cb3-85"><a href="#cb3-85"></a><span class="co">#&gt;  [82,]    65 0.007936508 0.650793651 0.357142857</span></span>
<span id="cb3-86"><a href="#cb3-86"></a><span class="co">#&gt;  [83,]    66 0.007936508 0.658730159 0.349206349</span></span>
<span id="cb3-87"><a href="#cb3-87"></a><span class="co">#&gt;  [84,]    66 0.007936508 0.666666667 0.341269841</span></span>
<span id="cb3-88"><a href="#cb3-88"></a><span class="co">#&gt;  [85,]    66 0.007936508 0.674603175 0.333333333</span></span>
<span id="cb3-89"><a href="#cb3-89"></a><span class="co">#&gt;  [86,]    66 0.007936508 0.682539683 0.325396825</span></span>
<span id="cb3-90"><a href="#cb3-90"></a><span class="co">#&gt;  [87,]    67 0.007936508 0.690476190 0.317460317</span></span>
<span id="cb3-91"><a href="#cb3-91"></a><span class="co">#&gt;  [88,]    67 0.007936508 0.698412698 0.309523810</span></span>
<span id="cb3-92"><a href="#cb3-92"></a><span class="co">#&gt;  [89,]    67 0.007936508 0.706349206 0.301587302</span></span>
<span id="cb3-93"><a href="#cb3-93"></a><span class="co">#&gt;  [90,]    68 0.007936508 0.714285714 0.293650794</span></span>
<span id="cb3-94"><a href="#cb3-94"></a><span class="co">#&gt;  [91,]    68 0.007936508 0.722222222 0.285714286</span></span>
<span id="cb3-95"><a href="#cb3-95"></a><span class="co">#&gt;  [92,]    68 0.007936508 0.730158730 0.277777778</span></span>
<span id="cb3-96"><a href="#cb3-96"></a><span class="co">#&gt;  [93,]    69 0.007936508 0.738095238 0.269841270</span></span>
<span id="cb3-97"><a href="#cb3-97"></a><span class="co">#&gt;  [94,]    69 0.007936508 0.746031746 0.261904762</span></span>
<span id="cb3-98"><a href="#cb3-98"></a><span class="co">#&gt;  [95,]    70 0.007936508 0.753968254 0.253968254</span></span>
<span id="cb3-99"><a href="#cb3-99"></a><span class="co">#&gt;  [96,]    70 0.007936508 0.761904762 0.246031746</span></span>
<span id="cb3-100"><a href="#cb3-100"></a><span class="co">#&gt;  [97,]    70 0.007936508 0.769841270 0.238095238</span></span>
<span id="cb3-101"><a href="#cb3-101"></a><span class="co">#&gt;  [98,]    70 0.007936508 0.777777778 0.230158730</span></span>
<span id="cb3-102"><a href="#cb3-102"></a><span class="co">#&gt;  [99,]    71 0.007936508 0.785714286 0.222222222</span></span>
<span id="cb3-103"><a href="#cb3-103"></a><span class="co">#&gt; [100,]    71 0.007936508 0.793650794 0.214285714</span></span>
<span id="cb3-104"><a href="#cb3-104"></a><span class="co">#&gt; [101,]    72 0.007936508 0.801587302 0.206349206</span></span>
<span id="cb3-105"><a href="#cb3-105"></a><span class="co">#&gt; [102,]    72 0.007936508 0.809523810 0.198412698</span></span>
<span id="cb3-106"><a href="#cb3-106"></a><span class="co">#&gt; [103,]    72 0.007936508 0.817460317 0.190476190</span></span>
<span id="cb3-107"><a href="#cb3-107"></a><span class="co">#&gt; [104,]    73 0.007936508 0.825396825 0.182539683</span></span>
<span id="cb3-108"><a href="#cb3-108"></a><span class="co">#&gt; [105,]    73 0.007936508 0.833333333 0.174603175</span></span>
<span id="cb3-109"><a href="#cb3-109"></a><span class="co">#&gt; [106,]    73 0.007936508 0.841269841 0.166666667</span></span>
<span id="cb3-110"><a href="#cb3-110"></a><span class="co">#&gt; [107,]    74 0.007936508 0.849206349 0.158730159</span></span>
<span id="cb3-111"><a href="#cb3-111"></a><span class="co">#&gt; [108,]    74 0.007936508 0.857142857 0.150793651</span></span>
<span id="cb3-112"><a href="#cb3-112"></a><span class="co">#&gt; [109,]    74 0.007936508 0.865079365 0.142857143</span></span>
<span id="cb3-113"><a href="#cb3-113"></a><span class="co">#&gt; [110,]    74 0.007936508 0.873015873 0.134920635</span></span>
<span id="cb3-114"><a href="#cb3-114"></a><span class="co">#&gt; [111,]    75 0.007936508 0.880952381 0.126984127</span></span>
<span id="cb3-115"><a href="#cb3-115"></a><span class="co">#&gt; [112,]    75 0.007936508 0.888888889 0.119047619</span></span>
<span id="cb3-116"><a href="#cb3-116"></a><span class="co">#&gt; [113,]    76 0.007936508 0.896825397 0.111111111</span></span>
<span id="cb3-117"><a href="#cb3-117"></a><span class="co">#&gt; [114,]    76 0.007936508 0.904761905 0.103174603</span></span>
<span id="cb3-118"><a href="#cb3-118"></a><span class="co">#&gt; [115,]    76 0.007936508 0.912698413 0.095238095</span></span>
<span id="cb3-119"><a href="#cb3-119"></a><span class="co">#&gt; [116,]    77 0.007936508 0.920634921 0.087301587</span></span>
<span id="cb3-120"><a href="#cb3-120"></a><span class="co">#&gt; [117,]    77 0.007936508 0.928571429 0.079365079</span></span>
<span id="cb3-121"><a href="#cb3-121"></a><span class="co">#&gt; [118,]    77 0.007936508 0.936507937 0.071428571</span></span>
<span id="cb3-122"><a href="#cb3-122"></a><span class="co">#&gt; [119,]    78 0.007936508 0.944444444 0.063492063</span></span>
<span id="cb3-123"><a href="#cb3-123"></a><span class="co">#&gt; [120,]    78 0.007936508 0.952380952 0.055555556</span></span>
<span id="cb3-124"><a href="#cb3-124"></a><span class="co">#&gt; [121,]    79 0.007936508 0.960317460 0.047619048</span></span>
<span id="cb3-125"><a href="#cb3-125"></a><span class="co">#&gt; [122,]    79 0.007936508 0.968253968 0.039682540</span></span>
<span id="cb3-126"><a href="#cb3-126"></a><span class="co">#&gt; [123,]    80 0.007936508 0.976190476 0.031746032</span></span>
<span id="cb3-127"><a href="#cb3-127"></a><span class="co">#&gt; [124,]    80 0.007936508 0.984126984 0.023809524</span></span>
<span id="cb3-128"><a href="#cb3-128"></a><span class="co">#&gt; [125,]    81 0.007936508 0.992063492 0.015873016</span></span>
<span id="cb3-129"><a href="#cb3-129"></a><span class="co">#&gt; [126,]    83 0.007936508 1.000000000 0.007936508</span></span></code></pre></div>
<p>The above function, exact_twosamp_dist, uses the total list of scores as the first argument and the sample size of the first sample as the second argument. Traditionally, in order to keep the test statistic distribution as small as possible, we create the distribution for the sum of scores in the smallest sample. This can be achieved with this function by putting the scores from the smallest sample first in the list of scores.</p>
<p>Here is our observed test statistic.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(prosodic)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#&gt; [1] 41</span></span></code></pre></div>
<p>The probability of observing 41 or smaller, which is just the sum of the probabilities of observing 40 or 41, is 0.016 if the null hypothesis is true. For any tolerance for Type I errors that we have set above this value, we will reject the null hypothesis and conclude that prosodic reading has the effect of decreasing the number of errors.</p>
</div>
<div id="conditions-for-valid-inference" class="section level3">
<h3 class="hasAnchor">
<a href="#conditions-for-valid-inference" class="anchor"></a>Conditions for valid inference</h3>
<p>The Fisher-Pitman randomization test for two samples is a direct competitor to the parametric <em>t</em> test for testing a hypothesis about the mean of two population distributions. As such, it has similar, but weaker, conditions for valid inference.</p>
<p><em>Observations within each sample are independent of one another </em>The two samples are independent of one another *Population distributions have the same shape</p>
<p>The first two of these are identical to the conditions necessary for valid inference about population means when using the <em>t</em> test. The third condition is somewhat different. For the <em>t</em> test, not only do populations need to have the same shape, they must also be normally distributed. This strict condition can be relaxed when we have large sample sizes. Due to the Central Limit Theorem, the sampling distribution of the differences in means will approach that of a normal distribution as the sample size increases. The problem with reliance on this Theorem is that (a) the sample size may need to be prohibitively large in order yield a sampling distirbutin that is close enough to the normal distribution to assure us that we are observing reasonable estimates of our <em>p</em> values, and (b) we may be using a less efficient method of inference than other available methods.</p>
<p>As you read this, it is likely obvious to you that this third condition might be the most difficult of these three conditions to verify, even though it is substantially less restrictive than the normality condition. As I stated above, we can reasonably assume that our two distributions have the same shape when the effect of our treatment is uniform across the range of participant values on the response measure, so as to be responsible for a distribution “shift” in the positive or negative direction. It is this condition that enables us to test hypotheses about either the median or mean, and is also the condition that assures us that the difference in our medians will be the same as the difference in our means. This is why it does not matter which hypothesis we employ. Although a hypothesis about the means demonstrates that the randomization test is a competitor to the <em>t</em> test, it actually makes more sense to create hypotheses about the medians. That is because the population median is a reasonable indicator of distribution center, even when the distribution is skewed. Comparing two identically shaped skewed distributions with different medians can be accomplished with sample medians.</p>
<p>By now you may well be asking an obvious question: What if the effect of the treatment is not uniform? In our example, what if readers at differing levels of reading ability are influenced differently by prosodic instruction? This question can be extended to other examples and other domains. What if a particular drug has differing effects depending on the severity of the condition being treated through drug therapy? What if the magnitude of the positive effect of participation in a peer learning group is, at least in part, a function of the social characteristics of the individuals in the group? These questions all entertain the notion that there may be a moderating influence for the treatment. We can address moderator variables by including them in our study, but this requires both knowledge of the existence of such variables and subsequent measurement, which may be costly or difficult.</p>
<p>There is an available solution to this issue when we use a randomization test rather than relying on a mathematical model for our scores. That is to change the hypothesis of interest. Here are the hypotheses that we could use for our prosodic instruction example.</p>
<p><span class="math inline">\(H_0: P(Y_p &lt; Y_r) = 1/2\)</span></p>
<p><span class="math inline">\(H_a: P(Y_p &lt; Y_r) &gt; 1/2\)</span></p>
<p>The null hypothesis tells us that if we select two scores at random, one from the treatment condition and the other from the control condition, there is a 50% chance that the score in the treatment condition will be less than that in the control condition. By contrast, the alternative hypothesis states that when we make such random draws, there is a greater than 50% chance that the score in the treatment condition will be less than that in the control condition. In research terms, this means that the treatment has the effect of reducing the number of reading errors. That is, in fact, exactly what we are interested in accomplishing. If we use such hypotheses, we only need to assume independence of observations within our conditions and independence of conditions from one another. Such conditions are easy to achieve and verify.</p>
</div>
<div id="using-ranks" class="section level3">
<h3 class="hasAnchor">
<a href="#using-ranks" class="anchor"></a>Using ranks</h3>
<p>Wilcoxon suggested using the Fisher-Pitman randomization method, but doing so with ranks. We know from our experience with a single sample that not only can ranking address measurement issues (e.g., skepticism about the interval nature of scores when related to the underlying construct of interest), but it can also increase power when the tails of the distribution are heavier than what we would expect with a normal distribution. Application of this suggestion is simple: rank across all scores and then apply the method.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>r.scores &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rank">rank</a></span>(scores)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw"><a href="../reference/exact_twosamp_dist.html">exact_twosamp_dist</a></span>(r.scores, <span class="dv">4</span>, <span class="dt">duplicate =</span> <span class="ot">FALSE</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt;       T.unique        prob     prob.up   prob.down</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt;  [1,]       10 0.007936508 0.007936508 1.000000000</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt;  [2,]       11 0.007936508 0.015873016 0.992063492</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt;  [3,]       12 0.015873016 0.031746032 0.984126984</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt;  [4,]       13 0.023809524 0.055555556 0.968253968</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt;  [5,]       14 0.039682540 0.095238095 0.944444444</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt;  [6,]       15 0.047619048 0.142857143 0.904761905</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">#&gt;  [7,]       16 0.063492063 0.206349206 0.857142857</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#&gt;  [8,]       17 0.071428571 0.277777778 0.793650794</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">#&gt;  [9,]       18 0.087301587 0.365079365 0.722222222</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">#&gt; [10,]       19 0.087301587 0.452380952 0.634920635</span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">#&gt; [11,]       20 0.095238095 0.547619048 0.547619048</span></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="co">#&gt; [12,]       21 0.087301587 0.634920635 0.452380952</span></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co">#&gt; [13,]       22 0.087301587 0.722222222 0.365079365</span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co">#&gt; [14,]       23 0.071428571 0.793650794 0.277777778</span></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="co">#&gt; [15,]       24 0.063492063 0.857142857 0.206349206</span></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="co">#&gt; [16,]       25 0.047619048 0.904761905 0.142857143</span></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="co">#&gt; [17,]       26 0.039682540 0.944444444 0.095238095</span></span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="co">#&gt; [18,]       27 0.023809524 0.968253968 0.055555556</span></span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="co">#&gt; [19,]       28 0.015873016 0.984126984 0.031746032</span></span>
<span id="cb5-23"><a href="#cb5-23"></a><span class="co">#&gt; [20,]       29 0.007936508 0.992063492 0.015873016</span></span>
<span id="cb5-24"><a href="#cb5-24"></a><span class="co">#&gt; [21,]       30 0.007936508 1.000000000 0.007936508</span></span></code></pre></div>
<p>The sum of the ranks can range from 10 to 30. Here is the sum of the ranks for our smallest sample.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(r.scores[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#&gt; [1] 11</span></span></code></pre></div>
<p>In this case, the <em>p</em> value is the same as what we obtained when using the original scores: 0.016. This is not always the case. If it was, using ranks would always have a relative efficiency of 1!</p>
<p>In addition to power concerns, an advantage of using ranks is that the test is available even with large sample sizes. That is because the ranks, and therefore the sum of ranks, is the same for a given sample size, regardless of the original scores. By contrast, a new distribution must be constructed every time we observe a new set of scores, and such distributions can become overwhelmingly large and take a substantial amount of time (even years!) to compute. Perhaps computers of the future (quantum computing?) can reduce this time to something more manageable, but at the time of this writing, large sample sizes still result in time constraints that will test both patience and human longevity.</p>
<p>The fact that the sum of ranks is the same (and easily calculated) for a given sample size is an especially desirable property. Here is the formula for the sum of ranks for <em>n</em> scores.</p>
<p><span class="math inline">\(n(n + 1)/2\)</span></p>
<p>If we have two conditions, rank the scores across conditions, then calculate the sum of observed ranks in the smallest condition, we can easily calculate the sum of observed ranks in the second condition.</p>
<p><span class="math inline">\([n(n + 1)/2] - \sum r_{i,1}\)</span></p>
<p>In this formula, we are summing the ranks across the <em>i</em> individuals in the first condition.</p>
<p>The fact that we can easily obtain the sum of the ranks for both conditions leads to clever algorithms for calculating the probability of sums of ranks without needing to actually compute every possible combination of scores. I am not going to present such algorithms here. I will let it suffice to give the practical result: We can conduct an exact two-sample Wilcoxon test even when we have large sample sizes. The same is not true (at least not in my lifetime) for the Fisher-Pitman randomization test with original scores.</p>
<p>A function for the Wilcoxon test is included in Base R. It is the same function that we used for the one-sample test, but this time we will include an additional argument (an additional set of scores) that will inform the function that we have two samples.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/wilcox.test">wilcox.test</a></span>(prosodic, repeated, <span class="dt">alternative =</span> <span class="st">"less"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">#&gt; </span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#&gt;  Wilcoxon rank sum test</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#&gt; </span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">#&gt; data:  prosodic and repeated</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">#&gt; W = 1, p-value = 0.01587</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#&gt; alternative hypothesis: true location shift is less than 0</span></span></code></pre></div>
<p>Let’s see if this will be able to handle our demand for an exact test if we have samples of size 40 and 50. I’m going to use the logistic distribution to generate scores. This distribution has slightly heaving tails than a normal distribution, so we know that using ranks will provide more power than if we use the <em>t</em> test with original scores.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>sample<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Logistic">rlogis</a></span>(<span class="dv">40</span>, <span class="dt">location =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="dv">1</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>sample<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Logistic">rlogis</a></span>(<span class="dv">50</span>, <span class="dt">location =</span> <span class="dv">0</span>, <span class="dt">scale =</span> <span class="dv">1</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/wilcox.test">wilcox.test</a></span>(sample<span class="fl">.1</span>, sample<span class="fl">.2</span>, <span class="dt">alternative =</span> <span class="st">"greater"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">#&gt; </span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt;  Wilcoxon rank sum test</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt; </span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt; data:  sample.1 and sample.2</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt; W = 1257, p-value = 0.01841</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt; alternative hypothesis: true location shift is greater than 0</span></span></code></pre></div>
<p>Oh happy day!</p>
</div>
<div id="other-extensions" class="section level3">
<h3 class="hasAnchor">
<a href="#other-extensions" class="anchor"></a>Other extensions</h3>
<p>As we have seen, the Fisher-Pitman method and the Wilcoxon method are really the same method. One is based on application with original scores and the other is based on application with ranks. We need not stop there. Normal scores hold great promise as replacement scores. Applying methods with normal scores guarantees that the relative efficiency, relative to the parametric counterpart, such as the <em>t</em> test, never slips below 1 and often provides more power, such as when we have both highly leptokurtic distributions as well as platykurtic distributions.</p>
<p>To apply the normal score method, we select replace original scores with normal scores, conducting our replacement with the combined samples of scores. Unlike with the one-sample procedure, this time we use both negative and positive normal scores, so we can select normal scores based on dividing the normal distribution into <em>n</em> + 1 parts.</p>
<p><span class="math inline">\(P(Z &lt; z_i) = i/(n + 1)\)</span></p>
<p>The nplearn package can handle this for us, so let’s use our prosodic instruction example to conduct the two-sample normal scores test. Note that the normal scores are returned to us in the same order as the scores in the vector that we submit to the function, so if we order by sample prior to obtaining the normal scores, we can retain that order when creating the distribution of the sum of the smallest sample.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>n.scores &lt;-<span class="st"> </span><span class="kw"><a href="../reference/norm_scores.html">norm_scores</a></span>(scores, <span class="dt">two.sample =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw"><a href="../reference/exact_twosamp_dist.html">exact_twosamp_dist</a></span>(n.scores, <span class="dv">4</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#&gt;                T.val        prob     prob.up   prob.down</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&gt;   [1,] -2.900920e+00 0.007936508 0.007936508 1.000000000</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">#&gt;   [2,] -2.647573e+00 0.007936508 0.015873016 0.992063492</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#&gt;   [3,] -2.394226e+00 0.007936508 0.023809524 0.984126984</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt;   [4,] -2.376520e+00 0.007936508 0.031746032 0.976190476</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt;   [5,] -2.123173e+00 0.007936508 0.039682540 0.968253968</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt;   [6,] -2.123173e+00 0.007936508 0.047619048 0.960317460</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt;   [7,] -2.059299e+00 0.007936508 0.055555556 0.952380952</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt;   [8,] -1.869826e+00 0.007936508 0.063492063 0.944444444</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt;   [9,] -1.852119e+00 0.007936508 0.071428571 0.936507937</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#&gt;  [10,] -1.805952e+00 0.007936508 0.079365079 0.928571429</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">#&gt;  [11,] -1.805952e+00 0.007936508 0.087301587 0.920634921</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">#&gt;  [12,] -1.619369e+00 0.007936508 0.095238095 0.912698413</span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">#&gt;  [13,] -1.598772e+00 0.007936508 0.103174603 0.904761905</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co">#&gt;  [14,] -1.552605e+00 0.007936508 0.111111111 0.896825397</span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">#&gt;  [15,] -1.534899e+00 0.007936508 0.119047619 0.888888889</span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">#&gt;  [16,] -1.534899e+00 0.007936508 0.126984127 0.880952381</span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co">#&gt;  [17,] -1.366022e+00 0.007936508 0.134920635 0.873015873</span></span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="co">#&gt;  [18,] -1.366022e+00 0.007936508 0.142857143 0.865079365</span></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co">#&gt;  [19,] -1.345425e+00 0.007936508 0.150793651 0.857142857</span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">#&gt;  [20,] -1.281552e+00 0.007936508 0.158730159 0.849206349</span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co">#&gt;  [21,] -1.281552e+00 0.007936508 0.166666667 0.841269841</span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co">#&gt;  [22,] -1.281552e+00 0.007936508 0.174603175 0.833333333</span></span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="co">#&gt;  [23,] -1.217678e+00 0.007936508 0.182539683 0.825396825</span></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="co">#&gt;  [24,] -1.112675e+00 0.007936508 0.190476190 0.817460317</span></span>
<span id="cb9-28"><a href="#cb9-28"></a><span class="co">#&gt;  [25,] -1.094968e+00 0.007936508 0.198412698 0.809523810</span></span>
<span id="cb9-29"><a href="#cb9-29"></a><span class="co">#&gt;  [26,] -1.094968e+00 0.007936508 0.206349206 0.801587302</span></span>
<span id="cb9-30"><a href="#cb9-30"></a><span class="co">#&gt;  [27,] -1.028204e+00 0.007936508 0.214285714 0.793650794</span></span>
<span id="cb9-31"><a href="#cb9-31"></a><span class="co">#&gt;  [28,] -1.028204e+00 0.007936508 0.222222222 0.785714286</span></span>
<span id="cb9-32"><a href="#cb9-32"></a><span class="co">#&gt;  [29,] -1.010498e+00 0.007936508 0.230158730 0.777777778</span></span>
<span id="cb9-33"><a href="#cb9-33"></a><span class="co">#&gt;  [30,] -9.643308e-01 0.007936508 0.238095238 0.769841270</span></span>
<span id="cb9-34"><a href="#cb9-34"></a><span class="co">#&gt;  [31,] -8.416212e-01 0.007936508 0.246031746 0.761904762</span></span>
<span id="cb9-35"><a href="#cb9-35"></a><span class="co">#&gt;  [32,] -8.416212e-01 0.007936508 0.253968254 0.753968254</span></span>
<span id="cb9-36"><a href="#cb9-36"></a><span class="co">#&gt;  [33,] -8.416212e-01 0.007936508 0.261904762 0.746031746</span></span>
<span id="cb9-37"><a href="#cb9-37"></a><span class="co">#&gt;  [34,] -7.777476e-01 0.007936508 0.269841270 0.738095238</span></span>
<span id="cb9-38"><a href="#cb9-38"></a><span class="co">#&gt;  [35,] -7.777476e-01 0.007936508 0.277777778 0.730158730</span></span>
<span id="cb9-39"><a href="#cb9-39"></a><span class="co">#&gt;  [36,] -7.571511e-01 0.007936508 0.285714286 0.722222222</span></span>
<span id="cb9-40"><a href="#cb9-40"></a><span class="co">#&gt;  [37,] -7.571511e-01 0.007936508 0.293650794 0.714285714</span></span>
<span id="cb9-41"><a href="#cb9-41"></a><span class="co">#&gt;  [38,] -7.109837e-01 0.007936508 0.301587302 0.706349206</span></span>
<span id="cb9-42"><a href="#cb9-42"></a><span class="co">#&gt;  [39,] -6.932774e-01 0.007936508 0.309523810 0.698412698</span></span>
<span id="cb9-43"><a href="#cb9-43"></a><span class="co">#&gt;  [40,] -5.882741e-01 0.007936508 0.317460317 0.690476190</span></span>
<span id="cb9-44"><a href="#cb9-44"></a><span class="co">#&gt;  [41,] -5.882741e-01 0.007936508 0.325396825 0.682539683</span></span>
<span id="cb9-45"><a href="#cb9-45"></a><span class="co">#&gt;  [42,] -5.705678e-01 0.007936508 0.333333333 0.674603175</span></span>
<span id="cb9-46"><a href="#cb9-46"></a><span class="co">#&gt;  [43,] -5.244005e-01 0.007936508 0.341269841 0.666666667</span></span>
<span id="cb9-47"><a href="#cb9-47"></a><span class="co">#&gt;  [44,] -5.244005e-01 0.007936508 0.349206349 0.658730159</span></span>
<span id="cb9-48"><a href="#cb9-48"></a><span class="co">#&gt;  [45,] -5.244005e-01 0.007936508 0.357142857 0.650793651</span></span>
<span id="cb9-49"><a href="#cb9-49"></a><span class="co">#&gt;  [46,] -5.038039e-01 0.007936508 0.365079365 0.642857143</span></span>
<span id="cb9-50"><a href="#cb9-50"></a><span class="co">#&gt;  [47,] -4.399303e-01 0.007936508 0.373015873 0.634920635</span></span>
<span id="cb9-51"><a href="#cb9-51"></a><span class="co">#&gt;  [48,] -4.399303e-01 0.007936508 0.380952381 0.626984127</span></span>
<span id="cb9-52"><a href="#cb9-52"></a><span class="co">#&gt;  [49,] -3.378173e-01 0.007936508 0.388888889 0.619047619</span></span>
<span id="cb9-53"><a href="#cb9-53"></a><span class="co">#&gt;  [50,] -3.172207e-01 0.007936508 0.396825397 0.611111111</span></span>
<span id="cb9-54"><a href="#cb9-54"></a><span class="co">#&gt;  [51,] -3.172207e-01 0.007936508 0.404761905 0.603174603</span></span>
<span id="cb9-55"><a href="#cb9-55"></a><span class="co">#&gt;  [52,] -2.710534e-01 0.007936508 0.412698413 0.595238095</span></span>
<span id="cb9-56"><a href="#cb9-56"></a><span class="co">#&gt;  [53,] -2.710534e-01 0.007936508 0.420634921 0.587301587</span></span>
<span id="cb9-57"><a href="#cb9-57"></a><span class="co">#&gt;  [54,] -2.533471e-01 0.007936508 0.428571429 0.579365079</span></span>
<span id="cb9-58"><a href="#cb9-58"></a><span class="co">#&gt;  [55,] -2.533471e-01 0.007936508 0.436507937 0.571428571</span></span>
<span id="cb9-59"><a href="#cb9-59"></a><span class="co">#&gt;  [56,] -2.533471e-01 0.007936508 0.444444444 0.563492063</span></span>
<span id="cb9-60"><a href="#cb9-60"></a><span class="co">#&gt;  [57,] -1.865832e-01 0.007936508 0.452380952 0.555555556</span></span>
<span id="cb9-61"><a href="#cb9-61"></a><span class="co">#&gt;  [58,] -1.688769e-01 0.007936508 0.460317460 0.547619048</span></span>
<span id="cb9-62"><a href="#cb9-62"></a><span class="co">#&gt;  [59,] -8.447018e-02 0.007936508 0.468253968 0.539682540</span></span>
<span id="cb9-63"><a href="#cb9-63"></a><span class="co">#&gt;  [60,] -6.387362e-02 0.007936508 0.476190476 0.531746032</span></span>
<span id="cb9-64"><a href="#cb9-64"></a><span class="co">#&gt;  [61,]  0.000000e+00 0.007936508 0.484126984 0.523809524</span></span>
<span id="cb9-65"><a href="#cb9-65"></a><span class="co">#&gt;  [62,]  0.000000e+00 0.007936508 0.492063492 0.515873016</span></span>
<span id="cb9-66"><a href="#cb9-66"></a><span class="co">#&gt;  [63,]  0.000000e+00 0.007936508 0.500000000 0.507936508</span></span>
<span id="cb9-67"><a href="#cb9-67"></a><span class="co">#&gt;  [64,]  2.220446e-16 0.007936508 0.507936508 0.500000000</span></span>
<span id="cb9-68"><a href="#cb9-68"></a><span class="co">#&gt;  [65,]  2.220446e-16 0.007936508 0.515873016 0.492063492</span></span>
<span id="cb9-69"><a href="#cb9-69"></a><span class="co">#&gt;  [66,]  2.220446e-16 0.007936508 0.523809524 0.484126984</span></span>
<span id="cb9-70"><a href="#cb9-70"></a><span class="co">#&gt;  [67,]  6.387362e-02 0.007936508 0.531746032 0.476190476</span></span>
<span id="cb9-71"><a href="#cb9-71"></a><span class="co">#&gt;  [68,]  8.447018e-02 0.007936508 0.539682540 0.468253968</span></span>
<span id="cb9-72"><a href="#cb9-72"></a><span class="co">#&gt;  [69,]  1.688769e-01 0.007936508 0.547619048 0.460317460</span></span>
<span id="cb9-73"><a href="#cb9-73"></a><span class="co">#&gt;  [70,]  1.865832e-01 0.007936508 0.555555556 0.452380952</span></span>
<span id="cb9-74"><a href="#cb9-74"></a><span class="co">#&gt;  [71,]  2.533471e-01 0.007936508 0.563492063 0.444444444</span></span>
<span id="cb9-75"><a href="#cb9-75"></a><span class="co">#&gt;  [72,]  2.533471e-01 0.007936508 0.571428571 0.436507937</span></span>
<span id="cb9-76"><a href="#cb9-76"></a><span class="co">#&gt;  [73,]  2.533471e-01 0.007936508 0.579365079 0.428571429</span></span>
<span id="cb9-77"><a href="#cb9-77"></a><span class="co">#&gt;  [74,]  2.710534e-01 0.007936508 0.587301587 0.420634921</span></span>
<span id="cb9-78"><a href="#cb9-78"></a><span class="co">#&gt;  [75,]  2.710534e-01 0.007936508 0.595238095 0.412698413</span></span>
<span id="cb9-79"><a href="#cb9-79"></a><span class="co">#&gt;  [76,]  3.172207e-01 0.007936508 0.603174603 0.404761905</span></span>
<span id="cb9-80"><a href="#cb9-80"></a><span class="co">#&gt;  [77,]  3.172207e-01 0.007936508 0.611111111 0.396825397</span></span>
<span id="cb9-81"><a href="#cb9-81"></a><span class="co">#&gt;  [78,]  3.378173e-01 0.007936508 0.619047619 0.388888889</span></span>
<span id="cb9-82"><a href="#cb9-82"></a><span class="co">#&gt;  [79,]  4.399303e-01 0.007936508 0.626984127 0.380952381</span></span>
<span id="cb9-83"><a href="#cb9-83"></a><span class="co">#&gt;  [80,]  4.399303e-01 0.007936508 0.634920635 0.373015873</span></span>
<span id="cb9-84"><a href="#cb9-84"></a><span class="co">#&gt;  [81,]  5.038039e-01 0.007936508 0.642857143 0.365079365</span></span>
<span id="cb9-85"><a href="#cb9-85"></a><span class="co">#&gt;  [82,]  5.244005e-01 0.007936508 0.650793651 0.357142857</span></span>
<span id="cb9-86"><a href="#cb9-86"></a><span class="co">#&gt;  [83,]  5.244005e-01 0.007936508 0.658730159 0.349206349</span></span>
<span id="cb9-87"><a href="#cb9-87"></a><span class="co">#&gt;  [84,]  5.244005e-01 0.007936508 0.666666667 0.341269841</span></span>
<span id="cb9-88"><a href="#cb9-88"></a><span class="co">#&gt;  [85,]  5.705678e-01 0.007936508 0.674603175 0.333333333</span></span>
<span id="cb9-89"><a href="#cb9-89"></a><span class="co">#&gt;  [86,]  5.882741e-01 0.007936508 0.682539683 0.325396825</span></span>
<span id="cb9-90"><a href="#cb9-90"></a><span class="co">#&gt;  [87,]  5.882741e-01 0.007936508 0.690476190 0.317460317</span></span>
<span id="cb9-91"><a href="#cb9-91"></a><span class="co">#&gt;  [88,]  6.932774e-01 0.007936508 0.698412698 0.309523810</span></span>
<span id="cb9-92"><a href="#cb9-92"></a><span class="co">#&gt;  [89,]  7.109837e-01 0.007936508 0.706349206 0.301587302</span></span>
<span id="cb9-93"><a href="#cb9-93"></a><span class="co">#&gt;  [90,]  7.571511e-01 0.007936508 0.714285714 0.293650794</span></span>
<span id="cb9-94"><a href="#cb9-94"></a><span class="co">#&gt;  [91,]  7.571511e-01 0.007936508 0.722222222 0.285714286</span></span>
<span id="cb9-95"><a href="#cb9-95"></a><span class="co">#&gt;  [92,]  7.777476e-01 0.007936508 0.730158730 0.277777778</span></span>
<span id="cb9-96"><a href="#cb9-96"></a><span class="co">#&gt;  [93,]  7.777476e-01 0.007936508 0.738095238 0.269841270</span></span>
<span id="cb9-97"><a href="#cb9-97"></a><span class="co">#&gt;  [94,]  8.416212e-01 0.007936508 0.746031746 0.261904762</span></span>
<span id="cb9-98"><a href="#cb9-98"></a><span class="co">#&gt;  [95,]  8.416212e-01 0.007936508 0.753968254 0.253968254</span></span>
<span id="cb9-99"><a href="#cb9-99"></a><span class="co">#&gt;  [96,]  8.416212e-01 0.007936508 0.761904762 0.246031746</span></span>
<span id="cb9-100"><a href="#cb9-100"></a><span class="co">#&gt;  [97,]  9.643308e-01 0.007936508 0.769841270 0.238095238</span></span>
<span id="cb9-101"><a href="#cb9-101"></a><span class="co">#&gt;  [98,]  1.010498e+00 0.007936508 0.777777778 0.230158730</span></span>
<span id="cb9-102"><a href="#cb9-102"></a><span class="co">#&gt;  [99,]  1.028204e+00 0.007936508 0.785714286 0.222222222</span></span>
<span id="cb9-103"><a href="#cb9-103"></a><span class="co">#&gt; [100,]  1.028204e+00 0.007936508 0.793650794 0.214285714</span></span>
<span id="cb9-104"><a href="#cb9-104"></a><span class="co">#&gt; [101,]  1.094968e+00 0.007936508 0.801587302 0.206349206</span></span>
<span id="cb9-105"><a href="#cb9-105"></a><span class="co">#&gt; [102,]  1.094968e+00 0.007936508 0.809523810 0.198412698</span></span>
<span id="cb9-106"><a href="#cb9-106"></a><span class="co">#&gt; [103,]  1.112675e+00 0.007936508 0.817460317 0.190476190</span></span>
<span id="cb9-107"><a href="#cb9-107"></a><span class="co">#&gt; [104,]  1.217678e+00 0.007936508 0.825396825 0.182539683</span></span>
<span id="cb9-108"><a href="#cb9-108"></a><span class="co">#&gt; [105,]  1.281552e+00 0.007936508 0.833333333 0.174603175</span></span>
<span id="cb9-109"><a href="#cb9-109"></a><span class="co">#&gt; [106,]  1.281552e+00 0.007936508 0.841269841 0.166666667</span></span>
<span id="cb9-110"><a href="#cb9-110"></a><span class="co">#&gt; [107,]  1.281552e+00 0.007936508 0.849206349 0.158730159</span></span>
<span id="cb9-111"><a href="#cb9-111"></a><span class="co">#&gt; [108,]  1.345425e+00 0.007936508 0.857142857 0.150793651</span></span>
<span id="cb9-112"><a href="#cb9-112"></a><span class="co">#&gt; [109,]  1.366022e+00 0.007936508 0.865079365 0.142857143</span></span>
<span id="cb9-113"><a href="#cb9-113"></a><span class="co">#&gt; [110,]  1.366022e+00 0.007936508 0.873015873 0.134920635</span></span>
<span id="cb9-114"><a href="#cb9-114"></a><span class="co">#&gt; [111,]  1.534899e+00 0.007936508 0.880952381 0.126984127</span></span>
<span id="cb9-115"><a href="#cb9-115"></a><span class="co">#&gt; [112,]  1.534899e+00 0.007936508 0.888888889 0.119047619</span></span>
<span id="cb9-116"><a href="#cb9-116"></a><span class="co">#&gt; [113,]  1.552605e+00 0.007936508 0.896825397 0.111111111</span></span>
<span id="cb9-117"><a href="#cb9-117"></a><span class="co">#&gt; [114,]  1.598772e+00 0.007936508 0.904761905 0.103174603</span></span>
<span id="cb9-118"><a href="#cb9-118"></a><span class="co">#&gt; [115,]  1.619369e+00 0.007936508 0.912698413 0.095238095</span></span>
<span id="cb9-119"><a href="#cb9-119"></a><span class="co">#&gt; [116,]  1.805952e+00 0.007936508 0.920634921 0.087301587</span></span>
<span id="cb9-120"><a href="#cb9-120"></a><span class="co">#&gt; [117,]  1.805952e+00 0.007936508 0.928571429 0.079365079</span></span>
<span id="cb9-121"><a href="#cb9-121"></a><span class="co">#&gt; [118,]  1.852119e+00 0.007936508 0.936507937 0.071428571</span></span>
<span id="cb9-122"><a href="#cb9-122"></a><span class="co">#&gt; [119,]  1.869826e+00 0.007936508 0.944444444 0.063492063</span></span>
<span id="cb9-123"><a href="#cb9-123"></a><span class="co">#&gt; [120,]  2.059299e+00 0.007936508 0.952380952 0.055555556</span></span>
<span id="cb9-124"><a href="#cb9-124"></a><span class="co">#&gt; [121,]  2.123173e+00 0.007936508 0.960317460 0.047619048</span></span>
<span id="cb9-125"><a href="#cb9-125"></a><span class="co">#&gt; [122,]  2.123173e+00 0.007936508 0.968253968 0.039682540</span></span>
<span id="cb9-126"><a href="#cb9-126"></a><span class="co">#&gt; [123,]  2.376520e+00 0.007936508 0.976190476 0.031746032</span></span>
<span id="cb9-127"><a href="#cb9-127"></a><span class="co">#&gt; [124,]  2.394226e+00 0.007936508 0.984126984 0.023809524</span></span>
<span id="cb9-128"><a href="#cb9-128"></a><span class="co">#&gt; [125,]  2.647573e+00 0.007936508 0.992063492 0.015873016</span></span>
<span id="cb9-129"><a href="#cb9-129"></a><span class="co">#&gt; [126,]  2.900920e+00 0.007936508 1.000000000 0.007936508</span></span></code></pre></div>
<p>Here is the sum in the prosodic instruction condition.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(n.scores[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">#&gt; [1] -2.647573</span></span></code></pre></div>
<p>As before, we obtain <em>p</em> = 0.016. Looking at this distribution highlights what may be the only disadvantage of using the normal scores test. As with original scores, the distribution can become large very quickly. Until computers become even more powerful, the Wilcoxon will still be our go-to procedure for large sample sizes.</p>
<p>You may recall from our study of a single sample that the sign test, although it is based on the binomial distribution, can be conducted using the one-sample randomization model simply by replacing scores with values of 0 and 1, to represent the dichotomous nature of the sign test. Similarly, instead of using the hypergeometric distribution to conduct the Fisher-Irwin test, we can perform this test as a randomization test with 0 and 1 values.</p>
<p>Here is the method we used to analyze band performance data with a fixed number of successes at 5, in order to fill the all-state band slots.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>morning.success &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">5</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>afternoon.success &lt;-<span class="st"> </span><span class="dv">5</span> <span class="op">-</span><span class="st"> </span>morning.success</span>
<span id="cb11-3"><a href="#cb11-3"></a>delta.hat &lt;-<span class="st"> </span>morning.success<span class="op">/</span><span class="dv">10</span> <span class="op">-</span><span class="st"> </span>afternoon.success<span class="op">/</span><span class="dv">10</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>prob &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Hypergeometric">dhyper</a></span>(morning.success, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">5</span>)</span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(morning.success, afternoon.success, delta.hat, prob)</span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#&gt;      morning.success afternoon.success delta.hat       prob</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#&gt; [1,]               0                 5      -0.5 0.01625387</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#&gt; [2,]               1                 4      -0.3 0.13544892</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt; [3,]               2                 3      -0.1 0.34829721</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt; [4,]               3                 2       0.1 0.34829721</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#&gt; [5,]               4                 1       0.3 0.13544892</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">#&gt; [6,]               5                 0       0.5 0.01625387</span></span></code></pre></div>
<p>Let’s do this again using our exact two-sample distribution procedure and replacing scores with 0s and 1s. We will have 5 successes and 15 failures, so I am going to put 5 values of 1 and 15 values of 0 into the function. I’ll also indicate that the size of the first sample is 10.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw"><a href="../reference/exact_twosamp_dist.html">exact_twosamp_dist</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">1</span>, <span class="dv">5</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>, <span class="dv">15</span>)), <span class="dv">10</span>, <span class="dt">duplicate =</span> <span class="ot">FALSE</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co">#&gt;      T.unique       prob    prob.up  prob.down</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">#&gt; [1,]        0 0.01625387 0.01625387 1.00000000</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">#&gt; [2,]        1 0.13544892 0.15170279 0.98374613</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">#&gt; [3,]        2 0.34829721 0.50000000 0.84829721</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">#&gt; [4,]        3 0.34829721 0.84829721 0.50000000</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co">#&gt; [5,]        4 0.13544892 0.98374613 0.15170279</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co">#&gt; [6,]        5 0.01625387 1.00000000 0.01625387</span></span></code></pre></div>
<p>We get the same distribution using randomization as we do using the hypergeometric! Cool! So we can envision the Fisher-Irwin test as the Fisher-Pitman randomization test, but using 0 and 1 as replacement scores.</p>
</div>
<div id="a-confidence-interval-for-the-median-difference" class="section level3">
<h3 class="hasAnchor">
<a href="#a-confidence-interval-for-the-median-difference" class="anchor"></a>A confidence interval for the median difference</h3>
<p>Consider the following difference, where <span class="math inline">\(x_1\)</span> is a score from our first sample and <span class="math inline">\(x_2\)</span> is a score from our second sample.</p>
<p><span class="math inline">\(d = X_2 - X_1\)</span></p>
<p>We can create all possible differences between scores in our first and second samples. Here is a matrix for our prosodic instruction example.</p>
<div class="figure">
<img src="difference%20scores.jpg" alt=""><p class="caption"><em>Figure 2</em></p>
</div>
<p>Under the null hypothesis, we would expect the median of these difference scores to be 0. That is, we could rewrite the null and alternative hypothesis like this.</p>
<p><span class="math inline">\(H_0: \theta_d = 0\)</span></p>
<p><span class="math inline">\(H_a: \theta_d &gt; 0\)</span></p>
<p>Note that the direction of our alternative hypothesis depends on the direction of subtraction in the matrix. In this example, I have subtracted the errors in the prosodic instruction condition from those in the repeated reading condition, so if prosodic instruction is reducing the number of errors, then I am expecting a positive difference.</p>
<p>We can obtain an estimate of <span class="math inline">\(\theta_d\)</span> by using <span class="math inline">\(\hat{\theta}_d\)</span>, the median of these differences. Note that unlike the mean, the median of the differences is not guaranted to be equal to the difference of the medians. While both of these statistics provide an estimate of the effectiveness of prosodic instruction, the median of differences will be a more generally useful estimate.</p>
<p>In the late 40s, at about the same time that Wilcoxon was developing his two-sample test based on ranks, two statisticians by the names of Henry Mann and Donald Whitney developed a test based on all possible differences. They defined an “inversion” with the following definition.</p>
<p><span class="math inline">\(d &gt; \theta_d\)</span></p>
<p>They then referred to the number of inversions as “U”, so their test is commonly known as the Mann-Whitney U test. If the null hypothesis is true, we should expect U to be half of the total number of differences. If the alternative hypothesis is true, and based on the way I subtracted in the above matrix, we would expect U to be a larger number. Mann and Whitney then computed probabilities for U, given the truth of the null hypothesis. Using these probabilities, we can conduct a test of the null hypothesis to determine whether we should reject it in favor of the alternative hypothesis.</p>
<p>It turns out that U can be written as a function of Wilcoxon’s T, the sum of the differences in the smallest group. Here’s the formula.</p>
<p><span class="math inline">\(U = n_1 n_2 + \frac{n_1(n_1 + 1)}{2} - T\)</span></p>
<p>Here again is the distribution of T for our prosodic instruction example.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw"><a href="../reference/exact_twosamp_dist.html">exact_twosamp_dist</a></span>(r.scores, <span class="dv">4</span>, <span class="dt">duplicate =</span> <span class="ot">FALSE</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">#&gt;       T.unique        prob     prob.up   prob.down</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#&gt;  [1,]       10 0.007936508 0.007936508 1.000000000</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">#&gt;  [2,]       11 0.007936508 0.015873016 0.992063492</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">#&gt;  [3,]       12 0.015873016 0.031746032 0.984126984</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">#&gt;  [4,]       13 0.023809524 0.055555556 0.968253968</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">#&gt;  [5,]       14 0.039682540 0.095238095 0.944444444</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">#&gt;  [6,]       15 0.047619048 0.142857143 0.904761905</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">#&gt;  [7,]       16 0.063492063 0.206349206 0.857142857</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co">#&gt;  [8,]       17 0.071428571 0.277777778 0.793650794</span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co">#&gt;  [9,]       18 0.087301587 0.365079365 0.722222222</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="co">#&gt; [10,]       19 0.087301587 0.452380952 0.634920635</span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="co">#&gt; [11,]       20 0.095238095 0.547619048 0.547619048</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co">#&gt; [12,]       21 0.087301587 0.634920635 0.452380952</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co">#&gt; [13,]       22 0.087301587 0.722222222 0.365079365</span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="co">#&gt; [14,]       23 0.071428571 0.793650794 0.277777778</span></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="co">#&gt; [15,]       24 0.063492063 0.857142857 0.206349206</span></span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="co">#&gt; [16,]       25 0.047619048 0.904761905 0.142857143</span></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co">#&gt; [17,]       26 0.039682540 0.944444444 0.095238095</span></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="co">#&gt; [18,]       27 0.023809524 0.968253968 0.055555556</span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="co">#&gt; [19,]       28 0.015873016 0.984126984 0.031746032</span></span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="co">#&gt; [20,]       29 0.007936508 0.992063492 0.015873016</span></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co">#&gt; [21,]       30 0.007936508 1.000000000 0.007936508</span></span></code></pre></div>
<p>If we conducted the test using a 5% Type I error rate, our critical value would be 12. Let’s plug that into the above equation.</p>
<p><span class="math inline">\(U = (4)(5) + \frac{(4)(4+1)}{2} - 12 = 18\)</span></p>
<p>This is the critical value if we use the Mann-Whitney U. Out of the 20 median differences, we will reject the null hypothesis if we have 18, 19, or 20 inversions. We have 19, so we will reject the null hypothesis. We knew that would happen because we rejected the null hypothesis with the two-sample Wilcoxon test, and we have now seen that these tests are equivalent.</p>
<p>If they are equivalent, why bother presenting this second test? I’m glad you asked! With the Mann-Whitney U procedure, we could test these hypotheses.</p>
<p><span class="math inline">\(H_0: \theta_d = 1\)</span></p>
<p><span class="math inline">\(H_a: \theta_d &gt; 1\)</span></p>
<p>All we need to do is to subtract 1 from all the values in our matrix in order to change the null hypothesis back to a median difference of 0. Look at the matrix. If we subtract 1, we will now have 18 inversions (U = 18). If we test for a median difference of 2, we just subtract 2 from all values. We now have U = 17. If we subtract 3, we now have U = 15.</p>
<p>But wait! We know that we will reject the null hypothesis for U = 18, 19, or 20. That means we will reject for a hypothesized median difference of 1, but we will not reject for a hypothesized median difference of 2. We also will not reject for a hypothesized median difference of 3. It doesn’t take long to figure out that 2 is a cut-off value between rejecting the null hypothesis (any median difference less than 2) or retaining the null hypothesis (any median difference of 2 or greater). A confidence interval consists of all null hypotheses that we do not reject, given our observations, so we now have a confidence interval! A 95% confidence interval for the median difference is given by this.</p>
<p><span class="math inline">\(\theta_d \ge 2\)</span></p>
<p>Do we have to build this matrix every time we want a confidence interval? We do not. Check it out.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/wilcox.test">wilcox.test</a></span>(repeated,</span>
<span id="cb14-2"><a href="#cb14-2"></a>            prosodic,</span>
<span id="cb14-3"><a href="#cb14-3"></a>            <span class="dt">alternative =</span> <span class="st">"greater"</span>,</span>
<span id="cb14-4"><a href="#cb14-4"></a>            <span class="dt">exact =</span> <span class="ot">TRUE</span>,</span>
<span id="cb14-5"><a href="#cb14-5"></a>            <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)</span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">#&gt; </span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#&gt;  Wilcoxon rank sum test</span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">#&gt; </span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">#&gt; data:  repeated and prosodic</span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co">#&gt; W = 19, p-value = 0.01587</span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">#&gt; alternative hypothesis: true location shift is greater than 0</span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="co">#&gt;    2 Inf</span></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="co">#&gt; difference in location </span></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="co">#&gt;                      7</span></span></code></pre></div>
<p>Life just keeps getting better and better!</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Michael Seaman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
