<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Relative Efficiency • nplearn</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Relative Efficiency">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nplearn</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9017</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Bernoulli-Events.html">Bernoulli Events</a>
    </li>
    <li>
      <a href="../articles/binomdist.html">The Binomial Distribution</a>
    </li>
    <li>
      <a href="../articles/FisherIrwin.html">The Fisher-Irwin Test</a>
    </li>
    <li>
      <a href="../articles/gof.html">Goodness of Fit</a>
    </li>
    <li>
      <a href="../articles/lsprop.html">Large-Sample Proportion Inference</a>
    </li>
    <li>
      <a href="../articles/OnePropExact.html">Exact Inference for a Single Proportion</a>
    </li>
    <li>
      <a href="../articles/ProdBinom.html">The Product Binomial</a>
    </li>
    <li>
      <a href="../articles/randomization.html">Randomization Tests</a>
    </li>
    <li>
      <a href="../articles/releffic.html">Relative Efficiency</a>
    </li>
    <li>
      <a href="../articles/ReplaceScores.html">Replacement Scores</a>
    </li>
    <li>
      <a href="../articles/signtest.html">The Sign Test</a>
    </li>
    <li>
      <a href="../articles/Workflow-Sample.html">Workflow Sample</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Relative Efficiency</h1>
            
      
      
      <div class="hidden name"><code>releffic.Rmd</code></div>

    </div>

    
    
<p>An obvious question we will have when there are multiple methods for analyzing the same set of data is, “Which method is best?” We answer that question by looking at the relative efficiency of one method compared to another method when either method could be used to obtain our desired statistics, such as a <em>p</em> value or a confidence interval. In this vignette we will learn about two types of efficiencies and how they can be used to select the “best” method for conducting our analysis.</p>
<div id="required-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#required-packages" class="anchor"></a>Required packages</h3>
<p>The packages required for this vignette are nplearn, DescTools, and coin.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(nplearn)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(DescTools)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(coin)</span></code></pre></div>
</div>
<div id="relative-efficiency" class="section level3">
<h3 class="hasAnchor">
<a href="#relative-efficiency" class="anchor"></a>Relative efficiency</h3>
<p>We know that the power of a procedure to be able to reject a statistical null hypothesis about <strong>no</strong> treatment effect on the response variable, when indeed the treatment <strong>does</strong> have an effect on the response variable, is based on three variables: the size of the effect, the researcher’s chosen maximum Type I error rate, and the sample size. If there are at least two possible procedures for testing the same null hypothesis, then the procedure that will offer the most power after setting an effect size, a Type I error rate, and a sample size, keeping all three of these the same for both procedures, is considered the more efficient of the two procedures. We call this <em>relative efficiency</em> because we are referring to the efficiency of one procedure relative to another procedure.</p>
<p>Power is related to the Type II error rate as follows.</p>
<p><span class="math inline">\(Power = 1 - P(Type\ II\ error | H_1)\)</span></p>
<p>For a specific simple alternative hypothesis, power is inversly related to our chosen Type II error rate. We also know, all else held constant, that as the allowable Type I error rate is increased, the Type II error rate decreases, so that an increase in the Type I error rate also increases power. Ideally, a researcher wants to declare both the Type I and Type II error rates. The treatment effect is unknown, but a researcher can hypothesize a specific effect. In this case, the only unknown is the sample size. This is a desirable state of affairs because sample size is the cost of doing business in social and behavioral research based on the scientific method. A researcher is able to declare a tolerance for both types of errors, provide the size of a treatment effect that might be of interest, and the calculate what sample size will be needed to achieve these goals.</p>
<p>In this methodological framework, it makes sense to think of efficiency as the relative sample size needed to achieve the stated goals. If two researchers declare the same tolerance for Type I and Type II errors and state that same treatment effect size of interest, then if one researcher is able to achieve these goals with a smaller sample size, this researcher is conducting a more efficient study. Rather than comparing two researchers, let’s compare two methods for testing the same null hypothesis against the same alternative hypothesis. There is no reason to alter the Type I and Type II error rates just because we are comparing methods, so these will be the same regardless of method. The method that can maintain the error rates with the hypothesized effect size and do so with the fewest number of units of analysis is the most efficent method of the two methods. That is, it has higher relative efficiency when compared to the second stated method.</p>
<p>Efficiency is one of several considerations when choosing among methods. Most obviously, if the two methods require two different sets of conditons for valid inference, and if the researcher can ascertain that only one set of conditions has been met, this should weigh heavily in the decision about methods. Selecting a “more efficient” method that leads to inferential statements that cannot be trusted is a bit like using “what tastes better” as a criterion for nutrition. If nutrition is a concern, we should probably rely on factors more directly associated with nutrition than personal taste preference, though we are pleased when these align nicely. Similarly, if we select methods based on our belief that we have met the conditions for valid inference, we are grateful if those happen to be the ones that are more efficient.</p>
<p>Unfortunately and all-too-often, the expertise of our colleagues and audience may become a concern. We may discover that a more efficient method is also a lesser-known method so that we have to explain our results, or perhaps even justify our use of the method. When the relative efficiency of the lesser-known method is associated with a very small increase in power for a similar sample size, the researcher may consider it more prudent to stay with better-known methods. Of course, I wouldn’t advise this if the conditions for valid inference are suspect for the better-known method. I also would not advise ignoring that some lesser-known methods may more closely align with the realities of our research conditions and can even provide power gains. It is common to hear that “nonparametric procedures are less powerful,” but saying it does not make it true. This misconception may lead us to reference studies of relative efficiency, but that is a small price to pay in order to match the conditions of our study with those necessary for valid inference and to potentially increase the power of our study.</p>
</div>
<div id="local-relative-efficiency" class="section level3">
<h3 class="hasAnchor">
<a href="#local-relative-efficiency" class="anchor"></a>Local relative efficiency</h3>
<p>When we speak of <em>local relative efficiency</em> (LRE), the term “local” is a reference to the specific conditions of our study. Thus, parsing the terms in this phrase, local relative efficiency is the description of the efficiency of one method when compared to another method for a specific set of circumstances.</p>
<p>As an example, consider a matched-pair design with randomization where both the original scores and the differences are from a normal distribution. (We would expect the difference scores to also be normally distributed if the effect of the treatment is uniformly applied across pairs so that the distribution, as a whole, shifts one way or the other along the scale.) Now let’s assume that we are interested in a treatment effect of 0.3 standard deviations. We believe this will be a positive affect that is reflected in a positive distribution shift. To make life easier, we will say that the mean difference (treatment minus control) is 0.3 and the standard deviation is 1. We will use a Type I error rate of 0.05 and a Type II error rate of 0.20, which translates to 80% power.</p>
<p>Here is our null hypothesis.</p>
<p><span class="math inline">\(H_0: \mu = 0\)</span></p>
<p>Here is our specific alternative hypothesis.</p>
<p><span class="math inline">\(H_1: \mu = 0.3\)</span></p>
<p>We can use the mean or the median here because the distribution is symmetrical. I’m going to use the mean to emphasize the alternatives that we have for performing a hypothesis test in this very common setting.</p>
<p>Base R has a function that we can use to determine the sample size for using the <em>t</em> test, so let’s use it and see what we get.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/power.t.test">power.t.test</a></span>(<span class="dt">delta =</span> <span class="fl">0.3</span>,</span>
<span id="cb2-2"><a href="#cb2-2"></a>             <span class="dt">sd =</span> <span class="dv">1</span>,</span>
<span id="cb2-3"><a href="#cb2-3"></a>             <span class="dt">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb2-4"><a href="#cb2-4"></a>             <span class="dt">power =</span> <span class="fl">0.8</span>,</span>
<span id="cb2-5"><a href="#cb2-5"></a>             <span class="dt">type =</span> <span class="st">"paired"</span>,</span>
<span id="cb2-6"><a href="#cb2-6"></a>             <span class="dt">alternative =</span> <span class="st">"one.sided"</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt; </span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt;      Paired t test power calculation </span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt; </span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#&gt;               n = 70.06793</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt;           delta = 0.3</span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#&gt;              sd = 1</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">#&gt;       sig.level = 0.05</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">#&gt;           power = 0.8</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">#&gt;     alternative = one.sided</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#&gt; </span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">#&gt; </span><span class="al">NOTE</span><span class="co">: n is number of *pairs*, sd is std.dev. of *differences* within pairs</span></span></code></pre></div>
<p>We need 70 pairs. Let’s see how many pairs we would need for the sign test. Unfortunately, this is not as easy as calling an R function. We can make life easier by using large-sample approximations, so that’s what we are going to do. The fact that we need 70 pairs for the <em>t</em> test makes me feel good about using a large-sample approximation. Keep in mind that we began with a normal distribution, so we already know that the <em>t</em> test is the most powerful method that we can use in this situation. Thus, we are going to need more than 70 matched pairs for any other test we consider, including the sign test.</p>
<p>Here is how the power of the sign test looks for 70 matched pairs. (I’m also ignoring the correction for continuity, again to make this easier to follow.) We already know that we expect 50% of the signs to be plus signs when the null hypothesis is true. What proportion of the scores do we expect to be plus signs if we shift the mean (median) up 0.3? This leaves our null hypothesis 0.3 below the true mean, so we can do this simple calculation.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">pnorm</a></span>(<span class="op">-</span><span class="fl">0.3</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#&gt; [1] 0.6179114</span></span></code></pre></div>
<p>So I expect about 62% of the scores to be plus signs, rather than 50%. Let’s see if 62% is enough to give us 80% power to reject the null hypothesis of 50%. (We already know what the answer will be!)</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Here's our mean under H0</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>h0.prop &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># Here's our mean under H1</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>h1.prop &lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">pnorm</a></span>(<span class="op">-</span><span class="fl">0.3</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co"># Here's the se for pi_hat with n = 70</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>h0.se &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">sqrt</a></span>(h0.prop <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>h0.prop) <span class="op">/</span><span class="st"> </span><span class="dv">70</span>)</span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co"># Here's the critical value for rejecting H0 when n = 70</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>cv &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">qnorm</a></span>(<span class="fl">0.95</span>, <span class="dt">mean =</span> h0.prop, <span class="dt">sd =</span> h0.se)</span>
<span id="cb4-12"><a href="#cb4-12"></a></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co"># Here's the power for rejecting H0 when the mean increases by 3</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">pnorm</a></span>(cv, <span class="dt">mean =</span> h1.prop, <span class="dt">sd =</span> h0.se, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co">#&gt; [1] 0.6286129</span></span></code></pre></div>
<p>We have about 63% power, so we have quite a ways to go. Let’s do this all again, but with sample sizes from 70 to 120. I’ll keep track of power so that we can look at the results.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>n &lt;-<span class="st"> </span><span class="dv">70</span><span class="op">:</span><span class="dv">120</span></span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># Here's the se for pi_hat</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>h0.se &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">sqrt</a></span>(h0.prop <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>h0.prop) <span class="op">/</span><span class="st"> </span>n)</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co"># Here's the critical value for rejecting H0 when n = 70</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>cv &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">qnorm</a></span>(<span class="fl">0.95</span>, <span class="dt">mean =</span> h0.prop, <span class="dt">sd =</span> h0.se)</span>
<span id="cb5-8"><a href="#cb5-8"></a></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co"># Here's the power for rejecting H0 when the mean increases by 3</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>pow &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">pnorm</a></span>(cv, <span class="dt">mean =</span> h1.prop, <span class="dt">sd =</span> h0.se, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb5-11"><a href="#cb5-11"></a></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co"># Let's put it together</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(n, pow)</span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">#&gt;         n       pow</span></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="co">#&gt;  [1,]  70 0.6286129</span></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co">#&gt;  [2,]  71 0.6339092</span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co">#&gt;  [3,]  72 0.6391432</span></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="co">#&gt;  [4,]  73 0.6443153</span></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="co">#&gt;  [5,]  74 0.6494260</span></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="co">#&gt;  [6,]  75 0.6544756</span></span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="co">#&gt;  [7,]  76 0.6594646</span></span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="co">#&gt;  [8,]  77 0.6643934</span></span>
<span id="cb5-23"><a href="#cb5-23"></a><span class="co">#&gt;  [9,]  78 0.6692624</span></span>
<span id="cb5-24"><a href="#cb5-24"></a><span class="co">#&gt; [10,]  79 0.6740721</span></span>
<span id="cb5-25"><a href="#cb5-25"></a><span class="co">#&gt; [11,]  80 0.6788230</span></span>
<span id="cb5-26"><a href="#cb5-26"></a><span class="co">#&gt; [12,]  81 0.6835154</span></span>
<span id="cb5-27"><a href="#cb5-27"></a><span class="co">#&gt; [13,]  82 0.6881499</span></span>
<span id="cb5-28"><a href="#cb5-28"></a><span class="co">#&gt; [14,]  83 0.6927269</span></span>
<span id="cb5-29"><a href="#cb5-29"></a><span class="co">#&gt; [15,]  84 0.6972468</span></span>
<span id="cb5-30"><a href="#cb5-30"></a><span class="co">#&gt; [16,]  85 0.7017102</span></span>
<span id="cb5-31"><a href="#cb5-31"></a><span class="co">#&gt; [17,]  86 0.7061174</span></span>
<span id="cb5-32"><a href="#cb5-32"></a><span class="co">#&gt; [18,]  87 0.7104690</span></span>
<span id="cb5-33"><a href="#cb5-33"></a><span class="co">#&gt; [19,]  88 0.7147654</span></span>
<span id="cb5-34"><a href="#cb5-34"></a><span class="co">#&gt; [20,]  89 0.7190072</span></span>
<span id="cb5-35"><a href="#cb5-35"></a><span class="co">#&gt; [21,]  90 0.7231947</span></span>
<span id="cb5-36"><a href="#cb5-36"></a><span class="co">#&gt; [22,]  91 0.7273284</span></span>
<span id="cb5-37"><a href="#cb5-37"></a><span class="co">#&gt; [23,]  92 0.7314089</span></span>
<span id="cb5-38"><a href="#cb5-38"></a><span class="co">#&gt; [24,]  93 0.7354366</span></span>
<span id="cb5-39"><a href="#cb5-39"></a><span class="co">#&gt; [25,]  94 0.7394120</span></span>
<span id="cb5-40"><a href="#cb5-40"></a><span class="co">#&gt; [26,]  95 0.7433356</span></span>
<span id="cb5-41"><a href="#cb5-41"></a><span class="co">#&gt; [27,]  96 0.7472078</span></span>
<span id="cb5-42"><a href="#cb5-42"></a><span class="co">#&gt; [28,]  97 0.7510292</span></span>
<span id="cb5-43"><a href="#cb5-43"></a><span class="co">#&gt; [29,]  98 0.7548002</span></span>
<span id="cb5-44"><a href="#cb5-44"></a><span class="co">#&gt; [30,]  99 0.7585213</span></span>
<span id="cb5-45"><a href="#cb5-45"></a><span class="co">#&gt; [31,] 100 0.7621931</span></span>
<span id="cb5-46"><a href="#cb5-46"></a><span class="co">#&gt; [32,] 101 0.7658159</span></span>
<span id="cb5-47"><a href="#cb5-47"></a><span class="co">#&gt; [33,] 102 0.7693903</span></span>
<span id="cb5-48"><a href="#cb5-48"></a><span class="co">#&gt; [34,] 103 0.7729167</span></span>
<span id="cb5-49"><a href="#cb5-49"></a><span class="co">#&gt; [35,] 104 0.7763957</span></span>
<span id="cb5-50"><a href="#cb5-50"></a><span class="co">#&gt; [36,] 105 0.7798277</span></span>
<span id="cb5-51"><a href="#cb5-51"></a><span class="co">#&gt; [37,] 106 0.7832132</span></span>
<span id="cb5-52"><a href="#cb5-52"></a><span class="co">#&gt; [38,] 107 0.7865527</span></span>
<span id="cb5-53"><a href="#cb5-53"></a><span class="co">#&gt; [39,] 108 0.7898466</span></span>
<span id="cb5-54"><a href="#cb5-54"></a><span class="co">#&gt; [40,] 109 0.7930955</span></span>
<span id="cb5-55"><a href="#cb5-55"></a><span class="co">#&gt; [41,] 110 0.7962999</span></span>
<span id="cb5-56"><a href="#cb5-56"></a><span class="co">#&gt; [42,] 111 0.7994601</span></span>
<span id="cb5-57"><a href="#cb5-57"></a><span class="co">#&gt; [43,] 112 0.8025767</span></span>
<span id="cb5-58"><a href="#cb5-58"></a><span class="co">#&gt; [44,] 113 0.8056501</span></span>
<span id="cb5-59"><a href="#cb5-59"></a><span class="co">#&gt; [45,] 114 0.8086808</span></span>
<span id="cb5-60"><a href="#cb5-60"></a><span class="co">#&gt; [46,] 115 0.8116693</span></span>
<span id="cb5-61"><a href="#cb5-61"></a><span class="co">#&gt; [47,] 116 0.8146161</span></span>
<span id="cb5-62"><a href="#cb5-62"></a><span class="co">#&gt; [48,] 117 0.8175216</span></span>
<span id="cb5-63"><a href="#cb5-63"></a><span class="co">#&gt; [49,] 118 0.8203863</span></span>
<span id="cb5-64"><a href="#cb5-64"></a><span class="co">#&gt; [50,] 119 0.8232106</span></span>
<span id="cb5-65"><a href="#cb5-65"></a><span class="co">#&gt; [51,] 120 0.8259950</span></span></code></pre></div>
<p>We hit it at 112. So now we can calculate the LRE.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>efficiency.s.t &lt;-<span class="st"> </span><span class="dv">70</span><span class="op">/</span><span class="dv">112</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>efficiency.s.t</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#&gt; [1] 0.625</span></span></code></pre></div>
<p>So the LRE of the sign test to the <em>t</em> test in this particular situation is 0.625. This means that we need only about 63% the number of subjects if we are doing the <em>t</em> test to get the same power as we would with the sign test. We could have done it the other way around.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>efficiency.t.s &lt;-<span class="st"> </span><span class="dv">112</span><span class="op">/</span><span class="dv">70</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>efficiency.t.s</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#&gt; [1] 1.6</span></span></code></pre></div>
<p>The relative efficiency of the <em>t</em> test to the sign test is 1.6. This means that we would need 160% the number of subjects if we are doing the sign test to get the same power as we would with the <em>t</em> test. This is no surprise because the circumstances are ideal for the <em>t</em> test. The only surprise might be the magnitude of the sample size difference.</p>
<p>As you might have surmised, figuring local relative efficiency can take a bit of work. The work load increases if we now move on to the Wilcoxon signed ranks test, and increases further if we use exact distributions, which we should when we can. Fortunately, there are two alternative approaches that we can take, both of which involve simulation. Let’s look at an easy method first, then we will move to one that is a bit more sophisticated, but a bit more accurate, and still simpler than actually calculating power for a variety of methods.</p>
<p>For these methods, we will ignore the actual efficiency statistic, but instead ask the question, “Which method is most powerful in this situation?” Let’s take this approach to compare the <em>t</em> test to the Wilcoxon signed ranks test in the current setting. First, I’m going to draw a random sample of scores from a normal distribution with the mean of 0.3 and a standard deviation of 1. Notice that this is the distribution under the specific alternative hypothesis that we posed above. I’m going to use the sample size of 70 that we calculated as necessary for the <em>t</em> test to obtain 80% power, but we’ll fiddle with this in a moment.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>my.sample &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">70</span>, <span class="dt">mean =</span> <span class="fl">0.3</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Now let’s calculate both the <em>t</em> test and the Wilcoxon signed ranks test. For this sample size, it doesn’t much matter if we use the exact test for the Wilcoxon or a large-sample approximation. I’m going to see if the exact test works because I like using the exact test when it is available.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/t.test">t.test</a></span>(my.sample, <span class="dt">alternative =</span> <span class="st">"greater"</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">#&gt; </span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#&gt;  One Sample t-test</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&gt; </span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">#&gt; data:  my.sample</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#&gt; t = 2.0855, df = 69, p-value = 0.02036</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt; alternative hypothesis: true mean is greater than 0</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt;  0.04743235        Inf</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt; mean of x </span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt; 0.2365077</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/wilcox.test">wilcox.test</a></span>(my.sample, <span class="dt">alternative =</span> <span class="st">"greater"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">#&gt; </span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">#&gt;  Wilcoxon signed rank test</span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">#&gt; </span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co">#&gt; data:  my.sample</span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">#&gt; V = 1577, p-value = 0.02511</span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">#&gt; alternative hypothesis: true location is greater than 0</span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="co">#&gt;  0.03467376        Inf</span></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">#&gt; (pseudo)median </span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co">#&gt;      0.2441095</span></span></code></pre></div>
<p>Remember, results will vary. The first time I ran this, I obtained a smaller <em>p</em> value and a narrower interval for the Wilcoxon test than I did for the <em>t</em> test, yet I know that the <em>t</em> test has more power in this situation. What happened? Remember that power is a probability calculation, so we are talking about “in the long run.” That is where our second approach to this problem comes into play. One random sample is a good “first guess” that will give us the right answer the majority of the time, but we would like a bit more confidence that we are choosing the best method. One trial will not tell us what we need to know. I’m going to do this again, but I’m going to repeat it 30 times. Each time I’m going to track the p-value from each procedure.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co"># I'm going to initialize some arrays</span></span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a>t.pvalue &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">30</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>w.pvalue &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">30</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>winner &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">30</span></span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">30</span>) {</span>
<span id="cb10-9"><a href="#cb10-9"></a>  my.sample &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">70</span>, <span class="dt">mean =</span> <span class="fl">0.3</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb10-10"><a href="#cb10-10"></a>  t.result &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/t.test">t.test</a></span>(my.sample, <span class="dt">alternative =</span> <span class="st">"greater"</span>)</span>
<span id="cb10-11"><a href="#cb10-11"></a>  w.result &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/wilcox.test">wilcox.test</a></span>(my.sample, <span class="dt">alternative =</span> <span class="st">"greater"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)</span>
<span id="cb10-12"><a href="#cb10-12"></a>  t.pvalue[i] &lt;-<span class="st"> </span>t.result<span class="op">$</span>p.value</span>
<span id="cb10-13"><a href="#cb10-13"></a>  w.pvalue[i] &lt;-<span class="st"> </span>w.result<span class="op">$</span>p.value</span>
<span id="cb10-14"><a href="#cb10-14"></a>  </span>
<span id="cb10-15"><a href="#cb10-15"></a>  <span class="cf">if</span> (t.pvalue[i] <span class="op">&lt;</span><span class="st"> </span>w.pvalue[i]) {</span>
<span id="cb10-16"><a href="#cb10-16"></a>    winner[i] =<span class="st"> "t"</span></span>
<span id="cb10-17"><a href="#cb10-17"></a>  } <span class="cf">else</span> {</span>
<span id="cb10-18"><a href="#cb10-18"></a>    winner[i] =<span class="st"> "w"</span></span>
<span id="cb10-19"><a href="#cb10-19"></a>  }</span>
<span id="cb10-20"><a href="#cb10-20"></a>}</span>
<span id="cb10-21"><a href="#cb10-21"></a></span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(t.pvalue, w.pvalue, winner)</span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="co">#&gt;       t.pvalue               w.pvalue               winner</span></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="co">#&gt;  [1,] "0.136028840775444"    "0.219363788158114"    "t"   </span></span>
<span id="cb10-25"><a href="#cb10-25"></a><span class="co">#&gt;  [2,] "1.44358266888824e-05" "1.3537222723438e-05"  "w"   </span></span>
<span id="cb10-26"><a href="#cb10-26"></a><span class="co">#&gt;  [3,] "0.00134397005077545"  "0.00174893857649142"  "t"   </span></span>
<span id="cb10-27"><a href="#cb10-27"></a><span class="co">#&gt;  [4,] "0.0545304012520981"   "0.0753965538026509"   "t"   </span></span>
<span id="cb10-28"><a href="#cb10-28"></a><span class="co">#&gt;  [5,] "0.000619859493420809" "0.000294024196193126" "w"   </span></span>
<span id="cb10-29"><a href="#cb10-29"></a><span class="co">#&gt;  [6,] "0.000744222311890374" "0.000579408281497601" "w"   </span></span>
<span id="cb10-30"><a href="#cb10-30"></a><span class="co">#&gt;  [7,] "0.0828138534562124"   "0.131482882057923"    "t"   </span></span>
<span id="cb10-31"><a href="#cb10-31"></a><span class="co">#&gt;  [8,] "0.00935648967543074"  "0.00463301229317054"  "w"   </span></span>
<span id="cb10-32"><a href="#cb10-32"></a><span class="co">#&gt;  [9,] "0.00327085535986868"  "0.00373473191888519"  "t"   </span></span>
<span id="cb10-33"><a href="#cb10-33"></a><span class="co">#&gt; [10,] "0.0214683514812938"   "0.0116192606254906"   "w"   </span></span>
<span id="cb10-34"><a href="#cb10-34"></a><span class="co">#&gt; [11,] "0.00124305365135658"  "0.00380321325781241"  "t"   </span></span>
<span id="cb10-35"><a href="#cb10-35"></a><span class="co">#&gt; [12,] "0.0421915599100704"   "0.0251063724591986"   "w"   </span></span>
<span id="cb10-36"><a href="#cb10-36"></a><span class="co">#&gt; [13,] "0.0466798673711826"   "0.0421456314746973"   "w"   </span></span>
<span id="cb10-37"><a href="#cb10-37"></a><span class="co">#&gt; [14,] "0.478058996291601"    "0.39006389947735"     "w"   </span></span>
<span id="cb10-38"><a href="#cb10-38"></a><span class="co">#&gt; [15,] "0.00824315149789888"  "0.00455149087628424"  "w"   </span></span>
<span id="cb10-39"><a href="#cb10-39"></a><span class="co">#&gt; [16,] "0.00298714563054909"  "0.000949348861743174" "w"   </span></span>
<span id="cb10-40"><a href="#cb10-40"></a><span class="co">#&gt; [17,] "0.0519623326905655"   "0.0779406378378297"   "t"   </span></span>
<span id="cb10-41"><a href="#cb10-41"></a><span class="co">#&gt; [18,] "0.00215951940619298"  "0.00192955823915397"  "w"   </span></span>
<span id="cb10-42"><a href="#cb10-42"></a><span class="co">#&gt; [19,] "8.28988124227047e-05" "9.36039618655065e-05" "t"   </span></span>
<span id="cb10-43"><a href="#cb10-43"></a><span class="co">#&gt; [20,] "0.0109337842472229"   "0.0191517992013956"   "t"   </span></span>
<span id="cb10-44"><a href="#cb10-44"></a><span class="co">#&gt; [21,] "4.89138151366511e-06" "7.48375899994018e-06" "t"   </span></span>
<span id="cb10-45"><a href="#cb10-45"></a><span class="co">#&gt; [22,] "0.00146714910833816"  "0.00174893857649142"  "t"   </span></span>
<span id="cb10-46"><a href="#cb10-46"></a><span class="co">#&gt; [23,] "0.0292035115296255"   "0.0495417033168188"   "t"   </span></span>
<span id="cb10-47"><a href="#cb10-47"></a><span class="co">#&gt; [24,] "0.0712529993739871"   "0.112515095120835"    "t"   </span></span>
<span id="cb10-48"><a href="#cb10-48"></a><span class="co">#&gt; [25,] "0.191550017742046"    "0.300268212071133"    "t"   </span></span>
<span id="cb10-49"><a href="#cb10-49"></a><span class="co">#&gt; [26,] "0.0114390026806192"   "0.0127605454559783"   "t"   </span></span>
<span id="cb10-50"><a href="#cb10-50"></a><span class="co">#&gt; [27,] "0.000284697348136586" "0.000414790289089773" "t"   </span></span>
<span id="cb10-51"><a href="#cb10-51"></a><span class="co">#&gt; [28,] "0.133163972093759"    "0.0832208147393142"   "w"   </span></span>
<span id="cb10-52"><a href="#cb10-52"></a><span class="co">#&gt; [29,] "3.04035608614142e-05" "3.93427732939829e-05" "t"   </span></span>
<span id="cb10-53"><a href="#cb10-53"></a><span class="co">#&gt; [30,] "0.022144255608822"    "0.0188744237418072"   "w"</span></span></code></pre></div>
<p>I kept track of which test resulted in the lowest <em>p</em> value each time. Let’s see how many time the <em>t</em> test was the winner. Again, remember that your results will very likely be different.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(winner <span class="op">==</span><span class="st"> "t"</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">#&gt; [1] 17</span></span></code></pre></div>
<p>We are going to get various outcomes every time we try this. If you run it a number of times, one thing should become clear: the Wilcoxon test is not a bad option! It sure seems to be doing much better than what we had expected from the sign test.</p>
<p>Randomness and probability are still at work. Probability expectations are based on the long run, so I’m going to simulate 10,000 samples. I don’t want to print those all out, so I’ll just show the final result at the end.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co"># I'm going to initialize some arrays</span></span>
<span id="cb12-3"><a href="#cb12-3"></a></span>
<span id="cb12-4"><a href="#cb12-4"></a>t.pvalue &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10000</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>w.pvalue &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10000</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>winner &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10000</span></span>
<span id="cb12-7"><a href="#cb12-7"></a></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>) {</span>
<span id="cb12-9"><a href="#cb12-9"></a>  my.sample &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">70</span>, <span class="dt">mean =</span> <span class="fl">0.3</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb12-10"><a href="#cb12-10"></a>  t.result &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/t.test">t.test</a></span>(my.sample, <span class="dt">alternative =</span> <span class="st">"greater"</span>)</span>
<span id="cb12-11"><a href="#cb12-11"></a>  w.result &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/wilcox.test">wilcox.test</a></span>(my.sample, <span class="dt">alternative =</span> <span class="st">"greater"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)</span>
<span id="cb12-12"><a href="#cb12-12"></a>  t.pvalue[i] &lt;-<span class="st"> </span>t.result<span class="op">$</span>p.value</span>
<span id="cb12-13"><a href="#cb12-13"></a>  w.pvalue[i] &lt;-<span class="st"> </span>w.result<span class="op">$</span>p.value</span>
<span id="cb12-14"><a href="#cb12-14"></a>  </span>
<span id="cb12-15"><a href="#cb12-15"></a>  <span class="cf">if</span> (t.pvalue[i] <span class="op">&lt;</span><span class="st"> </span>w.pvalue[i]) {</span>
<span id="cb12-16"><a href="#cb12-16"></a>    winner[i] =<span class="st"> "t"</span></span>
<span id="cb12-17"><a href="#cb12-17"></a>  } <span class="cf">else</span> {</span>
<span id="cb12-18"><a href="#cb12-18"></a>    winner[i] =<span class="st"> "w"</span></span>
<span id="cb12-19"><a href="#cb12-19"></a>  }</span>
<span id="cb12-20"><a href="#cb12-20"></a>}</span>
<span id="cb12-21"><a href="#cb12-21"></a></span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(winner <span class="op">==</span><span class="st"> "t"</span>)<span class="op">/</span><span class="dv">10000</span></span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="co">#&gt; [1] 0.638</span></span></code></pre></div>
<p>The <em>t</em> test won more than half of the time, but again, the Wilcoxon doesn’t lose as much as we might have expected considering that we are replacing observed quantities with the ranks of those quantities. Let’s try this one more time with a smaller effect size.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>) {</span>
<span id="cb13-3"><a href="#cb13-3"></a>  my.sample &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">70</span>, <span class="dt">mean =</span> <span class="fl">0.2</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb13-4"><a href="#cb13-4"></a>  t.result &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/t.test">t.test</a></span>(my.sample, <span class="dt">alternative =</span> <span class="st">"greater"</span>)</span>
<span id="cb13-5"><a href="#cb13-5"></a>  w.result &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/wilcox.test">wilcox.test</a></span>(my.sample, <span class="dt">alternative =</span> <span class="st">"greater"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-6"><a href="#cb13-6"></a>  t.pvalue[i] &lt;-<span class="st"> </span>t.result<span class="op">$</span>p.value</span>
<span id="cb13-7"><a href="#cb13-7"></a>  w.pvalue[i] &lt;-<span class="st"> </span>w.result<span class="op">$</span>p.value</span>
<span id="cb13-8"><a href="#cb13-8"></a>  </span>
<span id="cb13-9"><a href="#cb13-9"></a>  <span class="cf">if</span> (t.pvalue[i] <span class="op">&lt;</span><span class="st"> </span>w.pvalue[i]) {</span>
<span id="cb13-10"><a href="#cb13-10"></a>    winner[i] =<span class="st"> "t"</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>  } <span class="cf">else</span> {</span>
<span id="cb13-12"><a href="#cb13-12"></a>    winner[i] =<span class="st"> "w"</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>  }</span>
<span id="cb13-14"><a href="#cb13-14"></a>}</span>
<span id="cb13-15"><a href="#cb13-15"></a></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(winner <span class="op">==</span><span class="st"> "t"</span>)<span class="op">/</span><span class="dv">10000</span></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="co">#&gt; [1] 0.5906</span></span></code></pre></div>
<p>Your results may vary, but I don’t expect the <em>t</em> test to win as often in this example as it did in the previous example. I’ll explain why in the next section.</p>
</div>
<div id="asymptotic-relative-efficiency" class="section level3">
<h3 class="hasAnchor">
<a href="#asymptotic-relative-efficiency" class="anchor"></a>Asymptotic relative efficiency</h3>
<p>By now you have likely perceived the difficulties with calculating the LRE. Knowing that we have to do this for each research situation we encounter may make us a bit squeamish. Fortunately, there is a way out.</p>
<p>Recall that we defined relative efficiency like this.</p>
<p><span class="math inline">\(\epsilon_{A,B} = \frac{N_B}{N_A}\)</span></p>
<p>When we are calculating power, what happens to the sample size as we decrease the size of the effect that is of interest to us, all else being constant? It increases. To detect smaller effects we need larger sample sizes. So what would happen if we were interested in a very small effect size? We would need a very large sample size. What if we were interested in an even smaller effect size? We would need an even larger sample size. We could keep going like this. If we do, something strange and wonderful occurs. The ratio of the sample sizes for our two methods approach a constant value. Mathematicians would write it like this.</p>
<p><span class="math inline">\(ES \rightarrow 0\)</span> <span class="math inline">\(N \rightarrow \infty\)</span> <span class="math inline">\(\epsilon_{A,B} \rightarrow L\)</span></p>
<p>That is, the relative efficiency approaches a constant value, which I refer to above as “L.” (Mathematicians call this a “limit.”) This value is what we know as <em>asymptotic relative efficiency</em> or ARE. What good does ARE do us? Importantly we (or at least mathematical statisticians) can calculate the ARE for various mathematical distributions that serve as models for our actual data distributions. Examples of such models are the uniform distributions, the logistic distributions, the Laplace distributions, and, of course, the normal distributions. We don’t ever expect our data to adhere exactly to the form of these distributions, but if our data and the distributions share similar properties, such as how much of a peak is in the center and what proportion of the values are in the tails, the model becomes a reasonable representation for what we encounter in practice.</p>
<p>The ARE will tell us the relative efficiency of one method as compared to a competing method when our data can be reasonably modeled by a mathematical distribution and when the effect size is small. The obvious advantage here is that we have a single number in hand that is not dependent on our particular research situation. Thus, all the steps we took above to estimate the LRE are unnecessary. There are two disadvantages to consider. First, we may not be interested in effect sizes that are very small, but ARE is calculated as a limit when the effect size moves toward zero. Fortunately, some research has been done to determine if ARE is a good approximation even when the effect sizes are moderate or large, and so far the results are promising. The ARE appears to be a good proxy for LRE! (I am conducting more work in this area, so stay tuned for future updates.)</p>
<p>The second disadvantage is that our data may not be represented very well by a mathematical model. Even so, all is not lost. There are certain properties of the mathematical models that seem to be most responsible for the ARE, so rather than focusing on the distinct shape of the model, we can focus on these properties. The two that are of most interest are the height of the peak of the distribution and the weight of the tails. These are actually related to each other. Distributions with high peaks tend to also have “heavier” tails, though that is not always the case. By heavier tails, we mean that a higher proportion of the distribution is in the tails when compared to other distributions.</p>
<p>Talking about peak and tails is a relative concept, so it is valuable to have a standard distribution that we can use for comparison. It should come as no surprise that we use the normal distribution as the standard. When the tails of a distribution are lighter than those of the normal distribution (an example of this would be the uniform distribution), we refer to the distribution as <em>platykurtic</em>. When the tails of the distribution are heavier than those of a normal distribution, we refer to this as <em>leptokurtic</em>. There are varying degrees of platykurtic and leptokurtic, but in every case we are using the normal distribution as a reference distribution.</p>
<p>What we notice about the ARE is that it is most sensitive to the weight of the distribution tails. The good news here is that even if a mathematical model is not a good fit for our data, knowing (or guessing at) the weight of the tails of our data, as compared to a normal distribution, can give us a clue as to the choice of a more powerful method. All we need is a good chart of asymptotic relative efficiencies, and such charts are readily available.</p>
<p>As an example of this concept, suppose I am using a measure that I believe will have a higher proportion of responses in the tails of the distribution than I would expect with the normal distribution. Looking at a chart of AREs informs me that I can increase the power of my study by using ranks as replacement scores. That is, I will choose the Wilcoxon test to achieve a power gain over the <em>t</em> test. Similarly, if I have a very high peak in my data (i.e., a very<br>
high proportion of responses are clustered in the middle, yet we still have a number of responses at the ends of our scale), the ARE table tells me that I may be able to use half as many units in the study with the sign test than if I had used the <em>t</em> test! Startling, yes? It is somewhat surprising, but only because we may have been misled to think that the <em>t</em> test is always the most powerful approach to analyzing our data.</p>
<p>What if we are dealing with data that looks nothing like any of the mathematical models? In this case, we can resort to a simulation, as we did when looking at LRE. For example, consider obtaining data on a scale that represents opinion on a polarizing issue. That is, more respondents will lean toward one end or the other on the scale than what we will find in the middle. This scale results in bimodal data. How can I model such a situation? I know how easy it is to obtain random normal deviates, so what if I use two normal distributions?</p>
<p>Let’s suppose that our scale ranges from 0 to 8. Let’s put the peak of one of the two distributions at 3 and the peak of the other one of the two distributions at 5. I know that most of the normal distribution (99.7% of it, to be more precise) is within three standard deviations of the mean, so we can use a standard deviation of 1 to keep most values within the range of our scale. (Yes, an occasional data point may drift outside, but remember that the purpose of this simulation is to find out what analytic method we want to use, so it is only important that we simulate the main features of our distribution. We don’t need to have an exact imitation of reality.)</p>
<p>Here’s our random sample from this model, as well as a histogram so that we can see how this is “shaping” up. I’m using a sample size of 60, but this choice is arbitrary. I just want it to be a large enough sample to have some stability in our simulation.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>lower.norm &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">30</span>, <span class="dt">mean =</span> <span class="dv">3</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>upper.norm &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">30</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a>my.sample &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(lower.norm, upper.norm)</span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/hist">hist</a></span>(my.sample, <span class="dt">breaks =</span> <span class="dv">15</span>, <span class="dt">xlim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">8</span>))</span></code></pre></div>
<p><img src="releffic_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Pictures will vary because we are using a random sample. If you try this a few times, sometimes you’ll see a clear bimodal distribution and sometimes it may even look normal. That’s due to sampling variability. Obviously, we know that the population distribution is <em>not</em> normal, but is bimodal.</p>
<p>Now let’s do this 10,000 times, as we did for LRE, and compare the <em>t</em> test and the Wilcoxon test. Suppose that we consider the midpoint of this scale (4) as a neutral position. Further suppose that we have an alternative hypothesis that this particular population is to the right of neutral (i.e. a higher mean than 4). I can simulate this by putting a few more people on the right side of the distribution, so I will do so. I’m also going to shift the distribution to the left by 4 points so that we can use a null hypothesis of 0, thus avoiding any complication with the Wilcoxon test.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>) {</span>
<span id="cb15-3"><a href="#cb15-3"></a>  my.sample &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">25</span>, <span class="dt">mean =</span> <span class="dv">-1</span>, <span class="dt">sd =</span> <span class="dv">1</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">35</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">1</span>))</span>
<span id="cb15-4"><a href="#cb15-4"></a>  t.result &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/t.test">t.test</a></span>(my.sample, <span class="dt">alternative =</span> <span class="st">"greater"</span>)</span>
<span id="cb15-5"><a href="#cb15-5"></a>  w.result &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/wilcox.test">wilcox.test</a></span>(my.sample, <span class="dt">alternative =</span> <span class="st">"greater"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)</span>
<span id="cb15-6"><a href="#cb15-6"></a>  t.pvalue[i] &lt;-<span class="st"> </span>t.result<span class="op">$</span>p.value</span>
<span id="cb15-7"><a href="#cb15-7"></a>  w.pvalue[i] &lt;-<span class="st"> </span>w.result<span class="op">$</span>p.value</span>
<span id="cb15-8"><a href="#cb15-8"></a>  </span>
<span id="cb15-9"><a href="#cb15-9"></a>  <span class="cf">if</span> (t.pvalue[i] <span class="op">&lt;</span><span class="st"> </span>w.pvalue[i]) {</span>
<span id="cb15-10"><a href="#cb15-10"></a>    winner[i] =<span class="st"> "t"</span></span>
<span id="cb15-11"><a href="#cb15-11"></a>  } <span class="cf">else</span> {</span>
<span id="cb15-12"><a href="#cb15-12"></a>    winner[i] =<span class="st"> "w"</span></span>
<span id="cb15-13"><a href="#cb15-13"></a>  }</span>
<span id="cb15-14"><a href="#cb15-14"></a>}</span>
<span id="cb15-15"><a href="#cb15-15"></a></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(winner <span class="op">==</span><span class="st"> "t"</span>)<span class="op">/</span><span class="dv">10000</span></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="co">#&gt; [1] 0.4522</span></span></code></pre></div>
<p>We have a winner! Unless you obtained a peculiar outcome, which is possible, but not probable, it isn’t the <em>t</em> test. If this was my research study, I would analyze the data with the Wilcoxon. The confidence interval for the median is my preferred statistic here, but I know that with these kind of data, most of the time my interval will be narrower if I use the Wilcoxon test rather than the <em>t</em> test.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>lower.norm &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">25</span>, <span class="dt">mean =</span> <span class="dv">3</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>upper.norm &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">35</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a>my.sample &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(lower.norm, upper.norm)</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/wilcox.test">wilcox.test</a></span>(my.sample, <span class="dt">alternative =</span> <span class="st">"greater"</span>, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)</span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">#&gt; </span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">#&gt;  Wilcoxon signed rank test with continuity correction</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">#&gt; </span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">#&gt; data:  my.sample</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co">#&gt; V = 1830, p-value = 8.357e-12</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="co">#&gt; alternative hypothesis: true location is greater than 0</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="co">#&gt;  3.733123      Inf</span></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="co">#&gt; (pseudo)median </span></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="co">#&gt;       4.061683</span></span></code></pre></div>
<p>The <em>p</em> value is meaningless here because it is for a test of a median of 0, which is ridiculous since that’s the edge of our scale. We could shift the distribution if we really want a <em>p</em> value, but I don’t need to. I want the confidence interval.</p>
<p>One final word about ARE. Mathematicians have also calculated the lower limit of ARE for one procedure when compared to another. This tells us that no matter what the distribution, this is the lowest possible ARE. For example, the ARE for the Wilcoxon test when compared to the <em>t</em> test has a lower limit of 0.86. This means that if you can find the worst-case scenario for the Wilcoxon, the sample size for the <em>t</em> test can be 86% the sample size for the Wilcoxon to achieve the same power. That may seem like a big difference, but remember, this is the <em>worst-case scenario</em>. Also remember that you can only count on the <em>t</em> test to maintain the Type I error rate when the distribution is normal. For the Wilcoxon test, it only needs to be symmetrical (and even that restriction can be relaxed if you change the hypothesis to one of a stochastic increase, or decrease).</p>
<p>Here’s a startling fact: the ARE for the Wilcoxon to the <em>t</em> test when the data are normally distributed is 0.96. That means, if you have a sample size of 50 and use the Wilcoxon for inference, you “only” need a sample size of 48 with the <em>t</em> test. That’s not much difference, and yet we we are assuming a normal distribution where the <em>t</em> test has home-field advantage! By contrast, if the distribution is a Laplace distribution (very high peak and heavier than normal tails), the ARE for the Wilcoxon is 1.5. That means if the sample size of the Wilcoxon is 50, you need 75 units with the <em>t</em> test to achieve the same power. Wow! Ranks rule! And don’t get me started on talking about how often our measures are such that we can be more confident in ranking than in creating a one-to-one correspondence of interval data with the scale of an underlying construct.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Michael Seaman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
