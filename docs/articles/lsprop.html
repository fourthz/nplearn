<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Large-Sample Proportion Inference • nplearn</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Large-Sample Proportion Inference">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nplearn</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9019</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Bernoulli-Events.html">Bernoulli Events</a>
    </li>
    <li>
      <a href="../articles/binomdist.html">The Binomial Distribution</a>
    </li>
    <li>
      <a href="../articles/FisherIrwin.html">The Fisher-Irwin Test</a>
    </li>
    <li>
      <a href="../articles/gof.html">Goodness of Fit</a>
    </li>
    <li>
      <a href="../articles/ksamp.html">K-Sample Methods for Quantitative Data</a>
    </li>
    <li>
      <a href="../articles/lsprop.html">Large-Sample Proportion Inference</a>
    </li>
    <li>
      <a href="../articles/OnePropExact.html">Exact Inference for a Single Proportion</a>
    </li>
    <li>
      <a href="../articles/ProdBinom.html">The Product Binomial</a>
    </li>
    <li>
      <a href="../articles/randomization.html">Randomization Tests</a>
    </li>
    <li>
      <a href="../articles/releffic.html">Relative Efficiency</a>
    </li>
    <li>
      <a href="../articles/ReplaceScores.html">Replacement Scores</a>
    </li>
    <li>
      <a href="../articles/signtest.html">The Sign Test</a>
    </li>
    <li>
      <a href="../articles/twosamp.html">Two Sample Procedures</a>
    </li>
    <li>
      <a href="../articles/Workflow-Sample.html">Workflow Sample</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Large-Sample Proportion Inference</h1>
            
      
      
      <div class="hidden name"><code>lsprop.Rmd</code></div>

    </div>

    
    
<p>The Central Limit Theorem (CLT) provides a means of inference for proportions with large sample sizes. This is because with a large sample size, the sampling distribution of proportions is approximately normal.</p>
<div id="required-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#required-packages" class="anchor"></a>Required packages</h3>
<p>The Rlab package is required for this vignette. All other functions used are in the base package.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(Rlab)</a></code></pre></div>
</div>
<div id="the-sampling-distribution-of-a-proportion" class="section level3">
<h3 class="hasAnchor">
<a href="#the-sampling-distribution-of-a-proportion" class="anchor"></a>The sampling distribution of a proportion</h3>
<p>A <em>sampling distribution</em> is a distribution of a statistic obtained by random resampling numerous times from the population. For each sample of size n that is randomly selected, we calculate the value of the statistic. After doing this repeatedly (in theory an infinite number of times), the distribution of these statistics is a sampling distribution.</p>
<p>When observing Bernoulli events, the typical parameter of interest is the population proportion, or rate, of success. The statistic to estimate this proportion is the proportion success in the sample. We can use the rbern function to simulate random Bernoulli events.</p>
<p>Here is a simulation of randomly observing 40 Bernoulli events with the probability of success set at 70%.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">n &lt;-<span class="st"> </span><span class="dv">40</span></a>
<a class="sourceLine" id="cb2-2" title="2">pi &lt;-<span class="st"> </span><span class="fl">0.7</span></a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw"><a href="https://rdrr.io/pkg/Rlab/man/Bernoulli.html">rbern</a></span>(n, pi)</a>
<<<<<<< HEAD
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt;  [1] 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 0 1 1 1 1 1 0 1 1 0 1 0 1 1 1 1 1</span></a>
=======
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt;  [1] 1 0 0 1 1 0 0 1 1 1 1 1 1 0 1 0 1 0 0 1 1 1 1 1 0 1 0 1 1 1 1 1 0 1 0</span></a>
>>>>>>> master
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt; [36] 1 1 1 0 0</span></a></code></pre></div>
<p>Now we will repeat this simulation 10,000 times. Each time, we will calculate the proportion success in the sample and save it.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">reps &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3">pi_hat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(reps, <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/Rlab/man/Bernoulli.html">rbern</a></span>(n, pi))<span class="op">/</span>n)</a></code></pre></div>
<p>Let’s look at the sampling distribution of the proportions.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(pi_hat)</a></code></pre></div>
<p><img src="lsprop_files/figure-html/unnamed-chunk-4-1.png" width="480"></p>
<p>We can see the CLT at work. Further, note that if we calculate the mean of all 10,000 values of the sample proportions, it is quite close to the population proportion of 0.7.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(pi_hat)</a>
<<<<<<< HEAD
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#&gt; [1] 0.697965</span></a></code></pre></div>
=======
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#&gt; [1] 0.70066</span></a></code></pre></div>
>>>>>>> master
<p>When the mean of a statistic’s sampling distribution is the population value of the parameter the statistic is estimating, we refer to the statistic as <em>unbiased</em>. This is a desirable property because it tells us that the average of many wrongs is a right!</p>
<p>If we increase the sample size, we can see the Law of Large Numbers at work. Let’s try increasing it from 40 to 200.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">n &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb6-2" title="2"></a>
<a class="sourceLine" id="cb6-3" title="3">pi_hat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(reps, <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/Rlab/man/Bernoulli.html">rbern</a></span>(n, pi))<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb6-4" title="4"><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(pi_hat)</a></code></pre></div>
<p><img src="lsprop_files/figure-html/unnamed-chunk-6-1.png" width="480"></p>
<p>Compare the horizontal axis values on this distribution with the previous distribution and you will see that this distribution has less variability. The Law of Large Numbers tells us that with an increase in sample size, the variability of the sampling distribution decreases. In practical terms, this means that with larger sample sizes there is a higher probability of obtaining a sample with a proportion statistic that is near the proportion parameter that we are estimating.</p>
</div>
<div id="conditions-for-valid-inference" class="section level3">
<h3 class="hasAnchor">
<a href="#conditions-for-valid-inference" class="anchor"></a>Conditions for valid inference</h3>
<p>Theoretically, data must be a simple random sample drawn from the population of interest. That is because a premise of the CLT is that we are working with random variables. In the behavioral and social sciences, as well as other disciplines, such as medical science, that is seldom the case. The question then becomes, who does our sample represent? That is, we conceive of our sample as a possible “random” sample from some population with characteristics that mimic those found in our sample. By “characteristics” we mean variables that may be related to the response variable that is the focus of our study.</p>
<p>Another condition of the CLT is that we have a sum of independent variables, so this means that our observations must be independent. This is one of the easiest conditions of inference to accomplish, but also an important condition.</p>
<p>We must be inferring to a population that is at least 10 times as large as the sample. The theory of inference used for large-sample approximations is that we are working with infinite-sized populations, which of course we are not, but as long as the population is still 10 times as large as the sample, or more, the theory works quite well.</p>
<p>Finally, the sampling distribution must be approximately normal. This is a function of both the sample size and the value of our population proportion. The closer the population proportion is to the middle value of 0.5, the smaller the sample size can be. The further away from 0.5 our population proportion, the larger the sample size we need. A good rule-of-thumb is that the product of the sample size and the population proportion, as well as the product of the sample size and one minus the population proportion, are both at least 10. In symbols:</p>
<p><span class="math inline">\(n(\pi) \ge 10\)</span> and <span class="math inline">\(n(1-\pi) \ge 10\)</span></p>
<p>Under these conditions, the sampling distribution of the sample proportion will look fairly normal.</p>
<p>In the 2003 outbreak of Severe Acute Respiratory Syndrome (SARS) in Singapore, there were 17 deaths among the 132 victims who did not receive treatment. We want to estimate the probability of dying from SARS without treatment. Let’s see if the sampling distribution of the proportion estimate will be approximately normal for these data. We don’t know the population proportion, but let’s see if using a probability of death of 10% will yield a normal sampling distribution.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">x =<span class="st"> </span><span class="dv">17</span></a>
<a class="sourceLine" id="cb7-2" title="2">n =<span class="st"> </span><span class="dv">132</span></a>
<a class="sourceLine" id="cb7-3" title="3"></a>
<a class="sourceLine" id="cb7-4" title="4">pi_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="fl">0.10</span></a>
<a class="sourceLine" id="cb7-5" title="5"></a>
<a class="sourceLine" id="cb7-6" title="6">n<span class="op">*</span>pi_<span class="dv">0</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt; [1] 13.2</span></a>
<a class="sourceLine" id="cb7-8" title="8">n<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pi_<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#&gt; [1] 118.8</span></a></code></pre></div>
<p>If the probability of death from SARS is 10%, it is reasonable for us to use the normal distribution for our inference.</p>
</div>
<div id="test-of-a-proportion" class="section level3">
<h3 class="hasAnchor">
<a href="#test-of-a-proportion" class="anchor"></a>Test of a proportion</h3>
<p>If it has occurred to you to wonder how we would know that we have a large enough sample size for a large-sample approximation if the rule-of-thumb is based on the population proportion, you are not alone. One possible answer is to hypothesize a population proportion. In fact, that is what we do when we conduct a hypothesis test. Another advantage to such a hypothesis is that we can calculate the standard deviation of sampling distribution, because this also depends on us knowing the population parameter.</p>
<p><span class="math inline">\(\Large \sigma_\hat{\pi} = \sqrt{\frac{\pi_0(1-\pi_0)}{n}}\)</span></p>
<p>Here’s the standard deviation of the sampling distribution using a 10% probability of death from SARS.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">sd_pi_hat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(pi_<span class="dv">0</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pi_<span class="dv">0</span>)<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb8-2" title="2">sd_pi_hat</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt; [1] 0.02611165</span></a></code></pre></div>
<p>With the standard deviation in hand, and knowing that the distribution of the sample proportions (i.e., the sampling distribution) will be approximately normal, we can determine the deviation of the sample proportion from the hypothesized proportion in standardized units. This is, of course, called a Z score.</p>
<p><span class="math inline">\(\Large Z = \frac{\hat{\pi}-\pi_0}{\sigma_\hat{\pi}}\)</span></p>
<p>Here it is for the Singapore SARS data.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">pi_hat =<span class="st"> </span>x<span class="op">/</span>n</a>
<a class="sourceLine" id="cb9-2" title="2">z =<span class="st"> </span>(pi_hat <span class="op">-</span><span class="st"> </span>pi_<span class="dv">0</span>)<span class="op">/</span>sd_pi_hat</a>
<a class="sourceLine" id="cb9-3" title="3">z</a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#&gt; [1] 1.102492</span></a></code></pre></div>
<p>If we want to use a 95% level of confidence, this is clearly not far enough out in the tail of the standard normal distribution to suggest rejection of this null hypothesis, so we will retain a 10% probability of death from SARS as a potential rate for the population.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="dv">2</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(z, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">#&gt; [1] 0.2702479</span></a></code></pre></div>
</div>
<div id="a-confidence-interval-for-a-proportion-traditional" class="section level3">
<h3 class="hasAnchor">
<a href="#a-confidence-interval-for-a-proportion-traditional" class="anchor"></a>A confidence interval for a proportion (traditional)</h3>
<p>Testing a single hypothesis results in very little information. All we know is that the death probability for SARS might be 10%, but then again it might be something else. A more informative inference is a confidence interval.</p>
<p>The traditional method for constructing a confidence interval is to calculate a margin of error (MOE), then add and subtract that from our estimate. MOE is the product of a test statistic (in this case, a Z score because we are using the normal distribution as a large-sample approximation of our sampling distribution) and the standard error of the estimate. A standard error is an estimate of the standard deviation. We saw above that the standard deviation for the sampling distribution of <span class="math inline">\(\hat{\pi}\)</span> is given by the following formula.</p>
<p><span class="math inline">\(\Large \sigma_\hat{\pi} = \sqrt{\frac{\pi_0(1-\pi_0)}{n}}\)</span></p>
<p>This requires us knowing the true population parameter, which of course we don’t know or we wouldn’t be creating a confidence interval for it. We got around that by making up a hypothesized value, but now instead of testing a single hypothesis we want to form a confidence interval. We can obtain an estimate of the standard deviation (this is called the <em>standard error</em>) by replacing the population parameter with an estimate based on sample data. Note that I’ve added a hat to <span class="math inline">\(\sigma\)</span> to indicate that I’m now estimating it.</p>
<p><span class="math inline">\(\Large \hat{\sigma}_\hat{\pi} = \sqrt{\frac{\hat{\pi}(1-\hat{\pi})}{n}}\)</span></p>
<p>Here’s the calculation of the standard error for our SARS data.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">se_pi_hat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(pi_hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pi_hat)<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb11-2" title="2">se_pi_hat</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co">#&gt; [1] 0.02915496</span></a></code></pre></div>
<p>With the standard error in hand, we can now calculate the MOE. Keep in mind that we are using the normal distribution as our model of the sampling distribution, so our critical value must come from the normal distribution. Here’s the MOE for a 95% confidence interval using the SARS data.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">MOE &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(.<span class="dv">975</span>)<span class="op">*</span>se_pi_hat</a>
<a class="sourceLine" id="cb12-2" title="2">MOE</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="co">#&gt; [1] 0.05714268</span></a></code></pre></div>
<p>Now we can calculate the 95% confidence interval by adding and subtracting MOE from our point estimate for the death rate.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">pi_hat <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="op">*</span>MOE</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co">#&gt; [1] 0.0716452 0.1859306</span></a></code></pre></div>
<p>Putting it all together, here’s the traditional formula for a confidence interval for a population proportion. I’m using <span class="math inline">\(z^*\)</span> to indicate that this is a Z quantile, but it is the critical Z quantile that is based on our confidence level.</p>
<p><span class="math inline">\(\Large \hat{\pi} \pm z^*\sqrt{\frac{\hat{\pi}(1-\hat{\pi})}{n}}\)</span></p>
<p>If we want a one-sided confidence set, we would change the <span class="math inline">\(z^*\)</span> so that it corresponds to a one-sided test and would either add or subtract MOE from our point estimate, rather than doing both.</p>
</div>
<div id="a-confidence-interval-for-a-proportion-better" class="section level3">
<h3 class="hasAnchor">
<a href="#a-confidence-interval-for-a-proportion-better" class="anchor"></a>A confidence interval for a proportion (better!)</h3>
<p>The confidence interval formula above is in every introductory statistics book that I have ever seen. It may be easy to learn, but it is not the best we can do when using the normal distribution to construct a confidence interval. Look closely at the formula. Notice that to calculate MOE we are using a quantile of the standard normal distribution and we are using the standard error. This is a contradiction! To calculate Z scores, you must <strong>know</strong> the standard deviation. We are using standard error, which is an estimate of the standard deviation.</p>
<p>I know what you’re probably thinking. You want to remind me that the standard deviation formula for the sampling distribution of a proportion requires knowing the population standard deviation and we do not know the population standard deviation. You are correct! Yet there is a method of confidence interval construction that is prevalent in nonparametric statistics that can solve this dilemma for us. It is known as the <em>inversion method</em> of confidence interval construction. It is based on the following principle.</p>
<blockquote>
<p>A confidence interval consists of all possible null hypotheses that are <strong>not</strong> rejected given the observations in hand.</p>
</blockquote>
<p>If you recall, we were able to calculate an actual standard deviation, rather than the standard error, for the sampling distribution by hypothesizing a population parameter.</p>
<p><span class="math inline">\(\Large \sigma_\hat{\pi} = \sqrt{\frac{\pi_0(1-\pi_0)}{n}}\)</span></p>
<p>Note the <span class="math inline">\(\pi_0\)</span> in the above formula. That refers to our hypothesized value of <span class="math inline">\(\pi\)</span>. If a confidence interval consists of all possible null hypotheses that we retain, then why not conduct all possible hypothesis tests, changing the standard deviation each time to reflect our changing hypothesis? In fact, that is exactly how the inversion method of confidence interval construction works.</p>
<p>As you might have guessed, testing all possible hypotheses can be a bit time consuming, but we have R to help us out. Let’s test all hypotheses with our SARS data.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">pi_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb14-2" title="2"></a>
<a class="sourceLine" id="cb14-3" title="3">sd_pi_hat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(pi_<span class="dv">0</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pi_<span class="dv">0</span>)<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb14-4" title="4">z &lt;-<span class="st"> </span>(pi_hat <span class="op">-</span><span class="st"> </span>pi_<span class="dv">0</span>)<span class="op">/</span>sd_pi_hat</a></code></pre></div>
<p>Let’s look at a table of hypothesized values next to our Z score for each value.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(pi_<span class="dv">0</span>, z)</a>
<a class="sourceLine" id="cb15-2" title="2"><span class="co">#&gt;        pi_0            z</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="co">#&gt;   [1,] 0.00          Inf</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="co">#&gt;   [2,] 0.01  13.71644276</span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="co">#&gt;   [3,] 0.02   8.92769693</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="co">#&gt;   [4,] 0.03   6.65340762</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="co">#&gt;   [5,] 0.04   5.20565082</span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="co">#&gt;   [6,] 0.05   4.15335993</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="co">#&gt;   [7,] 0.06   3.32781619</span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="co">#&gt;   [8,] 0.07   2.64718481</span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="co">#&gt;   [9,] 0.08   2.06614118</span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="co">#&gt;  [10,] 0.09   1.55718799</span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="co">#&gt;  [11,] 0.10   1.10249182</span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="co">#&gt;  [12,] 0.11   0.68987971</span></a>
<a class="sourceLine" id="cb15-15" title="15"><span class="co">#&gt;  [13,] 0.12   0.31069843</span></a>
<a class="sourceLine" id="cb15-16" title="16"><span class="co">#&gt;  [14,] 0.13  -0.04140966</span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="co">#&gt;  [15,] 0.14  -0.37124576</span></a>
<a class="sourceLine" id="cb15-18" title="18"><span class="co">#&gt;  [16,] 0.15  -0.68252093</span></a>
<a class="sourceLine" id="cb15-19" title="19"><span class="co">#&gt;  [17,] 0.16  -0.97816161</span></a>
<a class="sourceLine" id="cb15-20" title="20"><span class="co">#&gt;  [18,] 0.17  -1.26051619</span></a>
<a class="sourceLine" id="cb15-21" title="21"><span class="co">#&gt;  [19,] 0.18  -1.53149841</span></a>
<a class="sourceLine" id="cb15-22" title="22"><span class="co">#&gt;  [20,] 0.19  -1.79268954</span></a>
<a class="sourceLine" id="cb15-23" title="23"><span class="co">#&gt;  [21,] 0.20  -2.04541246</span></a>
<a class="sourceLine" id="cb15-24" title="24"><span class="co">#&gt;  [22,] 0.21  -2.29078656</span></a>
<a class="sourceLine" id="cb15-25" title="25"><span class="co">#&gt;  [23,] 0.22  -2.52976908</span></a>
<a class="sourceLine" id="cb15-26" title="26"><span class="co">#&gt;  [24,] 0.23  -2.76318659</span></a>
<a class="sourceLine" id="cb15-27" title="27"><span class="co">#&gt;  [25,] 0.24  -2.99175946</span></a>
<a class="sourceLine" id="cb15-28" title="28"><span class="co">#&gt;  [26,] 0.25  -3.21612101</span></a>
<a class="sourceLine" id="cb15-29" title="29"><span class="co">#&gt;  [27,] 0.26  -3.43683267</span></a>
<a class="sourceLine" id="cb15-30" title="30"><span class="co">#&gt;  [28,] 0.27  -3.65439620</span></a>
<a class="sourceLine" id="cb15-31" title="31"><span class="co">#&gt;  [29,] 0.28  -3.86926351</span></a>
<a class="sourceLine" id="cb15-32" title="32"><span class="co">#&gt;  [30,] 0.29  -4.08184477</span></a>
<a class="sourceLine" id="cb15-33" title="33"><span class="co">#&gt;  [31,] 0.30  -4.29251505</span></a>
<a class="sourceLine" id="cb15-34" title="34"><span class="co">#&gt;  [32,] 0.31  -4.50161985</span></a>
<a class="sourceLine" id="cb15-35" title="35"><span class="co">#&gt;  [33,] 0.32  -4.70947981</span></a>
<a class="sourceLine" id="cb15-36" title="36"><span class="co">#&gt;  [34,] 0.33  -4.91639461</span></a>
<a class="sourceLine" id="cb15-37" title="37"><span class="co">#&gt;  [35,] 0.34  -5.12264638</span></a>
<a class="sourceLine" id="cb15-38" title="38"><span class="co">#&gt;  [36,] 0.35  -5.32850264</span></a>
<a class="sourceLine" id="cb15-39" title="39"><span class="co">#&gt;  [37,] 0.36  -5.53421881</span></a>
<a class="sourceLine" id="cb15-40" title="40"><span class="co">#&gt;  [38,] 0.37  -5.74004050</span></a>
<a class="sourceLine" id="cb15-41" title="41"><span class="co">#&gt;  [39,] 0.38  -5.94620549</span></a>
<a class="sourceLine" id="cb15-42" title="42"><span class="co">#&gt;  [40,] 0.39  -6.15294553</span></a>
<a class="sourceLine" id="cb15-43" title="43"><span class="co">#&gt;  [41,] 0.40  -6.36048804</span></a>
<a class="sourceLine" id="cb15-44" title="44"><span class="co">#&gt;  [42,] 0.41  -6.56905757</span></a>
<a class="sourceLine" id="cb15-45" title="45"><span class="co">#&gt;  [43,] 0.42  -6.77887727</span></a>
<a class="sourceLine" id="cb15-46" title="46"><span class="co">#&gt;  [44,] 0.43  -6.99017027</span></a>
<a class="sourceLine" id="cb15-47" title="47"><span class="co">#&gt;  [45,] 0.44  -7.20316093</span></a>
<a class="sourceLine" id="cb15-48" title="48"><span class="co">#&gt;  [46,] 0.45  -7.41807619</span></a>
<a class="sourceLine" id="cb15-49" title="49"><span class="co">#&gt;  [47,] 0.46  -7.63514681</span></a>
<a class="sourceLine" id="cb15-50" title="50"><span class="co">#&gt;  [48,] 0.47  -7.85460867</span></a>
<a class="sourceLine" id="cb15-51" title="51"><span class="co">#&gt;  [49,] 0.48  -8.07670408</span></a>
<a class="sourceLine" id="cb15-52" title="52"><span class="co">#&gt;  [50,] 0.49  -8.30168314</span></a>
<a class="sourceLine" id="cb15-53" title="53"><span class="co">#&gt;  [51,] 0.50  -8.52980514</span></a>
<a class="sourceLine" id="cb15-54" title="54"><span class="co">#&gt;  [52,] 0.51  -8.76134009</span></a>
<a class="sourceLine" id="cb15-55" title="55"><span class="co">#&gt;  [53,] 0.52  -8.99657029</span></a>
<a class="sourceLine" id="cb15-56" title="56"><span class="co">#&gt;  [54,] 0.53  -9.23579207</span></a>
<a class="sourceLine" id="cb15-57" title="57"><span class="co">#&gt;  [55,] 0.54  -9.47931767</span></a>
<a class="sourceLine" id="cb15-58" title="58"><span class="co">#&gt;  [56,] 0.55  -9.72747726</span></a>
<a class="sourceLine" id="cb15-59" title="59"><span class="co">#&gt;  [57,] 0.56  -9.98062123</span></a>
<a class="sourceLine" id="cb15-60" title="60"><span class="co">#&gt;  [58,] 0.57 -10.23912265</span></a>
<a class="sourceLine" id="cb15-61" title="61"><span class="co">#&gt;  [59,] 0.58 -10.50338008</span></a>
<a class="sourceLine" id="cb15-62" title="62"><span class="co">#&gt;  [60,] 0.59 -10.77382071</span></a>
<a class="sourceLine" id="cb15-63" title="63"><span class="co">#&gt;  [61,] 0.60 -11.05090380</span></a>
<a class="sourceLine" id="cb15-64" title="64"><span class="co">#&gt;  [62,] 0.61 -11.33512471</span></a>
<a class="sourceLine" id="cb15-65" title="65"><span class="co">#&gt;  [63,] 0.62 -11.62701941</span></a>
<a class="sourceLine" id="cb15-66" title="66"><span class="co">#&gt;  [64,] 0.63 -11.92716958</span></a>
<a class="sourceLine" id="cb15-67" title="67"><span class="co">#&gt;  [65,] 0.64 -12.23620857</span></a>
<a class="sourceLine" id="cb15-68" title="68"><span class="co">#&gt;  [66,] 0.65 -12.55482814</span></a>
<a class="sourceLine" id="cb15-69" title="69"><span class="co">#&gt;  [67,] 0.66 -12.88378638</span></a>
<a class="sourceLine" id="cb15-70" title="70"><span class="co">#&gt;  [68,] 0.67 -13.22391683</span></a>
<a class="sourceLine" id="cb15-71" title="71"><span class="co">#&gt;  [69,] 0.68 -13.57613911</span></a>
<a class="sourceLine" id="cb15-72" title="72"><span class="co">#&gt;  [70,] 0.69 -13.94147152</span></a>
<a class="sourceLine" id="cb15-73" title="73"><span class="co">#&gt;  [71,] 0.70 -14.32104578</span></a>
<a class="sourceLine" id="cb15-74" title="74"><span class="co">#&gt;  [72,] 0.71 -14.71612456</span></a>
<a class="sourceLine" id="cb15-75" title="75"><span class="co">#&gt;  [73,] 0.72 -15.12812245</span></a>
<a class="sourceLine" id="cb15-76" title="76"><span class="co">#&gt;  [74,] 0.73 -15.55863102</span></a>
<a class="sourceLine" id="cb15-77" title="77"><span class="co">#&gt;  [75,] 0.74 -16.00944919</span></a>
<a class="sourceLine" id="cb15-78" title="78"><span class="co">#&gt;  [76,] 0.75 -16.48262017</span></a>
<a class="sourceLine" id="cb15-79" title="79"><span class="co">#&gt;  [77,] 0.76 -16.98047672</span></a>
<a class="sourceLine" id="cb15-80" title="80"><span class="co">#&gt;  [78,] 0.77 -17.50569705</span></a>
<a class="sourceLine" id="cb15-81" title="81"><span class="co">#&gt;  [79,] 0.78 -18.06137457</span></a>
<a class="sourceLine" id="cb15-82" title="82"><span class="co">#&gt;  [80,] 0.79 -18.65110551</span></a>
<a class="sourceLine" id="cb15-83" title="83"><span class="co">#&gt;  [81,] 0.80 -19.27910040</span></a>
<a class="sourceLine" id="cb15-84" title="84"><span class="co">#&gt;  [82,] 0.81 -19.95032719</span></a>
<a class="sourceLine" id="cb15-85" title="85"><span class="co">#&gt;  [83,] 0.82 -20.67069754</span></a>
<a class="sourceLine" id="cb15-86" title="86"><span class="co">#&gt;  [84,] 0.83 -21.44731219</span></a>
<a class="sourceLine" id="cb15-87" title="87"><span class="co">#&gt;  [85,] 0.84 -22.28878941</span></a>
<a class="sourceLine" id="cb15-88" title="88"><span class="co">#&gt;  [86,] 0.85 -23.20571159</span></a>
<a class="sourceLine" id="cb15-89" title="89"><span class="co">#&gt;  [87,] 0.86 -24.21124398</span></a>
<a class="sourceLine" id="cb15-90" title="90"><span class="co">#&gt;  [88,] 0.87 -25.32201000</span></a>
<a class="sourceLine" id="cb15-91" title="91"><span class="co">#&gt;  [89,] 0.88 -26.55935925</span></a>
<a class="sourceLine" id="cb15-92" title="92"><span class="co">#&gt;  [90,] 0.89 -27.95125517</span></a>
<a class="sourceLine" id="cb15-93" title="93"><span class="co">#&gt;  [91,] 0.90 -29.53517563</span></a>
<a class="sourceLine" id="cb15-94" title="94"><span class="co">#&gt;  [92,] 0.91 -31.36273929</span></a>
<a class="sourceLine" id="cb15-95" title="95"><span class="co">#&gt;  [93,] 0.92 -33.50742008</span></a>
<a class="sourceLine" id="cb15-96" title="96"><span class="co">#&gt;  [94,] 0.93 -36.07812694</span></a>
<a class="sourceLine" id="cb15-97" title="97"><span class="co">#&gt;  [95,] 0.94 -39.24477513</span></a>
<a class="sourceLine" id="cb15-98" title="98"><span class="co">#&gt;  [96,] 0.95 -43.29079006</span></a>
<a class="sourceLine" id="cb15-99" title="99"><span class="co">#&gt;  [97,] 0.96 -48.73413041</span></a>
<a class="sourceLine" id="cb15-100" title="100"><span class="co">#&gt;  [98,] 0.97 -56.65601091</span></a>
<a class="sourceLine" id="cb15-101" title="101"><span class="co">#&gt;  [99,] 0.98 -69.85487651</span></a>
<a class="sourceLine" id="cb15-102" title="102"><span class="co">#&gt; [100,] 0.99 -99.44421000</span></a>
<a class="sourceLine" id="cb15-103" title="103"><span class="co">#&gt; [101,] 1.00         -Inf</span></a></code></pre></div>
<p>As a reminder, here are our critical values.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(.<span class="dv">025</span>)</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="co">#&gt; [1] -1.959964</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(.<span class="dv">975</span>)</a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co">#&gt; [1] 1.959964</span></a></code></pre></div>
<p>So we want to reject all hypotheses that are not in between these values. Let’s add that information to our table.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"></a>
<a class="sourceLine" id="cb17-2" title="2">outcome &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>((z <span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(.<span class="dv">025</span>)) <span class="op">&amp;</span><span class="st"> </span>(z <span class="op">&lt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(.<span class="dv">975</span>)), <span class="st">"retain"</span>, <span class="st">"reject"</span>)</a>
<a class="sourceLine" id="cb17-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(pi_<span class="dv">0</span>, z, outcome)</a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co">#&gt;        pi_0   z                     outcome </span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="co">#&gt;   [1,] "0"    "Inf"                 "reject"</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">#&gt;   [2,] "0.01" "13.7164427589293"    "reject"</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">#&gt;   [3,] "0.02" "8.92769692687079"    "reject"</span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="co">#&gt;   [4,] "0.03" "6.65340762082588"    "reject"</span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="co">#&gt;   [5,] "0.04" "5.20565082434949"    "reject"</span></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="co">#&gt;   [6,] "0.05" "4.15335993192053"    "reject"</span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="co">#&gt;   [7,] "0.06" "3.32781619497714"    "reject"</span></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="co">#&gt;   [8,] "0.07" "2.64718480554044"    "reject"</span></a>
<a class="sourceLine" id="cb17-13" title="13"><span class="co">#&gt;   [9,] "0.08" "2.06614118441586"    "reject"</span></a>
<a class="sourceLine" id="cb17-14" title="14"><span class="co">#&gt;  [10,] "0.09" "1.55718798635053"    "retain"</span></a>
<a class="sourceLine" id="cb17-15" title="15"><span class="co">#&gt;  [11,] "0.1"  "1.10249182105275"    "retain"</span></a>
<a class="sourceLine" id="cb17-16" title="16"><span class="co">#&gt;  [12,] "0.11" "0.689879705535463"   "retain"</span></a>
<a class="sourceLine" id="cb17-17" title="17"><span class="co">#&gt;  [13,] "0.12" "0.310698434157725"   "retain"</span></a>
<a class="sourceLine" id="cb17-18" title="18"><span class="co">#&gt;  [14,] "0.13" "-0.0414096647589667" "retain"</span></a>
<a class="sourceLine" id="cb17-19" title="19"><span class="co">#&gt;  [15,] "0.14" "-0.371245763468332"  "retain"</span></a>
<a class="sourceLine" id="cb17-20" title="20"><span class="co">#&gt;  [16,] "0.15" "-0.682520929185322"  "retain"</span></a>
<a class="sourceLine" id="cb17-21" title="21"><span class="co">#&gt;  [17,] "0.16" "-0.978161614611893"  "retain"</span></a>
<a class="sourceLine" id="cb17-22" title="22"><span class="co">#&gt;  [18,] "0.17" "-1.26051618743298"   "retain"</span></a>
<a class="sourceLine" id="cb17-23" title="23"><span class="co">#&gt;  [19,] "0.18" "-1.53149841471282"   "retain"</span></a>
<a class="sourceLine" id="cb17-24" title="24"><span class="co">#&gt;  [20,] "0.19" "-1.79268954326485"   "retain"</span></a>
<a class="sourceLine" id="cb17-25" title="25"><span class="co">#&gt;  [21,] "0.2"  "-2.04541245747945"   "reject"</span></a>
<a class="sourceLine" id="cb17-26" title="26"><span class="co">#&gt;  [22,] "0.21" "-2.29078656153031"   "reject"</span></a>
<a class="sourceLine" id="cb17-27" title="27"><span class="co">#&gt;  [23,] "0.22" "-2.52976907672415"   "reject"</span></a>
<a class="sourceLine" id="cb17-28" title="28"><span class="co">#&gt;  [24,] "0.23" "-2.76318658608289"   "reject"</span></a>
<a class="sourceLine" id="cb17-29" title="29"><span class="co">#&gt;  [25,] "0.24" "-2.99175946020564"   "reject"</span></a>
<a class="sourceLine" id="cb17-30" title="30"><span class="co">#&gt;  [26,] "0.25" "-3.21612100882948"   "reject"</span></a>
<a class="sourceLine" id="cb17-31" title="31"><span class="co">#&gt;  [27,] "0.26" "-3.43683267148967"   "reject"</span></a>
<a class="sourceLine" id="cb17-32" title="32"><span class="co">#&gt;  [28,] "0.27" "-3.65439619700125"   "reject"</span></a>
<a class="sourceLine" id="cb17-33" title="33"><span class="co">#&gt;  [29,] "0.28" "-3.86926350824031"   "reject"</span></a>
<a class="sourceLine" id="cb17-34" title="34"><span class="co">#&gt;  [30,] "0.29" "-4.08184476966271"   "reject"</span></a>
<a class="sourceLine" id="cb17-35" title="35"><span class="co">#&gt;  [31,] "0.3"  "-4.29251504664636"   "reject"</span></a>
<a class="sourceLine" id="cb17-36" title="36"><span class="co">#&gt;  [32,] "0.31" "-4.50161985254634"   "reject"</span></a>
<a class="sourceLine" id="cb17-37" title="37"><span class="co">#&gt;  [33,] "0.32" "-4.70947981088427"   "reject"</span></a>
<a class="sourceLine" id="cb17-38" title="38"><span class="co">#&gt;  [34,] "0.33" "-4.91639460924768"   "reject"</span></a>
<a class="sourceLine" id="cb17-39" title="39"><span class="co">#&gt;  [35,] "0.34" "-5.12264638334316"   "reject"</span></a>
<a class="sourceLine" id="cb17-40" title="40"><span class="co">#&gt;  [36,] "0.35" "-5.32850264079323"   "reject"</span></a>
<a class="sourceLine" id="cb17-41" title="41"><span class="co">#&gt;  [37,] "0.36" "-5.53421881225823"   "reject"</span></a>
<a class="sourceLine" id="cb17-42" title="42"><span class="co">#&gt;  [38,] "0.37" "-5.74004050055964"   "reject"</span></a>
<a class="sourceLine" id="cb17-43" title="43"><span class="co">#&gt;  [39,] "0.38" "-5.94620548542068"   "reject"</span></a>
<a class="sourceLine" id="cb17-44" title="44"><span class="co">#&gt;  [40,] "0.39" "-6.15294553130432"   "reject"</span></a>
<a class="sourceLine" id="cb17-45" title="45"><span class="co">#&gt;  [41,] "0.4"  "-6.36048803794238"   "reject"</span></a>
<a class="sourceLine" id="cb17-46" title="46"><span class="co">#&gt;  [42,] "0.41" "-6.56905756701079"   "reject"</span></a>
<a class="sourceLine" id="cb17-47" title="47"><span class="co">#&gt;  [43,] "0.42" "-6.7788772736426"    "reject"</span></a>
<a class="sourceLine" id="cb17-48" title="48"><span class="co">#&gt;  [44,] "0.43" "-6.99017026780352"   "reject"</span></a>
<a class="sourceLine" id="cb17-49" title="49"><span class="co">#&gt;  [45,] "0.44" "-7.20316092777584"   "reject"</span></a>
<a class="sourceLine" id="cb17-50" title="50"><span class="co">#&gt;  [46,] "0.45" "-7.41807618595156"   "reject"</span></a>
<a class="sourceLine" id="cb17-51" title="51"><span class="co">#&gt;  [47,] "0.46" "-7.6351468057099"    "reject"</span></a>
<a class="sourceLine" id="cb17-52" title="52"><span class="co">#&gt;  [48,] "0.47" "-7.85460866726746"   "reject"</span></a>
<a class="sourceLine" id="cb17-53" title="53"><span class="co">#&gt;  [49,] "0.48" "-8.07670407998515"   "reject"</span></a>
<a class="sourceLine" id="cb17-54" title="54"><span class="co">#&gt;  [50,] "0.49" "-8.30168313866228"   "reject"</span></a>
<a class="sourceLine" id="cb17-55" title="55"><span class="co">#&gt;  [51,] "0.5"  "-8.52980514182919"   "reject"</span></a>
<a class="sourceLine" id="cb17-56" title="56"><span class="co">#&gt;  [52,] "0.51" "-8.76134009097077"   "reject"</span></a>
<a class="sourceLine" id="cb17-57" title="57"><span class="co">#&gt;  [53,] "0.52" "-8.99657029099295"   "reject"</span></a>
<a class="sourceLine" id="cb17-58" title="58"><span class="co">#&gt;  [54,] "0.53" "-9.23579207412266"   "reject"</span></a>
<a class="sourceLine" id="cb17-59" title="59"><span class="co">#&gt;  [55,] "0.54" "-9.4793176718649"    "reject"</span></a>
<a class="sourceLine" id="cb17-60" title="60"><span class="co">#&gt;  [56,] "0.55" "-9.72747726271006"   "reject"</span></a>
<a class="sourceLine" id="cb17-61" title="61"><span class="co">#&gt;  [57,] "0.56" "-9.98062122709349"   "reject"</span></a>
<a class="sourceLine" id="cb17-62" title="62"><span class="co">#&gt;  [58,] "0.57" "-10.2391226457967"   "reject"</span></a>
<a class="sourceLine" id="cb17-63" title="63"><span class="co">#&gt;  [59,] "0.58" "-10.5033800837189"   "reject"</span></a>
<a class="sourceLine" id="cb17-64" title="64"><span class="co">#&gt;  [60,] "0.59" "-10.7738207079638"   "reject"</span></a>
<a class="sourceLine" id="cb17-65" title="65"><span class="co">#&gt;  [61,] "0.6"  "-11.0509037977658"   "reject"</span></a>
<a class="sourceLine" id="cb17-66" title="66"><span class="co">#&gt;  [62,] "0.61" "-11.3351247142822"   "reject"</span></a>
<a class="sourceLine" id="cb17-67" title="67"><span class="co">#&gt;  [63,] "0.62" "-11.6270194111784"   "reject"</span></a>
<a class="sourceLine" id="cb17-68" title="68"><span class="co">#&gt;  [64,] "0.63" "-11.9271695828212"   "reject"</span></a>
<a class="sourceLine" id="cb17-69" title="69"><span class="co">#&gt;  [65,] "0.64" "-12.2362085665526"   "reject"</span></a>
<a class="sourceLine" id="cb17-70" title="70"><span class="co">#&gt;  [66,] "0.65" "-12.5548281399512"   "reject"</span></a>
<a class="sourceLine" id="cb17-71" title="71"><span class="co">#&gt;  [67,] "0.66" "-12.8837863845058"   "reject"</span></a>
<a class="sourceLine" id="cb17-72" title="72"><span class="co">#&gt;  [68,] "0.67" "-13.2239168254764"   "reject"</span></a>
<a class="sourceLine" id="cb17-73" title="73"><span class="co">#&gt;  [69,] "0.68" "-13.5761391061783"   "reject"</span></a>
<a class="sourceLine" id="cb17-74" title="74"><span class="co">#&gt;  [70,] "0.69" "-13.9414715165817"   "reject"</span></a>
<a class="sourceLine" id="cb17-75" title="75"><span class="co">#&gt;  [71,] "0.7"  "-14.3210457750945"   "reject"</span></a>
<a class="sourceLine" id="cb17-76" title="76"><span class="co">#&gt;  [72,] "0.71" "-14.7161245643103"   "reject"</span></a>
<a class="sourceLine" id="cb17-77" title="77"><span class="co">#&gt;  [73,] "0.72" "-15.1281224540618"   "reject"</span></a>
<a class="sourceLine" id="cb17-78" title="78"><span class="co">#&gt;  [74,] "0.73" "-15.5586310189925"   "reject"</span></a>
<a class="sourceLine" id="cb17-79" title="79"><span class="co">#&gt;  [75,] "0.74" "-16.0094491879784"   "reject"</span></a>
<a class="sourceLine" id="cb17-80" title="80"><span class="co">#&gt;  [76,] "0.75" "-16.4826201702511"   "reject"</span></a>
<a class="sourceLine" id="cb17-81" title="81"><span class="co">#&gt;  [77,] "0.76" "-16.9804767182789"   "reject"</span></a>
<a class="sourceLine" id="cb17-82" title="82"><span class="co">#&gt;  [78,] "0.77" "-17.5056970543455"   "reject"</span></a>
<a class="sourceLine" id="cb17-83" title="83"><span class="co">#&gt;  [79,] "0.78" "-18.0613745710306"   "reject"</span></a>
<a class="sourceLine" id="cb17-84" title="84"><span class="co">#&gt;  [80,] "0.79" "-18.651105512161"    "reject"</span></a>
<a class="sourceLine" id="cb17-85" title="85"><span class="co">#&gt;  [81,] "0.8"  "-19.2791003970935"   "reject"</span></a>
<a class="sourceLine" id="cb17-86" title="86"><span class="co">#&gt;  [82,] "0.81" "-19.9503271943533"   "reject"</span></a>
<a class="sourceLine" id="cb17-87" title="87"><span class="co">#&gt;  [83,] "0.82" "-20.6706975382245"   "reject"</span></a>
<a class="sourceLine" id="cb17-88" title="88"><span class="co">#&gt;  [84,] "0.83" "-21.447312189117"    "reject"</span></a>
<a class="sourceLine" id="cb17-89" title="89"><span class="co">#&gt;  [85,] "0.84" "-22.2887894125642"   "reject"</span></a>
<a class="sourceLine" id="cb17-90" title="90"><span class="co">#&gt;  [86,] "0.85" "-23.2057115923009"   "reject"</span></a>
<a class="sourceLine" id="cb17-91" title="91"><span class="co">#&gt;  [87,] "0.86" "-24.211243979705"    "reject"</span></a>
<a class="sourceLine" id="cb17-92" title="92"><span class="co">#&gt;  [88,] "0.87" "-25.322010000108"    "reject"</span></a>
<a class="sourceLine" id="cb17-93" title="93"><span class="co">#&gt;  [89,] "0.88" "-26.5593592509311"   "reject"</span></a>
<a class="sourceLine" id="cb17-94" title="94"><span class="co">#&gt;  [90,] "0.89" "-27.951255166211"    "reject"</span></a>
<a class="sourceLine" id="cb17-95" title="95"><span class="co">#&gt;  [91,] "0.9"  "-29.5351756271501"   "reject"</span></a>
<a class="sourceLine" id="cb17-96" title="96"><span class="co">#&gt;  [92,] "0.91" "-31.3627392875912"   "reject"</span></a>
<a class="sourceLine" id="cb17-97" title="97"><span class="co">#&gt;  [93,] "0.92" "-33.5074200777008"   "reject"</span></a>
<a class="sourceLine" id="cb17-98" title="98"><span class="co">#&gt;  [94,] "0.93" "-36.0781269373656"   "reject"</span></a>
<a class="sourceLine" id="cb17-99" title="99"><span class="co">#&gt;  [95,] "0.94" "-39.2447751275498"   "reject"</span></a>
<a class="sourceLine" id="cb17-100" title="100"><span class="co">#&gt;  [96,] "0.95" "-43.2907900596333"   "reject"</span></a>
<a class="sourceLine" id="cb17-101" title="101"><span class="co">#&gt;  [97,] "0.96" "-48.7341304136199"   "reject"</span></a>
<a class="sourceLine" id="cb17-102" title="102"><span class="co">#&gt;  [98,] "0.97" "-56.6560109061737"   "reject"</span></a>
<a class="sourceLine" id="cb17-103" title="103"><span class="co">#&gt;  [99,] "0.98" "-69.854876511365"    "reject"</span></a>
<a class="sourceLine" id="cb17-104" title="104"><span class="co">#&gt; [100,] "0.99" "-99.4442100022373"   "reject"</span></a>
<a class="sourceLine" id="cb17-105" title="105"><span class="co">#&gt; [101,] "1"    "-Inf"                "reject"</span></a></code></pre></div>
<p>Let’s pull out just the retained values so that we can see our confidence interval.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">CI &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(pi_<span class="dv">0</span>, outcome <span class="op">==</span><span class="st"> "retain"</span>)</a>
<a class="sourceLine" id="cb18-2" title="2">CI</a>
<a class="sourceLine" id="cb18-3" title="3"><span class="co">#&gt;  [1] 0.09 0.10 0.11 0.12 0.13 0.14 0.15 0.16 0.17 0.18 0.19</span></a></code></pre></div>
<p>I’m going to do this all one more time with a bit more precision so that we can do a better comparison to the traditional interval. I’ll only show the outcome, because the full table is rather long.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">pi_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.001</span>)</a>
<a class="sourceLine" id="cb19-2" title="2"></a>
<a class="sourceLine" id="cb19-3" title="3">sd_pi_hat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(pi_<span class="dv">0</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pi_<span class="dv">0</span>)<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb19-4" title="4">z &lt;-<span class="st"> </span>(pi_hat <span class="op">-</span><span class="st"> </span>pi_<span class="dv">0</span>)<span class="op">/</span>sd_pi_hat</a>
<a class="sourceLine" id="cb19-5" title="5">outcome &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>((z <span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(.<span class="dv">025</span>)) <span class="op">&amp;</span><span class="st"> </span>(z <span class="op">&lt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(.<span class="dv">975</span>)), <span class="st">"retain"</span>, <span class="st">"reject"</span>)</a>
<a class="sourceLine" id="cb19-6" title="6">CI &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(pi_<span class="dv">0</span>, outcome <span class="op">==</span><span class="st"> "retain"</span>)</a>
<a class="sourceLine" id="cb19-7" title="7">CI</a>
<a class="sourceLine" id="cb19-8" title="8"><span class="co">#&gt;   [1] 0.082 0.083 0.084 0.085 0.086 0.087 0.088 0.089 0.090 0.091 0.092</span></a>
<a class="sourceLine" id="cb19-9" title="9"><span class="co">#&gt;  [12] 0.093 0.094 0.095 0.096 0.097 0.098 0.099 0.100 0.101 0.102 0.103</span></a>
<a class="sourceLine" id="cb19-10" title="10"><span class="co">#&gt;  [23] 0.104 0.105 0.106 0.107 0.108 0.109 0.110 0.111 0.112 0.113 0.114</span></a>
<a class="sourceLine" id="cb19-11" title="11"><span class="co">#&gt;  [34] 0.115 0.116 0.117 0.118 0.119 0.120 0.121 0.122 0.123 0.124 0.125</span></a>
<a class="sourceLine" id="cb19-12" title="12"><span class="co">#&gt;  [45] 0.126 0.127 0.128 0.129 0.130 0.131 0.132 0.133 0.134 0.135 0.136</span></a>
<a class="sourceLine" id="cb19-13" title="13"><span class="co">#&gt;  [56] 0.137 0.138 0.139 0.140 0.141 0.142 0.143 0.144 0.145 0.146 0.147</span></a>
<a class="sourceLine" id="cb19-14" title="14"><span class="co">#&gt;  [67] 0.148 0.149 0.150 0.151 0.152 0.153 0.154 0.155 0.156 0.157 0.158</span></a>
<a class="sourceLine" id="cb19-15" title="15"><span class="co">#&gt;  [78] 0.159 0.160 0.161 0.162 0.163 0.164 0.165 0.166 0.167 0.168 0.169</span></a>
<a class="sourceLine" id="cb19-16" title="16"><span class="co">#&gt;  [89] 0.170 0.171 0.172 0.173 0.174 0.175 0.176 0.177 0.178 0.179 0.180</span></a>
<a class="sourceLine" id="cb19-17" title="17"><span class="co">#&gt; [100] 0.181 0.182 0.183 0.184 0.185 0.186 0.187 0.188 0.189 0.190 0.191</span></a>
<a class="sourceLine" id="cb19-18" title="18"><span class="co">#&gt; [111] 0.192 0.193 0.194 0.195 0.196</span></a></code></pre></div>
<p>So the traditional method gave us 0.072 to 0.186. This more correct method gives 0.082 to 0.196. The reason I say “more correct” instead of correct is because even though we are now using the standard deviation, rather than the standard error, we are still using a normal distribution, and this is only an approximation for the sampling distribution.</p>
</div>
<div id="correction-for-continuity" class="section level3">
<h3 class="hasAnchor">
<a href="#correction-for-continuity" class="anchor"></a>Correction for continuity</h3>
<p>There is one more element we can add to our calculation to make the more correct method even more more correct. This is called the correction for continuity. Nonparametric statisticians recognize that in the real world of research, we always use discrete values. For our SARS data, we studied 132 individuals. The possible values for proportions would look like this: 0/132, 1/132, 2/132, 3/132, and so on, all the way to 131/132 and 132/132. Values in between these numbers are not possible. Moving from 0 to 1 corresponds to a jump of 0/132 to 1/132, or 1/132. That is, the only proportions possible, given our data, are all 1/132 away from each other. Yet we are using a continuous distribution, the standard normal distribution, to help us make a decision about whether to reject or retain our hypotheses.</p>
<p>To understand why this is a problem, let’s look again at our SARS data. We observed 17 deaths out of 132 SARS victims. Here is the Z score again when we are testing a hypothesis of a 10% death rate.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">((<span class="dv">17</span><span class="op">/</span><span class="dv">132</span>) <span class="op">-</span><span class="st"> </span><span class="fl">.10</span>)<span class="op">/</span><span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(.<span class="dv">10</span><span class="op">*</span>(<span class="dv">1</span><span class="fl">-.10</span>)<span class="op">/</span><span class="dv">132</span>)</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="co">#&gt; [1] 1.102492</span></a></code></pre></div>
<p>Suppose we had observed one fewer deaths (16). Now here is the Z score.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">((<span class="dv">16</span><span class="op">/</span><span class="dv">132</span>) <span class="op">-</span><span class="st"> </span><span class="fl">.10</span>)<span class="op">/</span><span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(.<span class="dv">10</span><span class="op">*</span>(<span class="dv">1</span><span class="fl">-.10</span>)<span class="op">/</span><span class="dv">132</span>)</a>
<a class="sourceLine" id="cb21-2" title="2"><span class="co">#&gt; [1] 0.8123624</span></a></code></pre></div>
<p>Similarly, supposed we had observed one more death (18). Now here is the Z score.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">((<span class="dv">18</span><span class="op">/</span><span class="dv">132</span>) <span class="op">-</span><span class="st"> </span><span class="fl">.10</span>)<span class="op">/</span><span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(.<span class="dv">10</span><span class="op">*</span>(<span class="dv">1</span><span class="fl">-.10</span>)<span class="op">/</span><span class="dv">132</span>)</a>
<a class="sourceLine" id="cb22-2" title="2"><span class="co">#&gt; [1] 1.392621</span></a></code></pre></div>
<p>Notice how different these scores are from one another! Even though every Z score is theoretically a possibility, in practice only certain Z scores are possible, due to the discrete nature of our data. Think about the implications for hypothesis testing when we are trying to control the Type I error rate. We may want to control that rate at something like 5%, but in reality the 5% error rate may not even be a possibility, due to our discrete “jumps” in possible Z scores. If our error rate is a bit lower than our hoped-for rate (for example, 4% instead of 5%), we probably won’t mind too much. If the error rate is larger than we hoped for (6%, for example, when we have been bragging about holding our errors at 5%), that could be embarrassing.</p>
<p>If we want to think of a correspondence between our discrete proportions and the continuous Z scores, one way to do this is to consider all the Z scores from one half of the jump in one direction to one half of the jump in the other direction as belonging to our observed proportion. For example, for the SARS observations, we might think of all the Z scores that would correspond to these proportions: (16.5/132) to (17.5/132), since we observed (17/132). Similarly, for an observation of 16 deaths, we could make this continuous by thinking of all the scores from (15.5/132) to (16.5/132).</p>
<p>Now we need to add one more piece and we’ll be there. If I’m going to be a little bit off in my error rate, I’d rather be off with less error than with more error (say, 4% rather than 6% when I’m trying to keep error at 5%). So to add this protection, instead of using a Z score for the actual observation (17/132, for the SARS data), we can use the Z score for one of the boundaries of the interval when we make our discrete data continous (16.5/132 or 17.5/132, for an observed value of 17). Which one do we use? The one that will reduce the chance of rejecting the null hypothesis. This will slightly widen our confidence interval, thus providing us more confidence, rather than less.</p>
<p>The boundary that will reduce the chance of rejection depends on what we have hypothesized. For a two-sided confidence interval, what we want to do is make the absolute value of our Z score smaller. Thus, if our hypothesized value is above our observed value, we want to take the upper value of our created interval (e.g., 17.5/132 instead of 16.5/132). If our hypothesized value is below our observed value, we want to take the lower value of our created interval (e.g., 16.5/132 instead of 17.5/132). We are always moving a little toward the null hypothesis to reduce the chance of rejecting this hypothesis, thus slightly widening our confidence interval and avoiding the embarrassment of inflating our Type I errors. Statisticians refer to this as being <em>conservative</em> with our Type I errors, rather than <em>liberal</em> with our Type I errors. (When it comes to Type I errors, conservative is a good thing, regardless of our political leanings.)</p>
<p>Recall that the jump in possible values was 1/132. Thus, we will adjust our values by half of that jump in one direction or another.</p>
<p><span class="math inline">\(\Large (\frac{1}{2})(\frac{1}{132})\)</span></p>
<p>In general, we will use this formula for our adjustment when working with proportions using the normal distribution.</p>
<p><span class="math inline">\(\Large \frac{1}{2n}\)</span></p>
<p>We will either add or subtract this from our observed proportion when we find the Z score, depending on which will make it less likely to reject the null hypothesis. This value that we add or subtract is known as the <em>correction for continuity</em>. The formula for the correction for continuity will be different for different methods, but one thing will always be true: We will use 1/2 of the size of the jump in our discrete values.</p>
<p>Here is the code for finding the confidence interval for the death rate from SARS using the correction for continuity. I also used the more correct method, so now we are making it more more correct.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">pi_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.001</span>)</a>
<a class="sourceLine" id="cb23-2" title="2">cc &lt;-<span class="st"> </span><span class="dv">-1</span><span class="op">*</span>(<span class="kw"><a href="https://rdrr.io/r/base/sign.html">sign</a></span>(pi_hat<span class="op">-</span>pi_<span class="dv">0</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)))</a>
<a class="sourceLine" id="cb23-3" title="3">sd_pi_hat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(pi_<span class="dv">0</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pi_<span class="dv">0</span>)<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb23-4" title="4">z &lt;-<span class="st"> </span>(pi_hat <span class="op">-</span><span class="st"> </span>pi_<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>cc)<span class="op">/</span>sd_pi_hat</a>
<a class="sourceLine" id="cb23-5" title="5">outcome &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>((z <span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(.<span class="dv">025</span>)) <span class="op">&amp;</span><span class="st"> </span>(z <span class="op">&lt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(.<span class="dv">975</span>)), <span class="st">"retain"</span>, <span class="st">"reject"</span>)</a>
<a class="sourceLine" id="cb23-6" title="6">CI &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(pi_<span class="dv">0</span>, outcome <span class="op">==</span><span class="st"> "retain"</span>)</a>
<a class="sourceLine" id="cb23-7" title="7">CI</a>
<a class="sourceLine" id="cb23-8" title="8"><span class="co">#&gt;   [1] 0.079 0.080 0.081 0.082 0.083 0.084 0.085 0.086 0.087 0.088 0.089</span></a>
<a class="sourceLine" id="cb23-9" title="9"><span class="co">#&gt;  [12] 0.090 0.091 0.092 0.093 0.094 0.095 0.096 0.097 0.098 0.099 0.100</span></a>
<a class="sourceLine" id="cb23-10" title="10"><span class="co">#&gt;  [23] 0.101 0.102 0.103 0.104 0.105 0.106 0.107 0.108 0.109 0.110 0.111</span></a>
<a class="sourceLine" id="cb23-11" title="11"><span class="co">#&gt;  [34] 0.112 0.113 0.114 0.115 0.116 0.117 0.118 0.119 0.120 0.121 0.122</span></a>
<a class="sourceLine" id="cb23-12" title="12"><span class="co">#&gt;  [45] 0.123 0.124 0.125 0.126 0.127 0.128 0.129 0.130 0.131 0.132 0.133</span></a>
<a class="sourceLine" id="cb23-13" title="13"><span class="co">#&gt;  [56] 0.134 0.135 0.136 0.137 0.138 0.139 0.140 0.141 0.142 0.143 0.144</span></a>
<a class="sourceLine" id="cb23-14" title="14"><span class="co">#&gt;  [67] 0.145 0.146 0.147 0.148 0.149 0.150 0.151 0.152 0.153 0.154 0.155</span></a>
<a class="sourceLine" id="cb23-15" title="15"><span class="co">#&gt;  [78] 0.156 0.157 0.158 0.159 0.160 0.161 0.162 0.163 0.164 0.165 0.166</span></a>
<a class="sourceLine" id="cb23-16" title="16"><span class="co">#&gt;  [89] 0.167 0.168 0.169 0.170 0.171 0.172 0.173 0.174 0.175 0.176 0.177</span></a>
<a class="sourceLine" id="cb23-17" title="17"><span class="co">#&gt; [100] 0.178 0.179 0.180 0.181 0.182 0.183 0.184 0.185 0.186 0.187 0.188</span></a>
<a class="sourceLine" id="cb23-18" title="18"><span class="co">#&gt; [111] 0.189 0.190 0.191 0.192 0.193 0.194 0.195 0.196 0.197 0.198 0.199</span></a>
<a class="sourceLine" id="cb23-19" title="19"><span class="co">#&gt; [122] 0.200</span></a></code></pre></div>
<p>You may recall that our confidence interval without the correction for continuity was 0.082 to 0.196. Now we have a bit wider interval: 0.079 to 0.200. This helps ensure that we are providing at least a 95% confidence interval, rather than an interval that might relate to a lower confidence rate.</p>
</div>
<div id="some-good-news" class="section level3">
<h3 class="hasAnchor">
<a href="#some-good-news" class="anchor"></a>Some good news</h3>
<p>I have two good news items to share with you. First, there is a function available in Base R (when we say <em>Base R</em> we mean that you don’t have to load any additional packages) that will give us a confidence interval for proportions. Here it is in action for the SARS data.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span>(<span class="dv">17</span>,<span class="dv">132</span>)</a>
<a class="sourceLine" id="cb24-2" title="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb24-3" title="3"><span class="co">#&gt;  1-sample proportions test with continuity correction</span></a>
<a class="sourceLine" id="cb24-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb24-5" title="5"><span class="co">#&gt; data:  17 out of 132, null probability 0.5</span></a>
<a class="sourceLine" id="cb24-6" title="6"><span class="co">#&gt; X-squared = 71.28, df = 1, p-value &lt; 2.2e-16</span></a>
<a class="sourceLine" id="cb24-7" title="7"><span class="co">#&gt; alternative hypothesis: true p is not equal to 0.5</span></a>
<a class="sourceLine" id="cb24-8" title="8"><span class="co">#&gt; 95 percent confidence interval:</span></a>
<a class="sourceLine" id="cb24-9" title="9"><span class="co">#&gt;  0.07898773 0.20093189</span></a>
<a class="sourceLine" id="cb24-10" title="10"><span class="co">#&gt; sample estimates:</span></a>
<a class="sourceLine" id="cb24-11" title="11"><span class="co">#&gt;         p </span></a>
<a class="sourceLine" id="cb24-12" title="12"><span class="co">#&gt; 0.1287879</span></a></code></pre></div>
<p>Check out that interval! That is what we obtained when we (a) used the more correct method of testing all possible hypotheses and (b) added the correction for continuity. Despite introductory textbooks using the less accurate formula and despite most statistical packages using the less accurate formula, here we have the more more correct confidence interval programmed right into R! Why? Because top-of-the-heap statisticians use R, so what you get when you use R is typically done right.</p>
<p>That is a good segway to my second piece of good news. Soon we will be able to drop the large-sample approximation and move from a more more correct confidence interval to a just plain correct confidence interval. Stay tuned!</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Michael Seaman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
